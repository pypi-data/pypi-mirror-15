<!DOCTYPE html>
<!--[if lt IE 7]>      <html lang="en" ng-app="mopidyFE" class="no-js lt-ie9 lt-ie8 lt-ie7" ng-controller="AppCtrl"> <![endif]-->
<!--[if IE 7]>         <html lang="en" ng-app="mopidyFE" class="no-js lt-ie9 lt-ie8" ng-controller="AppCtrl"> <![endif]-->
<!--[if IE 8]>         <html lang="en" ng-app="mopidyFE" class="no-js lt-ie9" ng-controller="AppCtrl"> <![endif]-->
<!--[if gt IE 8]><!--> <html lang="en" ng-app="mopidyFE" class="no-js" ng-controller="AppCtrl"> <!--<![endif]-->

<head ng-app="mopidyFE" >
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>MFE- Mopidy FrontEnd</title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <meta name="mobile-web-app-capable" content="yes">

  <link rel="stylesheet" href="app.css">
  <link rel="stylesheet" href="component.css" />
  <link rel="stylesheet" href="vendor/font-awesome/css/font-awesome.min.css">
  
  <script src="vendor/jquery-2.2.0.min.js"></script>
	<script src="vendor/angular.min.js"></script>
  <script src="vendor/angular-route.min.js"></script>
</head>

<body ng-cloak ng-controller="AppCtrl" id="appctrl">
	
	<!-- MAIN MENU -->
	
	<nav class="cbp-spmenu cbp-spmenu-vertical cbp-spmenu-left" id="cbp-spmenu-s1">
		<a onclick="toggleMenu()" href="#/search"><i class="fa fa-search"></i> &nbsp;&nbsp;&nbsp;Search</a>
		<a onclick="toggleMenu()" href="#/browse"><i class="fa fa-music"></i> &nbsp;&nbsp;&nbsp;My Music</a>
		<a onclick="toggleMenu()" href="#/nowplaying"> <i class="fa fa-volume-up"></i> &nbsp;&nbsp;&nbsp;Now Playing</a>		
		<a onclick="toggleMenu()" href="#/settings"> <i class="fa fa-cog"></i> &nbsp;&nbsp;&nbsp;Settings</a>
	</nav>	
	
	<div>
				
	  <div ng-view></div>
		
		<!-- QUEUE -->
		
		<div class="cbp-spmenu cbp-spmenu-right" id="cbp-spmenu-s2">
			<div class="queueWrapper">
				<div class="queueContent">
					
					<div ng-repeat="tracks in trackList">				
						<div class="queueBox">
							<a href="" ng-click="queueMenu(tracks);">
								<div class="queueBoxRight">
									<i class="fa fa-ellipsis-v fa-lg"></i>
								</div>
							</a>
							<a href="" ng-click="playTlTrack( tracks.tlid )">
								<div class="queueBoxLeft"> 
									<img ng-src="{{tracks.lfmImage}}" width=40 height=40 />
								</div>			
								<div class="queueBoxCenter">
									<h1 ng-if="tracks.tlid != currentTlid">{{ tracks.track.name }}</h1>
									<h2 ng-if="tracks.tlid == currentTlid">{{ tracks.track.name }}</h2>
									<h3>{{ tracks.track.artists[0].name }}</h3>
								</div>
							</a>
						</div>
					</div>
					
					<div style="height: 102px;"></div>
					
				</div>
			</div>
		</div>		
	
	
		<!-- HEADER -->
		
		<div class="header">
			<div ng-if="showHeaderBG" class="headerBG"></div>
			<a href="javascript:void(0);" onclick="toggleMenu();">
				<div class="headerLeft"><i class="fa fa-bars"></i></div>
			</a>
			<a href="javascript:void(0);" onclick="toggleQueue();">
				<div class="headerRight"><i class='fa fa-list-alt'></i></div>
			</a>

			<div class="headerCenter" ng-if="pageTitle != 'Search'">
				<h1> {{ pageTitle }} </h1>
			</div>
			<div class="headerCenter" ng-if="pageTitle == 'Search'">
				<form onsubmit="getSearch()" id="searchForm"> 
			  	<input type="text" placeholder="Search..." class="searchBox" id="searchTerm">			  	
			  	<a href="javascript:void(0);" onclick="clearSearch()"><i type="reset" class="fa fa-times searchReset"></i></a>	
			  	<script>	
						getSearch = function(){
							var term = document.getElementById("searchTerm").value;
							if(term){
								document.getElementById("searchTerm").blur()
								location.href='#/search/' + term;
							};
						};
						clearSearch = function(){
							document.getElementById("searchTerm").value = '';
							document.getElementById("searchTerm").focus()
						}
						focusSearch = function(){
							document.getElementById("searchTerm").focus()									
						}
						
					</script>	
				</form>	
			</div>	
		</div>
		
		<!-- FOOTER -->
		
		<div class="footer" ng-show="showFooter && (currentState === 'paused' || currentState === 'playing')">
			
			<div class="footerBackground">
				<div class="footerBackImg">
					<div class="footerBackImg2" style="background-image: url('{{currentTrackImageUrl}}');"></div>
				</div>
			</div>
			
			<div class="footerProgressWrap footerProgress">
			  <div class="footerProgressBar footerProgress"></div>
			</div>
			
			<div>	
				<a href="#/nowplaying">
				<div class="footer_center">
					<h1>{{ currentTrack }}</h1>
					<h3>{{ currentArtists[0].name }}</h3>
				</div>						
				</a>
				<div class="footer_right">  
					<a href="" ng-click="play()"><i class="fa fa-play" ng-if="currentState === 'paused' || currentState === 'stopped'" style="font-size: 20px;"></i></a>
					<a href="" ng-click="play()"><i class="fa fa-pause" ng-if="currentState === 'playing'" style="font-size: 20px;"></i></a>
					&nbsp;&nbsp;
					<a href="" ng-click="next()"><i class="fa fa-step-forward" style="font-size: 20px;"></i></a>	
		  	</div>
		  </div>
		  
		</div>


		<!-- CONTEXT MENU -->
		

		<div id="menumask" class="menumask" onclick="closeMenu()"></div>
		
		<div class="contextMenu" ng-if="showContext">
				<a href="" ng-click="closeContextMenu()">
					<div class="contextMask"></div>
				</a>
				<div class="contextOuter">
					<div class="contextInner">					
						<div class="box" style="border-color: #777777;">						
								<div class="boxLeft"> 
									<img ng-src="{{contextData.image}}" width=50 height=50 />
								</div>
								<div class="boxCenter"><div style="display: table; height: 56px;"><div style="display: table-cell; vertical-align: middle;">
									<h1> {{contextData.header }}	</h1>
									<h3> {{contextData.header2}} </h3>
								</div></div></div>
						</div>		
						<div ng-show="contextReady">
							<div ng-repeat="button in contextData.buttons">
								<a href="" ng-click="contextLink(button.type, button.data, button.arg)">
									<div class="box2">
										<div class="boxCenter"><div style="display: table; height: 45px;"><div style="display: table-cell; vertical-align: middle;">
											<h1>{{ button.text }}</h1>
										</div></div></div>
									</div>
								</a>  
							</div>
							<a href="" ng-click="closeContextMenu()">
								<div class="contextClose">
									Close
								</div>
							</a> 
						</div>
						<div ng-show="!contextReady">
							<br><br>
							<i class="fa fa-spinner fa-2x fa-pulse"></i>	
						</div>
					</div>
				</div>
		</div>
	</div>

		
	<!-- Includes -->
	
	
	<script type="text/javascript" src="vendor/mopidy.min.js"></script>
	<script type="text/javascript" src="vendor/lastfm.api.js"></script>
	<script type="text/javascript" src="vendor/lastfm.api.md5.js"></script>
	<script type="text/javascript" src="vendor/lastfm.api.cache.js"></script>
	<script type="text/javascript" src="vendor/underscore-min.js"></script>
	
  <script src="app.js"></script>
  <script src="views/nowplaying/nowplaying.js"></script>
  <script src="views/settings/settings.js"></script>
  <script src="views/browse/browse.js"></script>
  <script src="views/playlists/playlists.js"></script>
  <script src="views/search/search.js"></script>
  <script src="views/artist/artist.js"></script>
  <script src="views/album/album.js"></script>
  <script src="services/cacheService.js"></script>
  <script src="services/mopidyService.js"></script>
  <script src="services/lastfmService.js"></script>
  <script src="services/util.js"></script>
  <script src="js/classie.js"></script>
  <script src="js/jquery.slimscroll.min.js"></script>
  
	<script>
		// menu
		var menuMask = document.getElementById( 'menumask' );
		var menuState= false;
		var queueState= false;
		var menuLeft = document.getElementById( 'cbp-spmenu-s1' ),
			body = document.body;
		var queueRight = document.getElementById( 'cbp-spmenu-s2' ),
		
		toggleMenu = function() {
			if (menuState){
				menuMask.style.display = 'none';
				menuState = false;
			} else {
				menuMask.style.display = 'block';
				menuState = true;
			}
			if (queueState){
				classie.toggle( queueRight, 'cbp-spmenu-open' );
				queueState = false
			}
			
			classie.toggle( menuLeft, 'cbp-spmenu-open' );
		};
		
		// queue
		toggleQueue = function() {
			if (queueState){
				menuMask.style.display = 'none';
				queueState = false;
			} else {
				menuMask.style.display = 'block';
				queueState = true;
				angular.element($("#appctrl")).scope().getImgs();
			}
			
			if (menuState){
				classie.toggle( menuLeft, 'cbp-spmenu-open' );
				menuState = false
			}
			
			classie.toggle( queueRight, 'cbp-spmenu-open' );		
		};
		
		closeMenu = function(){
			if (queueState){ classie.toggle( queueRight, 'cbp-spmenu-open' ); }
			if (menuState){ classie.toggle( menuLeft, 'cbp-spmenu-open' ); }
			queueState = false;
		 	menuState = false;
		 	menuMask.style.display = 'none';
		}
  </script>
  
</body>
</html>
