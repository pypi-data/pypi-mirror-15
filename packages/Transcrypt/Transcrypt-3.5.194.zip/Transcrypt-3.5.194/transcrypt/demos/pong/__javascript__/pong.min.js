'use strict';function pong(){function Y(){name="StopIteration";message="Iterator exhausted"}function N(b){this.iterable=b;this.index=0}function P(b){this.iterable=b;this.index=0}function Z(b,l,m){"undefined"==typeof l&&(l=b,b=0);"undefined"==typeof m&&(m=1);if(0<m&&b>=l||0>m&&b<=l)return[];for(var k=[];0<m?b<l:b>l;b+=m)k.push(b);return k}function T(b){if(null==b||"object"==typeof b)return b;var l={},m;for(m in obj)b.hasOwnProperty(m)&&(l[m]=b[m]);return l}function aa(b){if(null==b||"object"==typeof b)return b;
var l={},m;for(m in obj)b.hasOwnProperty(m)&&(l[m]=aa(b[m]));return l}function y(b){return b?[].slice.apply(b):[]}function u(b){b=b?[].slice.apply(b):[];b.__class__=u;return b}function F(b){var l=[];if(b)for(var m=0;m<b.length;m++)l.add(b[m]);l.__class__=F;return l}function da(){return new P(this)}function ea(){var b=[],l;for(l in this)O(l)||b.push(l);return b}function fa(){var b=[],l;for(l in this)O(l)||b.push([l,this[l]]);return b}function ga(b){delete this[b]}function ha(){for(var b in this)delete this[b]}
function C(b){if(!b||b instanceof Array){var l={};if(b)for(var m=0;m<b.length;m++){var k=b[m];l[k[0]]=k[1]}}else l=b;Object.defineProperty(l,"__class__",{value:C,enumerable:!1,writable:!0});Object.defineProperty(l,"keys",{value:ea,enumerable:!1});Object.defineProperty(l,"__iter__",{value:da,enumerable:!1});Object.defineProperty(l,"items",{value:fa,enumerable:!1});Object.defineProperty(l,"del",{value:ga,enumerable:!1});Object.defineProperty(l,"clear",{value:ha,enumerable:!1});return l}function J(b){try{return b.__str__()}catch(l){return new String(b)}}
var n={},K=function(b,l,m){if(""!=l){l=l.split(".");for(var k=l.length,p=0;p<l.length;p++){if(!b.hasOwnProperty(l[p])){k=p;break}b=b[l[p]]}for(p=k;p<l.length;p++)b[l[p]]={},b=b[l[p]]}for(var h in m)b[h]=m[h]};n.__nest__=K;var Q=function(b){b.__inited__||(b.__all__.__init__(b.__all__),b.__inited__=!0);return b.__all__};n.__init__=Q;var q=function(b,l,m){return b&&(b.hasOwnProperty("__class__")||"string"==typeof b||b instanceof String)?(m&&Object.defineProperty(b,m,{value:function(){var k=[].slice.apply(arguments);
return l.apply(null,[b].concat(k))},writable:!0,enumerable:!0,configurable:!0}),function(){var k=[].slice.apply(arguments);return l.apply(null,[b].concat(k))}):l};n.__get__=q;var D=function(b,l,m){for(var k=function(){var a=[].slice.apply(arguments);return k.__new__(a)},p=l.length-1;0<=p;p--){var h=l[p],f;for(f in h){var e=Object.getOwnPropertyDescriptor(h,f);Object.defineProperty(k,f,e)}}k.__name__=b;k.__bases__=l;for(f in m)e=Object.getOwnPropertyDescriptor(m,f),Object.defineProperty(k,f,e);return k};
n.__class__=D;var L=n.__class__("object",[],{__init__:function(b){},__name__:"object",__bases__:[],__new__:function(b){var l=Object.create(this,{__class__:{value:this,enumerable:!0}});this.__init__.apply(null,[l].concat(b));return l}});n.object=L;n.__pragma__=function(){};K(n,"org.transcrypt.__base__",{__all__:{__inited__:!1,__init__:function(b){var l=D("__Envir__",[L],{get __init__(){return q(this,function(b){b.transpiler_name="transcrypt";b.transpiler_version="3.5.194";b.target_subdir="__javascript__"})}}),
m=l();b.__Envir__=l;b.__envir__=m}}});K(n,"org.transcrypt.__standard__",{__all__:{__inited__:!1,__init__:function(b){var l=D("Exception",[L],{get __init__(){return q(this,function(f){var e=u([].slice.apply(arguments).slice(1));f.args=e})},get __repr__(){return q(this,function(f){return H(f.args)?"{}{}".format(f.__class__.__name__,ba(u(f.args))):"???"})},get __str__(){return q(this,function(f){return 1<H(f.args)?J(u(f.args)):H(f.args)?J(f.args[0]):"???"})}}),m=D("ValueError",[l],{}),k=function(f,e,
a){if("undefined"==typeof e||null!=e&&e.__class__==t)e=null;if("undefined"==typeof a||null!=a&&a.__class__==t)a=!1;if(arguments.length){var c=arguments.length-1;if(arguments[c]&&arguments[c].__class__==t){var c=arguments[c--],g;for(g in c)switch(g){case "iterable":f=c[g];break;case "key":e=c[g];break;case "reverse":a=c[g]}}}e?f.sort(function(d,g){if(arguments.length){var a=arguments.length-1;if(arguments[a]&&arguments[a].__class__==t){var a=arguments[a--],c;for(c in a)switch(c){case "a":d=a[c];break;
case "b":g=a[c]}}}return e(d)>e(g)}):f.sort();a&&f.reverse()},p=D("__Terminal__",[L],{get __init__(){return q(this,function(f){f.element=document.getElementById("__terminal__");f.element&&(f.buffer="",f.element.style.overflowX="auto",f.element.style.padding="5px",f.element.innerHTML="_")})},get print(){return q(this,function(f){var e=" ",a="\n";if(arguments.length){var c=arguments.length-1;if(arguments[c]&&arguments[c].__class__==t){var g=arguments[c--],d;for(d in g)switch(d){case "self":f=g[d];break;
case "sep":e=g[d];break;case "end":a=g[d]}}var h=u([].slice.apply(arguments).slice(1,c+1))}f.element?(f.buffer="{}{}{}".format(f.buffer,e.join(function(){for(var d=[],g=h,a=0;a<g.length;a++)d.append(J(g[a]));return d}()),a).__getslice__(-4096,null,1),f.element.innerHTML=f.buffer.py_replace("\n","<br>"),f.element.scrollTop=f.element.scrollHeight):console.log(e.join(h))})},get input(){return q(this,function(f,e){if(arguments.length){var a=arguments.length-1;if(arguments[a]&&arguments[a].__class__==
t){var a=arguments[a--],c;for(c in a)switch(c){case "self":f=a[c];break;case "question":e=a[c]}}}f.print("{}_".format(e),t({end:""}));c=window.prompt(e);f.buffer=f.buffer.__getslice__(0,-1,1);f.print(c);return c})}}),h=p();b.Exception=l;b.ValueError=m;b.__Terminal__=p;b.__sort__=k;b.__terminal__=h;b.filter=function(f,e){for(var a=[],c=0;c<e.length;c++){var g=e[c];f(g)&&a.append(g)}return a};b.map=function(f,e){for(var a=[],c=0;c<e.length;c++)a.append(f(e[c]));return a};b.sorted=function(f,e,a){if("undefined"==
typeof e||null!=e&&e.__class__==t)e=null;if("undefined"==typeof a||null!=a&&a.__class__==t)a=!1;if(arguments.length){var c=arguments.length-1;if(arguments[c]&&arguments[c].__class__==t){var c=arguments[c--],g;for(g in c)switch(g){case "iterable":f=c[g];break;case "key":e=c[g];break;case "reverse":a=c[g]}}}g=U(f)==C?T(f.keys()):T(f);k(g,e,a);return g}}}});K(n,"",Q(n.org.transcrypt.__base__));var ca=n.__envir__;K(n,"",Q(n.org.transcrypt.__standard__));var ja=n.__sort__;n.print=n.__terminal__.print;
n.input=n.__terminal__.input;var ka=n.print;ca.executor_name=ca.transpiler_name;n.main={__file__:""};n.__except__=null;var t=function(b){b.__class__=t;b.constructor=Object;return b};n.___kwargdict__=t;n.property=function(b,l){l||(l=function(){});return{get:function(){return b(this)},set:function(b){l(this,b)},enumerable:!0}};n.__merge__=function(b,l){var m={},k;for(k in b)m[k]=b[k];for(k in l)m[k]=l[k];return m};console.log.apply=function(){ka([].slice.apply(arguments).slice(1))};n.setattr=function(b,
l,m){b[l]=m};n.getattr=function(b,l){return b[l]};n.hasattr=function(b,l){return l in b};n.delattr=function(b,l){delete b[l]};n.__in__=function(b,l){return U(l)==C?-1<l.keys().indexOf(b):-1<l.indexOf(b)};var O=function(b){return b.startswith("__")&&b.endswith("__")||"constructor"==b||b.startswith("py_")};n.__specialattrib__=O;var H=function(b){if(b){var l=b.length;if(void 0==l){var l=0,m;for(m in b)O(m)||l++}return l}return 0};n.len=H;var V=function(b){return"boolean"==typeof b?b:"number"==typeof b?
0!=b:H(b)?!0:!1};V.__name__="bool";n.bool=V;var R=function(b){if(isNaN(b))throw"ValueError";return+b};R.__name__="float";n.float=R;var W=function(b){return R(b)|0};W.__name__="int";n.int=W;var U=function(b){try{return b.__class__}catch(m){var l=typeof b;return"boolean"==l?V:"number"==l?0==b%1?W:R:l}};n.type=U;n.isinstance=function(b,l){function m(b){if(b==l)return!0;for(var p=0;p<b.__bases__.length;p++)if(m(b.__bases__[p],l))return!0;return!1}return m(b.__class__)};n.__=function(b){return 0<=["boolean",
"number"].indexOf(typeof b)?b:H(b)?b:!1};var ba=function(b){try{return b.__repr__()}catch(h){try{return b.__str__()}catch(f){try{if(b.constructor==Object){var l="{",m=!1,k;for(k in b)if(!O(k)){var p=k.isnumeric()?k:"'"+k+"'";m?l+=", ":m=!0;try{l+=p+": "+b[k].__repr__()}catch(e){l+=p+": "+b[k].toString()}}return l+"}"}return"boolean"==typeof b?b.toString().capitalize():b.toString()}catch(e){return console.log("ERROR: Could not evaluate repr (<object of type "+typeof b+">)"),"???"}}}};n.repr=ba;n.chr=
function(b){return String.fromCharCode(b)};var M=function(b){return b.charCodeAt(0)};n.org=M;n.max=Math.max;n.min=Math.min;n.abs=Math.abs;n.py_StopIteration=Y;n.py_iter=function(b){return"__iter__"in b?b.__iter__():y(b).__iter__()};n.py_next=function(b){b=b.__next__();if("undefined"==typeof b)throw new Y;return b};n.__SeqIterator__=N;N.prototype.__this__=function(){return this};N.prototype.__next__=function(){return this.iterable[this.index++]};n.__KeyIterator__=P;P.prototype.__this__=function(){return this};
P.prototype.__next__=function(){return this.iterable.keys()[this.index++]};n.py_reversed=function(b){b=b.slice();b.reverse();return b};var S=function(){var b=[].slice.call(arguments);return(0==b.length?[]:b.reduce(function(b,m){return b.length<m.length?b:m})).map(function(l,m){return b.map(function(b){return b[m]})})};n.zip=S;n.range=Z;n.enumerate=function(b){return S(Z(H(b)),b)};n.copy=T;n.deepcopy=aa;n.list=y;Array.prototype.__class__=y;y.__name__="list";Array.prototype.__iter__=function(){return new N(this)};
Array.prototype.__getslice__=function(b,l,m){0>b&&(b=this.length+b);null==l?l=this.length:0>l&&(l=this.length+l);for(var k=y([]);b<l;b+=m)k.push(this[b]);return k};Array.prototype.__setslice__=function(b,l,m,k){0>b&&(b=this.length+b);null==l?l=this.length:0>l&&(l=this.length+l);if(null==m)Array.prototype.splice.apply(this,[b,l-b].concat(k));else for(var p=0;b<l;b+=m)this[b]=k[p++]};Array.prototype.__repr__=function(){if(this.__class__==F&&!this.length)return"set()";for(var b=this.__class__&&this.__class__!=
y?this.__class__==u?"(":"{":"[",l=0;l<this.length;l++){l&&(b+=", ");try{b+=this[l].__repr__()}catch(m){b+=this[l].toString()}}this.__class__==u&&1==this.length&&(b+=",");return b+=this.__class__&&this.__class__!=y?this.__class__==u?")":"}":"]"};Array.prototype.__str__=Array.prototype.__repr__;Array.prototype.append=function(b){this.push(b)};Array.prototype.clear=function(){this.length=0};Array.prototype.extend=function(b){this.push.apply(this,b)};Array.prototype.insert=function(b,l){this.splice(b,
0,l)};Array.prototype.remove=function(b){b=this.indexOf(b);if(-1==b)throw"KeyError";this.splice(b,1)};Array.prototype.index=function(b){return this.indexOf(b)};Array.prototype.py_pop=function(b){return void 0==b?this.pop():this.splice(b,1)[0]};Array.prototype.py_sort=function(){ja.apply(null,[this].concat([].slice.apply(arguments)))};Array.prototype.__add__=function(b){return y(this.concat(b))};Array.prototype.__mul__=function(b){for(var l=this,m=1;m<b;m++)l=l.concat(this);return l};Array.prototype.__rmul__=
Array.prototype.__mul__;n.tuple=u;u.__name__="tuple";n.set=F;F.__name__="set";Array.prototype.__bindexOf__=function(b){b+="";for(var l=0,m=this.length-1;l<=m;){var k=(l+m)/2|0,p=this[k]+"";if(p<b)l=k+1;else if(p>b)m=k-1;else return k}return-1};Array.prototype.add=function(b){-1==this.indexOf(b)&&this.push(b)};Array.prototype.discard=function(b){b=this.indexOf(b);-1!=b&&this.splice(b,1)};Array.prototype.isdisjoint=function(b){this.sort();for(var l=0;l<b.length;l++)if(-1!=this.__bindexOf__(b[l]))return!1;
return!0};Array.prototype.issuperset=function(b){this.sort();for(var l=0;l<b.length;l++)if(-1==this.__bindexOf__(b[l]))return!1;return!0};Array.prototype.issubset=function(b){return F(b.slice()).issuperset(this)};Array.prototype.union=function(b){for(var l=F(this.slice().sort()),m=0;m<b.length;m++)-1==l.__bindexOf__(b[m])&&l.push(b[m]);return l};Array.prototype.intersection=function(b){this.sort();for(var l=F(),m=0;m<b.length;m++)-1!=this.__bindexOf__(b[m])&&l.push(b[m]);return l};Array.prototype.difference=
function(b){b=F(b.slice().sort());for(var l=F(),m=0;m<this.length;m++)-1==b.__bindexOf__(this[m])&&l.push(this[m]);return l};Array.prototype.symmetric_difference=function(b){return this.union(b).difference(this.intersection(b))};Array.prototype.update=function(){var b=[].concat.apply(this.slice(),arguments).sort();this.clear();for(var l=0;l<b.length;l++)b[l]!=b[l-1]&&this.push(b[l])};Array.prototype.__eq__=function(b){if(this.length!=b.length)return!1;this.__class__==F&&(this.sort(),b.sort());for(var l=
0;l<this.length;l++)if(this[l]!=b[l])return!1;return!0};Array.prototype.__ne__=function(b){return!this.__eq__(b)};Array.prototype.__le__=function(b){return this.issubset(b)};Array.prototype.__ge__=function(b){return this.issuperset(b)};Array.prototype.__lt__=function(b){return this.issubset(b)&&!this.issuperset(b)};Array.prototype.__gt__=function(b){return this.issuperset(b)&&!this.issubset(b)};n.dict=C;C.__name__="dict";n.str=J;String.prototype.__class__=J;J.__name__="str";String.prototype.__iter__=
function(){return new N(this)};String.prototype.__repr__=function(){return(-1==this.indexOf("'")?"'"+this+"'":'"'+this+'"').replace("\n","\\n")};String.prototype.__str__=function(){return this};String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)};String.prototype.endswith=function(b){return""==b||this.slice(-b.length)==b};String.prototype.find=function(b,l){return this.indexOf(b,l)};String.prototype.__getslice__=function(b,l,m){0>b&&(b=this.length+b);null==l?l=
this.length:0>l&&(l=this.length+l);var k="";if(1==m)k=this.substring(b,l);else for(;b<l;b+=m)k=k.concat(this.charAt(b));return k};Object.defineProperty(String.prototype,"format",{get:function(){return q(this,function(b){var l=u([].slice.apply(arguments).slice(1)),m=0;return b.replace(/\{(\w*)\}/g,function(b,p){""==p&&(p=m++);if(p==+p)return"undefined"==l[p]?b:l[p];for(var h=0;h<l.length;h++)if("object"==typeof l[h]&&"undefined"!=typeof l[h][p])return l[h][p];return b})})},enumerable:!0});String.prototype.isnumeric=
function(){return!isNaN(parseFloat(this))&&isFinite(this)};String.prototype.join=function(b){return b.join(this)};String.prototype.lower=function(){return this.toLowerCase()};String.prototype.py_replace=function(b,l,m){return this.split(b,m).join(l)};String.prototype.lstrip=function(){return this.replace(/^\s*/g,"")};String.prototype.rfind=function(b,l){return this.lastIndexOf(b,l)};String.prototype.rsplit=function(b,l){var m=this.split(b||/s+/);return l?[m.slice(0,-l).join(b)].concat(m.slice(-l)):
m};String.prototype.rstrip=function(){return this.replace(/\s*$/g,"")};String.prototype.py_split=function(b,l){b||(b=" ");return this.split(b||/s+/,l)};String.prototype.startswith=function(b){return 0==this.indexOf(b)};String.prototype.strip=function(){return this.trim()};String.prototype.upper=function(){return this.toUpperCase()};String.prototype.__mul__=function(b){for(var l=this,m=1;m<b;m++)l+=this;return l};String.prototype.__rmul__=String.prototype.__mul__;n.__neg__=function(b){return"object"==
typeof b&&"__neg__"in b?b.__neg__():-b};n.__matmul__=function(b,l){return b.__matmul__(l)};n.__mul__=function(b,l){return"object"==typeof b&&"__mul__"in b?b.__mul__(l):"object"==typeof l&&"__rmul__"in l?l.__rmul__(b):"string"==typeof b?b.__mul__(l):"string"==typeof l?l.__rmul__(b):b*l};n.__div__=function(b,l){return"object"==typeof b&&"__div__"in b?b.__div__(l):"object"==typeof l&&"__rdiv__"in l?l.__rdiv__(b):b/l};n.__add__=function(b,l){return"object"==typeof b&&"__add__"in b?b.__add__(l):"object"==
typeof l&&"__radd__"in l?l.__radd__(b):b+l};n.__sub__=function(b,l){return"object"==typeof b&&"__sub__"in b?b.__sub__(l):"object"==typeof l&&"__rsub__"in l?l.__rsub__(b):b-l};n.__eq__=function(b,l){return"object"==typeof b&&"__eq__"in b?b.__eq__(l):b==l};n.__ne__=function(b,l){return"object"==typeof b&&"__ne__"in b?b.__ne__(l):b!=l};n.__lt__=function(b,l){return"object"==typeof b&&"__lt__"in b?b.__lt__(l):b<l};n.__le__=function(b,l){return"object"==typeof b&&"__le__"in b?b.__le__(l):b<=l};n.__gt__=
function(b,l){return"object"==typeof b&&"__gt__"in b?b.__gt__(l):b>l};n.__ge__=function(b,l){return"object"==typeof b&&"__ge__"in b?b.__ge__(l):b>=l};n.__getitem__=function(b,l){return"object"==typeof b&&"__getitem__"in b?b.__getitem__(l):b[l]};n.__setitem__=function(b,l,m){"object"==typeof b&&"__setitem__"in b?b.__setitem__(l,m):b[l]=m};n.__getslice__=function(b,l,m,k){return"object"==typeof b&&"__getitem__"in b?b.__getitem__([l,m,k]):b.__getslice__(l,m,k)};n.__setslice__=function(b,l,m,k,p){"object"==
typeof b&&"__setitem__"in b?b.__setitem__([l,m,k],p):b.__setslice__(l,m,k,p)};n.__call__=function(){var b=[].slice.apply(arguments);return"object"==typeof b[0]&&"__call__"in b[0]?b[0].__call__.apply(null,b.slice(1)):b[0].apply(null,b.slice(1))};K(n,"com.fabricjs",{__all__:{__inited__:!1,__init__:function(b){var l=function(){var b={},k=k||{version:"1.5.0"};"undefined"!==typeof b&&(b.fabric=k);"undefined"!==typeof document&&"undefined"!==typeof window?(k.document=document,k.window=window,window.fabric=
k):(k.document=require("jsdom").jsdom("<!DOCTYPE html><html><head></head><body></body></html>"),k.window=k.document.createWindow?k.document.createWindow():k.document.parentWindow);k.isTouchSupported="ontouchstart"in k.document.documentElement;k.isLikelyNode="undefined"!==typeof Buffer&&"undefined"===typeof window;k.SHARED_ATTRIBUTES="display transform fill fill-opacity fill-rule opacity stroke stroke-dasharray stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width".split(" ");
k.DPI=96;k.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?)";(function(){function b(a,c){this.__eventListeners[a]&&(c?k.util.removeFromArray(this.__eventListeners[a],c):this.__eventListeners[a].length=0)}function h(a,c){this.__eventListeners||(this.__eventListeners={});if(1===arguments.length)for(var g in a)this.on(g,a[g]);else this.__eventListeners[a]||(this.__eventListeners[a]=[]),this.__eventListeners[a].push(c);return this}function f(a,c){if(this.__eventListeners){if(0===arguments.length)this.__eventListeners=
{};else if(1===arguments.length&&"object"===typeof arguments[0])for(var g in a)b.call(this,g,a[g]);else b.call(this,a,c);return this}}function e(a,c){if(this.__eventListeners){var g=this.__eventListeners[a];if(g){for(var d=0,e=g.length;d<e;d++)g[d].call(this,c||{});return this}}}k.Observable={observe:h,stopObserving:f,fire:e,on:h,off:f,trigger:e}})();k.Collection={add:function(){this._objects.push.apply(this._objects,arguments);for(var b=0,h=arguments.length;b<h;b++)this._onObjectAdded(arguments[b]);
this.renderOnAddRemove&&this.renderAll();return this},insertAt:function(b,h,f){var e=this.getObjects();f?e[h]=b:e.splice(h,0,b);this._onObjectAdded(b);this.renderOnAddRemove&&this.renderAll();return this},remove:function(){for(var b=this.getObjects(),h,f=0,e=arguments.length;f<e;f++)h=b.indexOf(arguments[f]),-1!==h&&(b.splice(h,1),this._onObjectRemoved(arguments[f]));this.renderOnAddRemove&&this.renderAll();return this},forEachObject:function(b,h){for(var f=this.getObjects(),e=f.length;e--;)b.call(h,
f[e],e,f);return this},getObjects:function(b){return"undefined"===typeof b?this._objects:this._objects.filter(function(h){return h.type===b})},item:function(b){return this.getObjects()[b]},isEmpty:function(){return 0===this.getObjects().length},size:function(){return this.getObjects().length},contains:function(b){return-1<this.getObjects().indexOf(b)},complexity:function(){return this.getObjects().reduce(function(b,h){return b+=h.complexity?h.complexity():0},0)}};(function(b){var h=Math.sqrt,f=Math.atan2,
e=Math.PI/180;k.util={removeFromArray:function(a,c){var g=a.indexOf(c);-1!==g&&a.splice(g,1);return a},getRandomInt:function(a,c){return Math.floor(Math.random()*(c-a+1))+a},degreesToRadians:function(a){return a*e},radiansToDegrees:function(a){return a/e},rotatePoint:function(a,c,g){var d=Math.sin(g);g=Math.cos(g);a.subtractEquals(c);return(new k.Point(a.x*g-a.y*d,a.x*d+a.y*g)).addEquals(c)},transformPoint:function(a,c,g){return g?new k.Point(c[0]*a.x+c[2]*a.y,c[1]*a.x+c[3]*a.y):new k.Point(c[0]*
a.x+c[2]*a.y+c[4],c[1]*a.x+c[3]*a.y+c[5])},invertTransform:function(a){var c=a.slice(),c=1/(a[0]*a[3]-a[1]*a[2]),c=[c*a[3],-c*a[1],-c*a[2],c*a[0],0,0];a=k.util.transformPoint({x:a[4],y:a[5]},c);c[4]=-a.x;c[5]=-a.y;return c},toFixed:function(a,c){return parseFloat(Number(a).toFixed(c))},parseUnit:function(a,c){var g=/\D{0,2}$/.exec(a),d=parseFloat(a);c||(c=k.Text.DEFAULT_SVG_FONT_SIZE);switch(g[0]){case "mm":return d*k.DPI/25.4;case "cm":return d*k.DPI/2.54;case "in":return d*k.DPI;case "pt":return d*
k.DPI/72;case "pc":return d*k.DPI/72*12;case "em":return d*c;default:return d}},falseFunction:function(){return!1},getKlass:function(a,c){a=k.util.string.camelize(a.charAt(0).toUpperCase()+a.slice(1));return k.util.resolveNamespace(c)[a]},resolveNamespace:function(a){if(!a)return k;a=a.split(".");for(var c=a.length,g=b||k.window,d=0;d<c;++d)g=g[a[d]];return g},loadImage:function(a,c,g,d){if(a){var e=k.util.createImage();e.onload=function(){c&&c.call(g,e);e=e.onload=e.onerror=null};e.onerror=function(){k.log("Error loading "+
e.src);c&&c.call(g,null,!0);e=e.onload=e.onerror=null};0!==a.indexOf("data")&&"undefined"!==typeof d&&(e.crossOrigin=d);e.src=a}else c&&c.call(g,a)},enlivenObjects:function(a,c,g,d){function e(){++h===b&&c&&c(f)}a=a||[];var f=[],h=0,b=a.length;b?a.forEach(function(a,c){if(a&&a.type){var h=k.util.getKlass(a.type,g);h.async?h.fromObject(a,function(g,h){h||(f[c]=g,d&&d(a,f[c]));e()}):(f[c]=h.fromObject(a),d&&d(a,f[c]),e())}else e()}):c&&c(f)},groupSVGElements:function(a,c,g){a=new k.PathGroup(a,c);"undefined"!==
typeof g&&a.setSourcePath(g);return a},populateWithProperties:function(a,c,g){if(g&&"[object Array]"===Object.prototype.toString.call(g))for(var d=0,e=g.length;d<e;d++)g[d]in a&&(c[g[d]]=a[g[d]])},drawDashedLine:function(a,c,g,d,e,b){d-=c;var z=e-g;e=h(d*d+z*z);d=f(z,d);var z=b.length,k=0,l=!0;a.save();a.translate(c,g);a.moveTo(0,0);a.rotate(d);for(c=0;e>c;)c+=b[k++%z],c>e&&(c=e),a[l?"lineTo":"moveTo"](c,0),l=!l;a.restore()},createCanvasElement:function(a){a||(a=k.document.createElement("canvas"));
a.getContext||"undefined"===typeof G_vmlCanvasManager||G_vmlCanvasManager.initElement(a);return a},createImage:function(){return k.isLikelyNode?new (require("canvas").Image):k.document.createElement("img")},createAccessors:function(a){a=a.prototype;for(var c=a.stateProperties.length;c--;){var g=a.stateProperties[c],d=g.charAt(0).toUpperCase()+g.slice(1),e="set"+d,d="get"+d;a[d]||(a[d]=new Function('return this.get("'+g+'")'));a[e]||(a[e]=new Function("value",'return this.set("'+g+'", value)'))}},
clipContext:function(a,c){c.save();c.beginPath();a.clipTo(c);c.clip()},multiplyTransformMatrices:function(a,c){return[a[0]*c[0]+a[2]*c[1],a[1]*c[0]+a[3]*c[1],a[0]*c[2]+a[2]*c[3],a[1]*c[2]+a[3]*c[3],a[0]*c[4]+a[2]*c[5]+a[4],a[1]*c[4]+a[3]*c[5]+a[5]]},getFunctionBody:function(a){return(String(a).match(/function[^{]*\{([\s\S]*)\}/)||{})[1]},isTransparent:function(a,c,g,d){0<d&&(c=c>d?c-d:0,g=g>d?g-d:0);var e=!0;a=a.getImageData(c,g,2*d||1,2*d||1);c=3;for(g=a.data.length;c<g&&(e=0>=a.data[c],!1!==e);c+=
4);return e}}})("undefined"!==typeof b?b:this);(function(){function b(g,c,e,k,l,p,la){var X=d.call(arguments);if(a[X])return a[X];var I=Math.PI,m=la*I/180,n=Math.sin(m),m=Math.cos(m),G=0,B=0;e=Math.abs(e);k=Math.abs(k);var A=-m*g*.5-n*c*.5,q=-m*c*.5+n*g*.5,E=e*e,x=k*k,t=q*q,v=A*A,u=E*x-E*t-x*v,y=0;0>u?(E=Math.sqrt(1-u/(E*x)),e*=E,k*=E):y=(l===p?-1:1)*Math.sqrt(u/(E*t+x*v));t=y*e*q/k;v=-y*k*A/e;y=m*t-n*v+.5*g;E=n*t+m*v+.5*c;x=f(1,0,(A-t)/e,(q-v)/k);q=f((A-t)/e,(q-v)/k,(-A-t)/e,(-q-v)/k);0===p&&0<q?
q-=2*I:1===p&&0>q&&(q+=2*I);I=Math.ceil(Math.abs(q/I*2));A=[];q/=I;t=8/3*Math.sin(q/4)*Math.sin(q/4)/Math.sin(q/2);v=x+q;for(u=0;u<I;u++)A[u]=h(x,v,m,n,e,k,y,E,t,G,B),G=A[u][4],B=A[u][5],x=v,v+=q;return a[X]=A}function h(g,a,e,f,h,b,k,l,p,m,n){var q=d.call(arguments);if(c[q])return c[q];var B=Math.cos(g),A=Math.sin(g),t=Math.cos(a),E=Math.sin(a),x=e*h*t-f*b*E+k,u=f*h*t+e*b*E+l;c[q]=[m+p*(-e*h*A-f*b*B),n+p*(-f*h*A+e*b*B),x+p*(e*h*E+f*b*t),u+p*(f*h*E-e*b*t),x,u];return c[q]}function f(d,g,a,c){d=Math.atan2(g,
d);a=Math.atan2(c,a);return a>=d?a-d:2*Math.PI-(d-a)}function e(a,c,e,f,h,b,k,l){var p=d.call(arguments);if(g[p])return g[p];var m=Math.sqrt,n=Math.min,q=Math.max,B=Math.abs,A=[],t=[[],[]],u,x,y,v,C;x=6*a-12*e+6*h;u=-3*a+9*e-9*h+3*k;y=3*e-3*a;for(var D=0;2>D;++D)0<D&&(x=6*c-12*f+6*b,u=-3*c+9*f-9*b+3*l,y=3*f-3*c),1E-12>B(u)?1E-12>B(x)||(v=-y/x,0<v&&1>v&&A.push(v)):(v=x*x-4*y*u,0>v||(C=m(v),v=(-x+C)/(2*u),0<v&&1>v&&A.push(v),v=(-x-C)/(2*u),0<v&&1>v&&A.push(v)));for(B=m=A.length;m--;)v=A[m],x=1-v,u=
x*x*x*a+3*x*x*v*e+3*x*v*v*h+v*v*v*k,t[0][m]=u,u=x*x*x*c+3*x*x*v*f+3*x*v*v*b+v*v*v*l,t[1][m]=u;t[0][B]=a;t[1][B]=c;t[0][B+1]=k;t[1][B+1]=l;n=[{x:n.apply(null,t[0]),y:n.apply(null,t[1])},{x:q.apply(null,t[0]),y:q.apply(null,t[1])}];return g[p]=n}var a={},c={},g={},d=Array.prototype.join;k.util.drawArc=function(d,g,a,c){var e=[[],[],[],[]];c=b(c[5]-g,c[6]-a,c[0],c[1],c[3],c[4],c[2]);for(var f=0,h=c.length;f<h;f++)e[f][0]=c[f][0]+g,e[f][1]=c[f][1]+a,e[f][2]=c[f][2]+g,e[f][3]=c[f][3]+a,e[f][4]=c[f][4]+
g,e[f][5]=c[f][5]+a,d.bezierCurveTo.apply(d,e[f])};k.util.getBoundsOfArc=function(d,g,a,c,f,h,k,l,m){var n=0,q=0,G=[],B=[];a=b(l-d,m-g,a,c,h,k,f);c=[[],[]];f=0;for(h=a.length;f<h;f++)G=e(n,q,a[f][0],a[f][1],a[f][2],a[f][3],a[f][4],a[f][5]),c[0].x=G[0].x+d,c[0].y=G[0].y+g,c[1].x=G[1].x+d,c[1].y=G[1].y+g,B.push(c[0]),B.push(c[1]),n=a[f][4],q=a[f][5];return B};k.util.getBoundsOfCurve=e})();(function(){function b(f,e,a){if(f&&0!==f.length){var c=f.length-1,g=e?f[c][e]:f[c];if(e)for(;c--;)a(f[c][e],g)&&
(g=f[c][e]);else for(;c--;)a(f[c],g)&&(g=f[c]);return g}}var h=Array.prototype.slice;Array.prototype.indexOf||(Array.prototype.indexOf=function(f){if(void 0===this||null===this)throw new TypeError;var e=Object(this),a=e.length>>>0;if(0===a)return-1;var c=0;0<arguments.length&&(c=Number(arguments[1]),c!==c?c=0:0!==c&&c!==Number.POSITIVE_INFINITY&&c!==Number.NEGATIVE_INFINITY&&(c=(0<c||-1)*Math.floor(Math.abs(c))));if(c>=a)return-1;for(c=0<=c?c:Math.max(a-Math.abs(c),0);c<a;c++)if(c in e&&e[c]===f)return c;
return-1});Array.prototype.forEach||(Array.prototype.forEach=function(f,e){for(var a=0,c=this.length>>>0;a<c;a++)a in this&&f.call(e,this[a],a,this)});Array.prototype.map||(Array.prototype.map=function(f,e){for(var a=[],c=0,g=this.length>>>0;c<g;c++)c in this&&(a[c]=f.call(e,this[c],c,this));return a});Array.prototype.every||(Array.prototype.every=function(f,e){for(var a=0,c=this.length>>>0;a<c;a++)if(a in this&&!f.call(e,this[a],a,this))return!1;return!0});Array.prototype.some||(Array.prototype.some=
function(f,e){for(var a=0,c=this.length>>>0;a<c;a++)if(a in this&&f.call(e,this[a],a,this))return!0;return!1});Array.prototype.filter||(Array.prototype.filter=function(f,e){for(var a=[],c,g=0,d=this.length>>>0;g<d;g++)g in this&&(c=this[g],f.call(e,c,g,this)&&a.push(c));return a});Array.prototype.reduce||(Array.prototype.reduce=function(f){var e=this.length>>>0,a=0,c;if(1<arguments.length)c=arguments[1];else{do{if(a in this){c=this[a++];break}if(++a>=e)throw new TypeError;}while(1)}for(;a<e;a++)a in
this&&(c=f.call(null,c,this[a],a,this));return c});k.util.array={invoke:function(f,e){for(var a=h.call(arguments,2),c=[],g=0,d=f.length;g<d;g++)c[g]=a.length?f[g][e].apply(f[g],a):f[g][e].call(f[g]);return c},min:function(f,e){return b(f,e,function(a,c){return a<c})},max:function(f,e){return b(f,e,function(a,c){return a>=c})}}})();(function(){function b(h,f){for(var e in f)h[e]=f[e];return h}k.util.object={extend:b,clone:function(h){return b({},h)}}})();(function(){String.prototype.trim||(String.prototype.trim=
function(){return this.replace(/^[\s\xA0]+/,"").replace(/[\s\xA0]+$/,"")});k.util.string={camelize:function(b){return b.replace(/-+(.)?/g,function(h,f){return f?f.toUpperCase():""})},capitalize:function(b,h){return b.charAt(0).toUpperCase()+(h?b.slice(1):b.slice(1).toLowerCase())},escapeXml:function(b){return b.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}}})();(function(){var b=Array.prototype.slice,h=Function.prototype.apply,f=function(){};
Function.prototype.bind||(Function.prototype.bind=function(e){var a=this,c=b.call(arguments,1),g;g=c.length?function(){return h.call(a,this instanceof f?this:e,c.concat(b.call(arguments)))}:function(){return h.call(a,this instanceof f?this:e,arguments)};f.prototype=this.prototype;g.prototype=new f;return g})})();(function(){function b(){}function h(g){var d=this.constructor.superclass.prototype[g];return 1<arguments.length?d.apply(this,f.call(arguments,1)):d.call(this)}var f=Array.prototype.slice,
e=function(){},a=function(){for(var g in{toString:1})if("toString"===g)return!1;return!0}(),c=function(g,d,c){for(var e in d)e in g.prototype&&"function"===typeof g.prototype[e]&&-1<(d[e]+"").indexOf("callSuper")?g.prototype[e]=function(g){return function(){var a=this.constructor.superclass;this.constructor.superclass=c;var e=d[g].apply(this,arguments);this.constructor.superclass=a;if("initialize"!==g)return e}}(e):g.prototype[e]=d[e],a&&(d.toString!==Object.prototype.toString&&(g.prototype.toString=
d.toString),d.valueOf!==Object.prototype.valueOf&&(g.prototype.valueOf=d.valueOf))};k.util.createClass=function(){function g(){this.initialize.apply(this,arguments)}var d=null,a=f.call(arguments,0);"function"===typeof a[0]&&(d=a.shift());g.superclass=d;g.subclasses=[];d&&(b.prototype=d.prototype,g.prototype=new b,d.subclasses.push(g));for(var w=0,k=a.length;w<k;w++)c(g,a[w],d);g.prototype.initialize||(g.prototype.initialize=e);g.prototype.constructor=g;g.prototype.callSuper=h;return g}})();(function(){function b(d){var g=
Array.prototype.slice.call(arguments,1),a,c,e=g.length;for(c=0;c<e;c++)if(a=typeof d[g[c]],!/^(?:function|object|unknown)$/.test(a))return!1;return!0}function h(d,g){return function(c){g.call(a(d),c||k.window.event)}}function f(d,g){return function(a){if(z[d]&&z[d][g])for(var c=z[d][g],e=0,f=c.length;e<f;e++)c[e].call(this,a||k.window.event)}}function e(d,g,a){var c="touchend"===d.type?"changedTouches":"touches";return d[c]&&d[c][0]?d[c][0][g]-(d[c][0][g]-d[c][0][a])||d[a]:d[a]}var a,c,g=function(){var d=
0;return function(g){return g.__uniqueID||(g.__uniqueID="uniqueID__"+d++)}}();(function(){var d={};a=function(g){return d[g]};c=function(g,a){d[g]=a}})();var d=b(k.document.documentElement,"addEventListener","removeEventListener")&&b(k.window,"addEventListener","removeEventListener"),r=b(k.document.documentElement,"attachEvent","detachEvent")&&b(k.window,"attachEvent","detachEvent"),w={},z={};d?(d=function(d,g,a){d.addEventListener(g,a,!1)},r=function(d,g,a){d.removeEventListener(g,a,!1)}):r?(d=function(d,
a,e){var f=g(d);c(f,d);w[f]||(w[f]={});w[f][a]||(w[f][a]=[]);e={handler:e,wrappedHandler:h(f,e)};w[f][a].push(e);d.attachEvent("on"+a,e.wrappedHandler)},r=function(d,a,c){var e=g(d),f;if(w[e]&&w[e][a])for(var h=0,b=w[e][a].length;h<b;h++)(f=w[e][a][h])&&f.handler===c&&(d.detachEvent("on"+a,f.wrappedHandler),w[e][a][h]=null)}):(d=function(d,a,c){var e=g(d);z[e]||(z[e]={});if(!z[e][a]){z[e][a]=[];var h=d["on"+a];h&&z[e][a].push(h);d["on"+a]=f(e,a)}z[e][a].push(c)},r=function(d,a,c){d=g(d);if(z[d]&&
z[d][a]){a=z[d][a];d=0;for(var e=a.length;d<e;d++)a[d]===c&&a.splice(d,1)}});k.util.addListener=d;k.util.removeListener=r;var l=function(d){return"unknown"!==typeof d.clientX?d.clientX:0},m=function(d){return"unknown"!==typeof d.clientY?d.clientY:0};k.isTouchSupported&&(l=function(d){return e(d,"pageX","clientX")},m=function(d){return e(d,"pageY","clientY")});k.util.getPointer=function(d,g){d||(d=k.window.event);var a=k.util.getScrollLeftTop(d.target||("unknown"!==typeof d.srcElement?d.srcElement:
null),g);return{x:l(d)+a.left,y:m(d)+a.top}};k.util.object.extend(k.util,k.Observable)})();(function(){var b=k.document.createElement("div"),h="string"===typeof b.style.filter,f=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,e=function(a){return a};"string"===typeof b.style.opacity?e=function(a,c){a.style.opacity=c;return a}:h&&(e=function(a,c){var g=a.style;a.currentStyle&&!a.currentStyle.hasLayout&&(g.zoom=1);f.test(g.filter)?g.filter=g.filter.replace(f,.9999<=c?"":"alpha(opacity="+100*c+")"):g.filter+=
" alpha(opacity="+100*c+")";return a});k.util.setStyle=function(a,c){var g=a.style;if(!g)return a;if("string"===typeof c)return a.style.cssText+=";"+c,-1<c.indexOf("opacity")?e(a,c.match(/opacity:\s*(\d?\.?\d*)/)[1]):a;for(var d in c)"opacity"===d?e(a,c[d]):g["float"===d||"cssFloat"===d?"undefined"===typeof g.styleFloat?"cssFloat":"styleFloat":d]=c[d];return a}})();(function(){function b(a,g){var d=k.document.createElement(a),e;for(e in g)"class"===e?d.className=g[e]:"for"===e?d.htmlFor=g[e]:d.setAttribute(e,
g[e]);return d}var h=Array.prototype.slice,f,e=function(a){return h.call(a,0)};try{f=e(k.document.childNodes)instanceof Array}catch(c){}f||(e=function(a){for(var g=Array(a.length),d=a.length;d--;)g[d]=a[d];return g});var a;a=k.document.defaultView&&k.document.defaultView.getComputedStyle?function(a,g){var d=k.document.defaultView.getComputedStyle(a,null);return d?d[g]:void 0}:function(a,g){var d=a.style[g];!d&&a.currentStyle&&(d=a.currentStyle[g]);return d};(function(){var a=k.document.documentElement.style,
g="userSelect"in a?"userSelect":"MozUserSelect"in a?"MozUserSelect":"WebkitUserSelect"in a?"WebkitUserSelect":"KhtmlUserSelect"in a?"KhtmlUserSelect":"";k.util.makeElementUnselectable=function(d){"undefined"!==typeof d.onselectstart&&(d.onselectstart=k.util.falseFunction);g?d.style[g]="none":"string"===typeof d.unselectable&&(d.unselectable="on");return d};k.util.makeElementSelectable=function(d){"undefined"!==typeof d.onselectstart&&(d.onselectstart=null);g?d.style[g]="":"string"===typeof d.unselectable&&
(d.unselectable="");return d}})();(function(){k.util.getScript=function(a,g){var d=k.document.getElementsByTagName("head")[0],e=k.document.createElement("script"),f=!0;e.onload=e.onreadystatechange=function(d){!f||"string"===typeof this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(f=!1,g(d||k.window.event),e=e.onload=e.onreadystatechange=null)};e.src=a;d.appendChild(e)}})();k.util.getById=function(a){return"string"===typeof a?k.document.getElementById(a):a};k.util.toArray=
e;k.util.makeElement=b;k.util.addClass=function(a,g){a&&-1===(" "+a.className+" ").indexOf(" "+g+" ")&&(a.className+=(a.className?" ":"")+g)};k.util.wrapElement=function(a,g,d){"string"===typeof g&&(g=b(g,d));a.parentNode&&a.parentNode.replaceChild(g,a);g.appendChild(a);return g};k.util.getScrollLeftTop=function(a,g){var d,e,f=0,h=0,b=k.document.documentElement,l=k.document.body||{scrollLeft:0,scrollTop:0};for(e=a;a&&a.parentNode&&!d;)a=a.parentNode,1===a.nodeType&&"fixed"===k.util.getElementStyle(a,
"position")&&(d=a),1===a.nodeType&&e!==g&&"absolute"===k.util.getElementStyle(a,"position")?h=f=0:a===k.document?(f=l.scrollLeft||b.scrollLeft||0,h=l.scrollTop||b.scrollTop||0):(f+=a.scrollLeft||0,h+=a.scrollTop||0);return{left:f,top:h}};k.util.getElementOffset=function(c){var g;g=c&&c.ownerDocument;var d={left:0,top:0},e={left:0,top:0},f={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!g)return{left:0,top:0};for(var h in f)e[f[h]]+=parseInt(a(c,h),10)||0;g=g.documentElement;
"undefined"!==typeof c.getBoundingClientRect&&(d=c.getBoundingClientRect());c=k.util.getScrollLeftTop(c,null);return{left:d.left+c.left-(g.clientLeft||0)+e.left,top:d.top+c.top-(g.clientTop||0)+e.top}};k.util.getElementStyle=a})();(function(){function b(e,a){return e+(/\?/.test(e)?"&":"?")+a}function h(){}var f=function(){for(var e=[function(){return new ActiveXObject("Microsoft.XMLHTTP")},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml2.XMLHTTP.3.0")},
function(){return new XMLHttpRequest}],a=e.length;a--;)try{if(e[a]())return e[a]}catch(c){}}();k.util.request=function(e,a){a||(a={});var c=a.method?a.method.toUpperCase():"GET",g=a.onComplete||function(){},d=f(),r;d.onreadystatechange=function(){4===d.readyState&&(g(d),d.onreadystatechange=h)};"GET"===c&&(r=null,"string"===typeof a.parameters&&(e=b(e,a.parameters)));d.open(c,e,!0);"POST"!==c&&"PUT"!==c||d.setRequestHeader("Content-Type","application/x-www-form-urlencoded");d.send(r);return d}})();
k.log=function(){};k.warn=function(){};"undefined"!==typeof console&&["log","warn"].forEach(function(b){"undefined"!==typeof console[b]&&"function"===typeof console[b].apply&&(k[b]=function(){return console[b].apply(console,arguments)})});(function(b){function h(f,e){this.x=f;this.y=e}b=b.fabric||(b.fabric={});b.Point?b.warn("fabric.Point is already defined"):(b.Point=h,h.prototype={constructor:h,add:function(f){return new h(this.x+f.x,this.y+f.y)},addEquals:function(f){this.x+=f.x;this.y+=f.y;return this},
scalarAdd:function(f){return new h(this.x+f,this.y+f)},scalarAddEquals:function(f){this.x+=f;this.y+=f;return this},subtract:function(f){return new h(this.x-f.x,this.y-f.y)},subtractEquals:function(f){this.x-=f.x;this.y-=f.y;return this},scalarSubtract:function(f){return new h(this.x-f,this.y-f)},scalarSubtractEquals:function(f){this.x-=f;this.y-=f;return this},multiply:function(f){return new h(this.x*f,this.y*f)},multiplyEquals:function(f){this.x*=f;this.y*=f;return this},divide:function(f){return new h(this.x/
f,this.y/f)},divideEquals:function(f){this.x/=f;this.y/=f;return this},eq:function(f){return this.x===f.x&&this.y===f.y},lt:function(f){return this.x<f.x&&this.y<f.y},lte:function(f){return this.x<=f.x&&this.y<=f.y},gt:function(f){return this.x>f.x&&this.y>f.y},gte:function(f){return this.x>=f.x&&this.y>=f.y},lerp:function(f,e){return new h(this.x+(f.x-this.x)*e,this.y+(f.y-this.y)*e)},distanceFrom:function(f){var e=this.x-f.x;f=this.y-f.y;return Math.sqrt(e*e+f*f)},midPointFrom:function(f){return new h(this.x+
(f.x-this.x)/2,this.y+(f.y-this.y)/2)},min:function(f){return new h(Math.min(this.x,f.x),Math.min(this.y,f.y))},max:function(f){return new h(Math.max(this.x,f.x),Math.max(this.y,f.y))},toString:function(){return this.x+","+this.y},setXY:function(f,e){this.x=f;this.y=e},setFromPoint:function(f){this.x=f.x;this.y=f.y},swap:function(f){var e=this.x,a=this.y;this.x=f.x;this.y=f.y;f.x=e;f.y=a}})})("undefined"!==typeof b?b:this);(function(b){function h(e){this.status=e;this.points=[]}var f=b.fabric||(b.fabric=
{});f.Intersection?f.warn("fabric.Intersection is already defined"):(f.Intersection=h,f.Intersection.prototype={appendPoint:function(e){this.points.push(e)},appendPoints:function(e){this.points=this.points.concat(e)}},f.Intersection.intersectLineLine=function(e,a,c,g){var d,b=(g.x-c.x)*(e.y-c.y)-(g.y-c.y)*(e.x-c.x);d=(a.x-e.x)*(e.y-c.y)-(a.y-e.y)*(e.x-c.x);c=(g.y-c.y)*(a.x-e.x)-(g.x-c.x)*(a.y-e.y);0!==c?(b/=c,d/=c,0<=b&&1>=b&&0<=d&&1>=d?(d=new h("Intersection"),d.points.push(new f.Point(e.x+b*(a.x-
e.x),e.y+b*(a.y-e.y)))):d=new h):d=0===b||0===d?new h("Coincident"):new h("Parallel");return d},f.Intersection.intersectLinePolygon=function(e,a,c){for(var g=new h,d=c.length,f=0;f<d;f++){var b=h.intersectLineLine(e,a,c[f],c[(f+1)%d]);g.appendPoints(b.points)}0<g.points.length&&(g.status="Intersection");return g},f.Intersection.intersectPolygonPolygon=function(e,a){for(var c=new h,g=e.length,d=0;d<g;d++){var f=h.intersectLinePolygon(e[d],e[(d+1)%g],a);c.appendPoints(f.points)}0<c.points.length&&(c.status=
"Intersection");return c},f.Intersection.intersectPolygonRectangle=function(e,a,c){var g=a.min(c),d=a.max(c);c=new f.Point(d.x,g.y);var b=new f.Point(g.x,d.y);a=h.intersectLinePolygon(g,c,e);c=h.intersectLinePolygon(c,d,e);d=h.intersectLinePolygon(d,b,e);e=h.intersectLinePolygon(b,g,e);g=new h;g.appendPoints(a.points);g.appendPoints(c.points);g.appendPoints(d.points);g.appendPoints(e.points);0<g.points.length&&(g.status="Intersection");return g})})("undefined"!==typeof b?b:this);(function(b){function h(a){a?
this._tryParsingColor(a):this.setSource([0,0,0,1])}function f(a,c,g){0>g&&(g+=1);1<g&&--g;return g<1/6?a+6*(c-a)*g:.5>g?c:g<2/3?a+(c-a)*(2/3-g)*6:a}var e=b.fabric||(b.fabric={});e.Color?e.warn("fabric.Color is already defined."):(e.Color=h,e.Color.prototype={_tryParsingColor:function(a){var c;a in h.colorNameMap&&(a=h.colorNameMap[a]);"transparent"===a?this.setSource([255,255,255,0]):((c=h.sourceFromHex(a))||(c=h.sourceFromRgb(a)),c||(c=h.sourceFromHsl(a)),c&&this.setSource(c))},_rgbToHsl:function(a,
c,g){a/=255;c/=255;g/=255;var d,f,h,b=e.util.array.max([a,c,g]);f=e.util.array.min([a,c,g]);h=(b+f)/2;if(b===f)d=f=0;else{var k=b-f;f=.5<h?k/(2-b-f):k/(b+f);switch(b){case a:d=(c-g)/k+(c<g?6:0);break;case c:d=(g-a)/k+2;break;case g:d=(a-c)/k+4}d/=6}return[Math.round(360*d),Math.round(100*f),Math.round(100*h)]},getSource:function(){return this._source},setSource:function(a){this._source=a},toRgb:function(){var a=this.getSource();return"rgb("+a[0]+","+a[1]+","+a[2]+")"},toRgba:function(){var a=this.getSource();
return"rgba("+a[0]+","+a[1]+","+a[2]+","+a[3]+")"},toHsl:function(){var a=this.getSource(),a=this._rgbToHsl(a[0],a[1],a[2]);return"hsl("+a[0]+","+a[1]+"%,"+a[2]+"%)"},toHsla:function(){var a=this.getSource(),c=this._rgbToHsl(a[0],a[1],a[2]);return"hsla("+c[0]+","+c[1]+"%,"+c[2]+"%,"+a[3]+")"},toHex:function(){var a=this.getSource(),c,g;c=a[0].toString(16);c=1===c.length?"0"+c:c;g=a[1].toString(16);g=1===g.length?"0"+g:g;a=a[2].toString(16);a=1===a.length?"0"+a:a;return c.toUpperCase()+g.toUpperCase()+
a.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(a){var c=this.getSource();c[3]=a;this.setSource(c);return this},toGrayscale:function(){var a=this.getSource(),c=parseInt((.3*a[0]+.59*a[1]+.11*a[2]).toFixed(0),10);this.setSource([c,c,c,a[3]]);return this},toBlackWhite:function(a){var c=this.getSource(),g=(.3*c[0]+.59*c[1]+.11*c[2]).toFixed(0),c=c[3],g=Number(g)<Number(a||127)?0:255;this.setSource([g,g,g,c]);return this},overlayWith:function(a){a instanceof h||(a=new h(a));
var c=[],g=this.getAlpha(),d=this.getSource();a=a.getSource();for(var e=0;3>e;e++)c.push(Math.round(.5*d[e]+.5*a[e]));c[3]=g;this.setSource(c);return this}},e.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/,e.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/,e.Color.reHex=/^#?([0-9a-f]{6}|[0-9a-f]{3})$/i,e.Color.colorNameMap={aqua:"#00FFFF",black:"#000000",
blue:"#0000FF",fuchsia:"#FF00FF",gray:"#808080",green:"#008000",lime:"#00FF00",maroon:"#800000",navy:"#000080",olive:"#808000",orange:"#FFA500",purple:"#800080",red:"#FF0000",silver:"#C0C0C0",teal:"#008080",white:"#FFFFFF",yellow:"#FFFF00"},e.Color.fromRgb=function(a){return h.fromSource(h.sourceFromRgb(a))},e.Color.sourceFromRgb=function(a){if(a=a.match(h.reRGBa)){var c=parseInt(a[1],10)/(/%$/.test(a[1])?100:1)*(/%$/.test(a[1])?255:1),g=parseInt(a[2],10)/(/%$/.test(a[2])?100:1)*(/%$/.test(a[2])?
255:1),d=parseInt(a[3],10)/(/%$/.test(a[3])?100:1)*(/%$/.test(a[3])?255:1);return[parseInt(c,10),parseInt(g,10),parseInt(d,10),a[4]?parseFloat(a[4]):1]}},e.Color.fromRgba=h.fromRgb,e.Color.fromHsl=function(a){return h.fromSource(h.sourceFromHsl(a))},e.Color.sourceFromHsl=function(a){if(a=a.match(h.reHSLa)){var c=(parseFloat(a[1])%360+360)%360/360,g=parseFloat(a[2])/(/%$/.test(a[2])?100:1),d=parseFloat(a[3])/(/%$/.test(a[3])?100:1);if(0===g)d=g=c=d;else var e=.5>=d?d*(g+1):d+g-d*g,b=2*d-e,d=f(b,e,
c+1/3),g=f(b,e,c),c=f(b,e,c-1/3);return[Math.round(255*d),Math.round(255*g),Math.round(255*c),a[4]?parseFloat(a[4]):1]}},e.Color.fromHsla=h.fromHsl,e.Color.fromHex=function(a){return h.fromSource(h.sourceFromHex(a))},e.Color.sourceFromHex=function(a){if(a.match(h.reHex)){var c=a.slice(a.indexOf("#")+1),g=3===c.length;a=g?c.charAt(0)+c.charAt(0):c.substring(0,2);var d=g?c.charAt(1)+c.charAt(1):c.substring(2,4),c=g?c.charAt(2)+c.charAt(2):c.substring(4,6);return[parseInt(a,16),parseInt(d,16),parseInt(c,
16),1]}},e.Color.fromSource=function(a){var c=new h;c.setSource(a);return c})})("undefined"!==typeof b?b:this);(function(){if(k.StaticCanvas)k.warn("fabric.StaticCanvas is already defined.");else{var b=k.util.object.extend,h=k.util.getElementOffset,f=k.util.removeFromArray,e=Error("Could not initialize `canvas` element");k.StaticCanvas=k.util.createClass({initialize:function(a,c){c||(c={});this._initStatic(a,c);k.StaticCanvas.activeInstance=this},backgroundColor:"",backgroundImage:null,overlayColor:"",
overlayImage:null,includeDefaultValues:!0,stateful:!0,renderOnAddRemove:!0,clipTo:null,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,preserveObjectStacking:!1,viewportTransform:[1,0,0,1,0,0],onBeforeScaleRotate:function(){},_initStatic:function(a,c){this._objects=[];this._createLowerCanvas(a);this._initOptions(c);this._setImageSmoothing();c.overlayImage&&this.setOverlayImage(c.overlayImage,this.renderAll.bind(this));c.backgroundImage&&this.setBackgroundImage(c.backgroundImage,
this.renderAll.bind(this));c.backgroundColor&&this.setBackgroundColor(c.backgroundColor,this.renderAll.bind(this));c.overlayColor&&this.setOverlayColor(c.overlayColor,this.renderAll.bind(this));this.calcOffset()},calcOffset:function(){this._offset=h(this.lowerCanvasEl);return this},setOverlayImage:function(a,c,g){return this.__setBgOverlayImage("overlayImage",a,c,g)},setBackgroundImage:function(a,c,g){return this.__setBgOverlayImage("backgroundImage",a,c,g)},setOverlayColor:function(a,c){return this.__setBgOverlayColor("overlayColor",
a,c)},setBackgroundColor:function(a,c){return this.__setBgOverlayColor("backgroundColor",a,c)},_setImageSmoothing:function(){var a=this.getContext();a.imageSmoothingEnabled=this.imageSmoothingEnabled;a.webkitImageSmoothingEnabled=this.imageSmoothingEnabled;a.mozImageSmoothingEnabled=this.imageSmoothingEnabled;a.msImageSmoothingEnabled=this.imageSmoothingEnabled;a.oImageSmoothingEnabled=this.imageSmoothingEnabled},__setBgOverlayImage:function(a,c,g,d){"string"===typeof c?k.util.loadImage(c,function(c){this[a]=
new k.Image(c,d);g&&g()},this,d&&d.crossOrigin):(d&&c.setOptions(d),this[a]=c,g&&g());return this},__setBgOverlayColor:function(a,c,g){if(c&&c.source){var d=this;k.util.loadImage(c.source,function(e){d[a]=new k.Pattern({source:e,repeat:c.repeat,offsetX:c.offsetX,offsetY:c.offsetY});g&&g()})}else this[a]=c,g&&g();return this},_createCanvasElement:function(){var a=k.document.createElement("canvas");a.style||(a.style={});if(!a)throw e;this._initCanvasElement(a);return a},_initCanvasElement:function(a){k.util.createCanvasElement(a);
if("undefined"===typeof a.getContext)throw e;},_initOptions:function(a){for(var c in a)this[c]=a[c];this.width=this.width||parseInt(this.lowerCanvasEl.width,10)||0;this.height=this.height||parseInt(this.lowerCanvasEl.height,10)||0;this.lowerCanvasEl.style&&(this.lowerCanvasEl.width=this.width,this.lowerCanvasEl.height=this.height,this.lowerCanvasEl.style.width=this.width+"px",this.lowerCanvasEl.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(a){this.lowerCanvasEl=
k.util.getById(a)||this._createCanvasElement();this._initCanvasElement(this.lowerCanvasEl);k.util.addClass(this.lowerCanvasEl,"lower-canvas");this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl);this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(a,c){return this.setDimensions({width:a},c)},setHeight:function(a,c){return this.setDimensions({height:a},c)},setDimensions:function(a,c){var g;
c=c||{};for(var d in a)g=a[d],c.cssOnly||(this._setBackstoreDimension(d,a[d]),g+="px"),c.backstoreOnly||this._setCssDimension(d,g);c.cssOnly||this.renderAll();this.calcOffset();return this},_setBackstoreDimension:function(a,c){this.lowerCanvasEl[a]=c;this.upperCanvasEl&&(this.upperCanvasEl[a]=c);this.cacheCanvasEl&&(this.cacheCanvasEl[a]=c);this[a]=c;return this},_setCssDimension:function(a,c){this.lowerCanvasEl.style[a]=c;this.upperCanvasEl&&(this.upperCanvasEl.style[a]=c);this.wrapperEl&&(this.wrapperEl.style[a]=
c);return this},getZoom:function(){return Math.sqrt(this.viewportTransform[0]*this.viewportTransform[3])},setViewportTransform:function(a){var c=this.getActiveGroup();this.viewportTransform=a;this.renderAll();a=0;for(var g=this._objects.length;a<g;a++)this._objects[a].setCoords();c&&c.setCoords();return this},zoomToPoint:function(a,c){var g=a;a=k.util.transformPoint(a,k.util.invertTransform(this.viewportTransform));this.viewportTransform[0]=c;this.viewportTransform[3]=c;var d=k.util.transformPoint(a,
this.viewportTransform);this.viewportTransform[4]+=g.x-d.x;this.viewportTransform[5]+=g.y-d.y;this.renderAll();g=0;for(d=this._objects.length;g<d;g++)this._objects[g].setCoords();return this},setZoom:function(a){this.zoomToPoint(new k.Point(0,0),a);return this},absolutePan:function(a){this.viewportTransform[4]=-a.x;this.viewportTransform[5]=-a.y;this.renderAll();a=0;for(var c=this._objects.length;a<c;a++)this._objects[a].setCoords();return this},relativePan:function(a){return this.absolutePan(new k.Point(-a.x-
this.viewportTransform[4],-a.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},getActiveObject:function(){return null},getActiveGroup:function(){return null},_draw:function(a,c){if(c){a.save();var g=this.viewportTransform;a.transform(g[0],g[1],g[2],g[3],g[4],g[5]);this._shouldRenderObject(c)&&c.render(a);a.restore();this.controlsAboveOverlay||c._renderControls(a)}},_shouldRenderObject:function(a){return a?a!==this.getActiveGroup()||!this.preserveObjectStacking:!1},_onObjectAdded:function(a){this.stateful&&
a.setupState();a.canvas=this;a.setCoords();this.fire("object:added",{target:a});a.fire("added")},_onObjectRemoved:function(a){this.getActiveObject()===a&&(this.fire("before:selection:cleared",{target:a}),this._discardActiveObject(),this.fire("selection:cleared"));this.fire("object:removed",{target:a});a.fire("removed")},clearContext:function(a){a.clearRect(0,0,this.width,this.height);return this},getContext:function(){return this.contextContainer},clear:function(){this._objects.length=0;this.discardActiveGroup&&
this.discardActiveGroup();this.discardActiveObject&&this.discardActiveObject();this.clearContext(this.contextContainer);this.contextTop&&this.clearContext(this.contextTop);this.fire("canvas:cleared");this.renderAll();return this},renderAll:function(a){var c=this[!0===a&&this.interactive?"contextTop":"contextContainer"],g=this.getActiveGroup();this.contextTop&&this.selection&&!this._groupSelector&&this.clearContext(this.contextTop);a||this.clearContext(c);this.fire("before:render");this.clipTo&&k.util.clipContext(this,
c);this._renderBackground(c);this._renderObjects(c,g);this._renderActiveGroup(c,g);this.clipTo&&c.restore();this._renderOverlay(c);this.controlsAboveOverlay&&this.interactive&&this.drawControls(c);this.fire("after:render");return this},_renderObjects:function(a,c){var g,d;if(!c||this.preserveObjectStacking)for(g=0,d=this._objects.length;g<d;++g)this._draw(a,this._objects[g]);else for(g=0,d=this._objects.length;g<d;++g)this._objects[g]&&!c.contains(this._objects[g])&&this._draw(a,this._objects[g])},
_renderActiveGroup:function(a,c){if(c){var g=[];this.forEachObject(function(d){c.contains(d)&&g.push(d)});c._set("objects",g);this._draw(a,c)}},_renderBackground:function(a){this.backgroundColor&&(a.fillStyle=this.backgroundColor.toLive?this.backgroundColor.toLive(a):this.backgroundColor,a.fillRect(this.backgroundColor.offsetX||0,this.backgroundColor.offsetY||0,this.width,this.height));this.backgroundImage&&this._draw(a,this.backgroundImage)},_renderOverlay:function(a){this.overlayColor&&(a.fillStyle=
this.overlayColor.toLive?this.overlayColor.toLive(a):this.overlayColor,a.fillRect(this.overlayColor.offsetX||0,this.overlayColor.offsetY||0,this.width,this.height));this.overlayImage&&this._draw(a,this.overlayImage)},renderTop:function(){var a=this.contextTop||this.contextContainer;this.clearContext(a);this.selection&&this._groupSelector&&this._drawSelection();var c=this.getActiveGroup();c&&c.render(a);this._renderOverlay(a);this.fire("after:render");return this},getCenter:function(){return{top:this.getHeight()/
2,left:this.getWidth()/2}},centerObjectH:function(a){this._centerObject(a,new k.Point(this.getCenter().left,a.getCenterPoint().y));this.renderAll();return this},centerObjectV:function(a){this._centerObject(a,new k.Point(a.getCenterPoint().x,this.getCenter().top));this.renderAll();return this},centerObject:function(a){var c=this.getCenter();this._centerObject(a,new k.Point(c.left,c.top));this.renderAll();return this},_centerObject:function(a,c){a.setPositionByOrigin(c,"center","center");return this},
toDatalessJSON:function(a){return this.toDatalessObject(a)},toObject:function(a){return this._toObjectMethod("toObject",a)},toDatalessObject:function(a){return this._toObjectMethod("toDatalessObject",a)},_toObjectMethod:function(a,c){var g={objects:this._toObjects(a,c)};b(g,this.__serializeBgOverlay());k.util.populateWithProperties(this,g,c);return g},_toObjects:function(a,c){return this.getObjects().map(function(g){return this._toObject(g,a,c)},this)},_toObject:function(a,c,g){var d;this.includeDefaultValues||
(d=a.includeDefaultValues,a.includeDefaultValues=!1);var e=this._realizeGroupTransformOnObject(a);c=a[c](g);this.includeDefaultValues||(a.includeDefaultValues=d);this._unwindGroupTransformOnObject(a,e);return c},_realizeGroupTransformOnObject:function(a){var c="angle flipX flipY height left scaleX scaleY top width".split(" ");if(a.group&&a.group===this.getActiveGroup()){var g={};c.forEach(function(d){g[d]=a[d]});this.getActiveGroup().realizeTransform(a);return g}return null},_unwindGroupTransformOnObject:function(a,
c){c&&a.set(c)},__serializeBgOverlay:function(){var a={background:this.backgroundColor&&this.backgroundColor.toObject?this.backgroundColor.toObject():this.backgroundColor};this.overlayColor&&(a.overlay=this.overlayColor.toObject?this.overlayColor.toObject():this.overlayColor);this.backgroundImage&&(a.backgroundImage=this.backgroundImage.toObject());this.overlayImage&&(a.overlayImage=this.overlayImage.toObject());return a},svgViewportTransformation:!0,toSVG:function(a,c){a||(a={});var g=[];this._setSVGPreamble(g,
a);this._setSVGHeader(g,a);this._setSVGBgOverlayColor(g,"backgroundColor");this._setSVGBgOverlayImage(g,"backgroundImage");this._setSVGObjects(g,c);this._setSVGBgOverlayColor(g,"overlayColor");this._setSVGBgOverlayImage(g,"overlayImage");g.push("</svg>");return g.join("")},_setSVGPreamble:function(a,c){c.suppressPreamble||a.push('<?xml version="1.0" encoding="',c.encoding||"UTF-8",'" standalone="no" ?>','<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ','"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n')},
_setSVGHeader:function(a,c){var g,d,e;c.viewBox?(g=c.viewBox.width,d=c.viewBox.height):(g=this.width,d=this.height,this.svgViewportTransformation||(e=this.viewportTransform,g/=e[0],d/=e[3]));a.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',g,'" ','height="',d,'" ',this.backgroundColor&&!this.backgroundColor.toLive?'style="background-color: '+this.backgroundColor+'" ':null,c.viewBox?'viewBox="'+c.viewBox.x+" "+c.viewBox.y+
" "+c.viewBox.width+" "+c.viewBox.height+'" ':null,'xml:space="preserve">',"<desc>Created with Fabric.js ",k.version,"</desc>","<defs>",k.createSVGFontFacesMarkup(this.getObjects()),k.createSVGRefElementsMarkup(this),"</defs>")},_setSVGObjects:function(a,c){for(var g=0,d=this.getObjects(),e=d.length;g<e;g++){var f=d[g],h=this._realizeGroupTransformOnObject(f);a.push(f.toSVG(c));this._unwindGroupTransformOnObject(f,h)}},_setSVGBgOverlayImage:function(a,c){this[c]&&this[c].toSVG&&a.push(this[c].toSVG())},
_setSVGBgOverlayColor:function(a,c){this[c]&&this[c].source?a.push('<rect x="',this[c].offsetX,'" y="',this[c].offsetY,'" ','width="',"repeat-y"===this[c].repeat||"no-repeat"===this[c].repeat?this[c].source.width:this.width,'" height="',"repeat-x"===this[c].repeat||"no-repeat"===this[c].repeat?this[c].source.height:this.height,'" fill="url(#'+c+'Pattern)"',"></rect>"):this[c]&&"overlayColor"===c&&a.push('<rect x="0" y="0" ','width="',this.width,'" height="',this.height,'" fill="',this[c],'"',"></rect>")},
sendToBack:function(a){f(this._objects,a);this._objects.unshift(a);return this.renderAll&&this.renderAll()},bringToFront:function(a){f(this._objects,a);this._objects.push(a);return this.renderAll&&this.renderAll()},sendBackwards:function(a,c){var g=this._objects.indexOf(a);0!==g&&(g=this._findNewLowerIndex(a,g,c),f(this._objects,a),this._objects.splice(g,0,a),this.renderAll&&this.renderAll());return this},_findNewLowerIndex:function(a,c,g){if(g)for(g=c,--c;0<=c;--c){if(a.intersectsWithObject(this._objects[c])||
a.isContainedWithinObject(this._objects[c])||this._objects[c].isContainedWithinObject(a)){g=c;break}}else g=c-1;return g},bringForward:function(a,c){var g=this._objects.indexOf(a);g!==this._objects.length-1&&(g=this._findNewUpperIndex(a,g,c),f(this._objects,a),this._objects.splice(g,0,a),this.renderAll&&this.renderAll());return this},_findNewUpperIndex:function(a,c,g){if(g)for(g=c,c+=1;c<this._objects.length;++c){if(a.intersectsWithObject(this._objects[c])||a.isContainedWithinObject(this._objects[c])||
this._objects[c].isContainedWithinObject(a)){g=c;break}}else g=c+1;return g},moveTo:function(a,c){f(this._objects,a);this._objects.splice(c,0,a);return this.renderAll&&this.renderAll()},dispose:function(){this.clear();this.interactive&&this.removeListeners();return this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this.getObjects().length+" }>"}});b(k.StaticCanvas.prototype,k.Observable);b(k.StaticCanvas.prototype,k.Collection);b(k.StaticCanvas.prototype,k.DataURLExporter);
b(k.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(a){var c=k.util.createCanvasElement();if(!c||!c.getContext)return null;var g=c.getContext("2d");if(!g)return null;switch(a){case "getImageData":return"undefined"!==typeof g.getImageData;case "setLineDash":return"undefined"!==typeof g.setLineDash;case "toDataURL":return"undefined"!==typeof c.toDataURL;case "toDataURLWithQuality":try{return c.toDataURL("image/jpeg",0),!0}catch(d){}return!1;default:return null}}});
k.StaticCanvas.prototype.toJSON=k.StaticCanvas.prototype.toObject}})();(function(){var b=k.util.getPointer,h=k.util.degreesToRadians,f=k.util.radiansToDegrees,e=Math.atan2,a=Math.abs;k.Canvas=k.util.createClass(k.StaticCanvas,{initialize:function(g,d){d||(d={});this._initStatic(g,d);this._initInteractive();this._createCacheCanvas();k.Canvas.activeInstance=this},uniScaleTransform:!1,centeredScaling:!1,centeredRotation:!1,interactive:!0,selection:!0,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],
selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",rotationCursor:"crosshair",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,_initInteractive:function(){this._groupSelector=this._currentTransform=null;this._initWrapperElement();this._createUpperCanvas();this._initEventListeners();this.freeDrawingBrush=k.PencilBrush&&new k.PencilBrush(this);this.calcOffset()},
_resetCurrentTransform:function(g){var d=this._currentTransform;d.target.set({scaleX:d.original.scaleX,scaleY:d.original.scaleY,left:d.original.left,top:d.original.top});this._shouldCenterTransform(g,d.target)?"rotate"===d.action?this._setOriginToCenter(d.target):("center"!==d.originX&&(d.mouseXSign="right"===d.originX?-1:1),"center"!==d.originY&&(d.mouseYSign="bottom"===d.originY?-1:1),d.originX="center",d.originY="center"):(d.originX=d.original.originX,d.originY=d.original.originY)},containsPoint:function(g,
d){var a=this.getPointer(g,!0),c=this._normalizePointer(d,a);return d.containsPoint(c)||d._findTargetCorner(a)},_normalizePointer:function(g,d){var a=this.getActiveGroup(),c=d.x,e=d.y;a&&"group"!==g.type&&a.contains(g)&&(a=new k.Point(a.left,a.top),a=k.util.transformPoint(a,this.viewportTransform,!0),c-=a.x,e-=a.y);return{x:c,y:e}},isTargetTransparent:function(g,d,a){var c=g.hasBorders,e=g.transparentCorners;g.hasBorders=g.transparentCorners=!1;this._draw(this.contextCache,g);g.hasBorders=c;g.transparentCorners=
e;g=k.util.isTransparent(this.contextCache,d,a,this.targetFindTolerance);this.clearContext(this.contextCache);return g},_shouldClearSelection:function(g,d){var a=this.getActiveGroup(),c=this.getActiveObject();return!d||d&&a&&!a.contains(d)&&a!==d&&!g.shiftKey||d&&!d.evented||d&&!d.selectable&&c&&c!==d},_shouldCenterTransform:function(g,d){if(d){var a=this._currentTransform,c;"scale"===a.action||"scaleX"===a.action||"scaleY"===a.action?c=this.centeredScaling||d.centeredScaling:"rotate"===a.action&&
(c=this.centeredRotation||d.centeredRotation);return c?!g.altKey:g.altKey}},_getOriginFromCorner:function(g,d){var a={x:g.originX,y:g.originY};if("ml"===d||"tl"===d||"bl"===d)a.x="right";else if("mr"===d||"tr"===d||"br"===d)a.x="left";if("tl"===d||"mt"===d||"tr"===d)a.y="bottom";else if("bl"===d||"mb"===d||"br"===d)a.y="top";return a},_getActionFromCorner:function(g,d){var a="drag";d&&(a="ml"===d||"mr"===d?"scaleX":"mt"===d||"mb"===d?"scaleY":"mtr"===d?"rotate":"scale");return a},_setupCurrentTransform:function(g,
d){if(d){var a=this.getPointer(g),c=d._findTargetCorner(this.getPointer(g,!0)),e=this._getActionFromCorner(d,c),c=this._getOriginFromCorner(d,c);this._currentTransform={target:d,action:e,scaleX:d.scaleX,scaleY:d.scaleY,offsetX:a.x-d.left,offsetY:a.y-d.top,originX:c.x,originY:c.y,ex:a.x,ey:a.y,left:d.left,top:d.top,theta:h(d.angle),width:d.width*d.scaleX,mouseXSign:1,mouseYSign:1};this._currentTransform.original={left:d.left,top:d.top,scaleX:d.scaleX,scaleY:d.scaleY,originX:c.x,originY:c.y};this._resetCurrentTransform(g)}},
_translateObject:function(a,d){var c=this._currentTransform.target;c.get("lockMovementX")||c.set("left",a-this._currentTransform.offsetX);c.get("lockMovementY")||c.set("top",d-this._currentTransform.offsetY)},_scaleObject:function(a,d,c){var e=this._currentTransform,f=e.target,h=f.get("lockScalingX"),b=f.get("lockScalingY"),l=f.get("lockScalingFlip");if(!h||!b){var p=f.translateToOriginPoint(f.getCenterPoint(),e.originX,e.originY);a=f.toLocalPoint(new k.Point(a,d),e.originX,e.originY);this._setLocalMouse(a,
e);this._setObjectScale(a,e,h,b,c,l);f.setPositionByOrigin(p,e.originX,e.originY)}},_setObjectScale:function(a,d,c,e,f,h){var b=d.target,k=!1,l=!1,p=b.stroke?b.strokeWidth:0;d.newScaleX=a.x/(b.width+p/2);d.newScaleY=a.y/(b.height+p/2);h&&0>=d.newScaleX&&d.newScaleX<b.scaleX&&(k=!0);h&&0>=d.newScaleY&&d.newScaleY<b.scaleY&&(l=!0);"equally"!==f||c||e?f?"x"!==f||b.get("lockUniScaling")?"y"!==f||b.get("lockUniScaling")||l||e||b.set("scaleY",d.newScaleY):k||c||b.set("scaleX",d.newScaleX):(k||c||b.set("scaleX",
d.newScaleX),l||e||b.set("scaleY",d.newScaleY)):k||l||this._scaleObjectEqually(a,b,d);k||l||this._flipObject(d,f)},_scaleObjectEqually:function(a,d,c){a=a.y+a.x;var e=d.stroke?d.strokeWidth:0,e=(d.height+e/2)*c.original.scaleY+(d.width+e/2)*c.original.scaleX;c.newScaleX=c.original.scaleX*a/e;c.newScaleY=c.original.scaleY*a/e;d.set("scaleX",c.newScaleX);d.set("scaleY",c.newScaleY)},_flipObject:function(a,d){0>a.newScaleX&&"y"!==d&&("left"===a.originX?a.originX="right":"right"===a.originX&&(a.originX=
"left"));0>a.newScaleY&&"x"!==d&&("top"===a.originY?a.originY="bottom":"bottom"===a.originY&&(a.originY="top"))},_setLocalMouse:function(g,d){var c=d.target;"right"===d.originX?g.x*=-1:"center"===d.originX&&(g.x=2*g.x*d.mouseXSign,0>g.x&&(d.mouseXSign=-d.mouseXSign));"bottom"===d.originY?g.y*=-1:"center"===d.originY&&(g.y=2*g.y*d.mouseYSign,0>g.y&&(d.mouseYSign=-d.mouseYSign));a(g.x)>c.padding?g.x=0>g.x?g.x+c.padding:g.x-c.padding:g.x=0;a(g.y)>c.padding?g.y=0>g.y?g.y+c.padding:g.y-c.padding:g.y=0},
_rotateObject:function(a,d){var c=this._currentTransform;if(!c.target.get("lockRotation")){var h=e(c.ey-c.top,c.ex-c.left),b=e(d-c.top,a-c.left),h=f(b-h+c.theta);0>h&&(h=360+h);c.target.angle=h%360}},setCursor:function(a){this.upperCanvasEl.style.cursor=a},_resetObjectTransform:function(a){a.scaleX=1;a.scaleY=1;a.setAngle(0)},_drawSelection:function(){var g=this.contextTop,d=this._groupSelector,c=d.left,e=d.top,f=a(c),h=a(e);g.fillStyle=this.selectionColor;g.fillRect(d.ex-(0<c?0:-c),d.ey-(0<e?0:-e),
f,h);g.lineWidth=this.selectionLineWidth;g.strokeStyle=this.selectionBorderColor;1<this.selectionDashArray.length?(c=d.ex+.5-(0<c?0:f),d=d.ey+.5-(0<e?0:h),g.beginPath(),k.util.drawDashedLine(g,c,d,c+f,d,this.selectionDashArray),k.util.drawDashedLine(g,c,d+h-1,c+f,d+h-1,this.selectionDashArray),k.util.drawDashedLine(g,c,d,c,d+h,this.selectionDashArray),k.util.drawDashedLine(g,c+f-1,d,c+f-1,d+h,this.selectionDashArray),g.closePath(),g.stroke()):g.strokeRect(d.ex+.5-(0<c?0:f),d.ey+.5-(0<e?0:h),f,h)},
_isLastRenderedObject:function(a){return this.controlsAboveOverlay&&this.lastRenderedObjectWithControlsAboveOverlay&&this.lastRenderedObjectWithControlsAboveOverlay.visible&&this.containsPoint(a,this.lastRenderedObjectWithControlsAboveOverlay)&&this.lastRenderedObjectWithControlsAboveOverlay._findTargetCorner(this.getPointer(a,!0))},findTarget:function(a,d){if(!this.skipTargetFind){if(this._isLastRenderedObject(a))return this.lastRenderedObjectWithControlsAboveOverlay;var c=this.getActiveGroup();
if(c&&!d&&this.containsPoint(a,c))return c;c=this._searchPossibleTargets(a);this._fireOverOutEvents(c);return c}},_fireOverOutEvents:function(a){a?this._hoveredTarget!==a&&(this.fire("mouse:over",{target:a}),a.fire("mouseover"),this._hoveredTarget&&(this.fire("mouse:out",{target:this._hoveredTarget}),this._hoveredTarget.fire("mouseout")),this._hoveredTarget=a):this._hoveredTarget&&(this.fire("mouse:out",{target:this._hoveredTarget}),this._hoveredTarget.fire("mouseout"),this._hoveredTarget=null)},
_checkTarget:function(a,d,c){if(d&&d.visible&&d.evented&&this.containsPoint(a,d)&&(!this.perPixelTargetFind&&!d.perPixelTargetFind||d.isEditing||!this.isTargetTransparent(d,c.x,c.y)))return!0},_searchPossibleTargets:function(a){for(var d,c=this.getPointer(a,!0),e=this._objects.length;e--;)if(!this._objects[e].group&&this._checkTarget(a,this._objects[e],c)){this.relatedTarget=this._objects[e];d=this._objects[e];break}return d},getPointer:function(a,d,c){c||(c=this.upperCanvasEl);a=b(a,c);var e=c.getBoundingClientRect(),
f=e.width||0,h=e.height||0;f&&h||("top"in e&&"bottom"in e&&(h=Math.abs(e.top-e.bottom)),"right"in e&&"left"in e&&(f=Math.abs(e.right-e.left)));this.calcOffset();a.x-=this._offset.left;a.y-=this._offset.top;d||(a=k.util.transformPoint(a,k.util.invertTransform(this.viewportTransform)));0===f||0===h?c=d=1:(d=c.width/f,c=c.height/h);return{x:a.x*d,y:a.y*c}},_createUpperCanvas:function(){var a=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,"");this.upperCanvasEl=this._createCanvasElement();
k.util.addClass(this.upperCanvasEl,"upper-canvas "+a);this.wrapperEl.appendChild(this.upperCanvasEl);this._copyCanvasStyle(this.lowerCanvasEl,this.upperCanvasEl);this._applyCanvasStyle(this.upperCanvasEl);this.contextTop=this.upperCanvasEl.getContext("2d")},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement();this.cacheCanvasEl.setAttribute("width",this.width);this.cacheCanvasEl.setAttribute("height",this.height);this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=
k.util.wrapElement(this.lowerCanvasEl,"div",{"class":this.containerClass});k.util.setStyle(this.wrapperEl,{width:this.getWidth()+"px",height:this.getHeight()+"px",position:"relative"});k.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(a){var d=this.getWidth()||a.width,c=this.getHeight()||a.height;k.util.setStyle(a,{position:"absolute",width:d+"px",height:c+"px",left:0,top:0});a.width=d;a.height=c;k.util.makeElementUnselectable(a)},_copyCanvasStyle:function(a,d){d.style.cssText=
a.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},_setActiveObject:function(a){this._activeObject&&this._activeObject.set("active",!1);this._activeObject=a;a.set("active",!0)},setActiveObject:function(a,d){this._setActiveObject(a);this.renderAll();this.fire("object:selected",{target:a,e:d});a.fire("selected",{e:d});return this},getActiveObject:function(){return this._activeObject},_discardActiveObject:function(){this._activeObject&&
this._activeObject.set("active",!1);this._activeObject=null},discardActiveObject:function(a){this._discardActiveObject();this.renderAll();this.fire("selection:cleared",{e:a});return this},_setActiveGroup:function(a){(this._activeGroup=a)&&a.set("active",!0)},setActiveGroup:function(a,d){this._setActiveGroup(a);a&&(this.fire("object:selected",{target:a,e:d}),a.fire("selected",{e:d}));return this},getActiveGroup:function(){return this._activeGroup},_discardActiveGroup:function(){var a=this.getActiveGroup();
a&&a.destroy();this.setActiveGroup(null)},discardActiveGroup:function(a){this._discardActiveGroup();this.fire("selection:cleared",{e:a});return this},deactivateAll:function(){for(var a=this.getObjects(),d=0,c=a.length;d<c;d++)a[d].set("active",!1);this._discardActiveGroup();this._discardActiveObject();return this},deactivateAllWithDispatch:function(a){var d=this.getActiveGroup()||this.getActiveObject();d&&this.fire("before:selection:cleared",{target:d,e:a});this.deactivateAll();d&&this.fire("selection:cleared",
{e:a});return this},drawControls:function(a){var d=this.getActiveGroup();d?this._drawGroupControls(a,d):this._drawObjectsControls(a)},_drawGroupControls:function(a,d){d._renderControls(a)},_drawObjectsControls:function(a){for(var d=0,c=this._objects.length;d<c;++d)this._objects[d]&&this._objects[d].active&&(this._objects[d]._renderControls(a),this.lastRenderedObjectWithControlsAboveOverlay=this._objects[d])}});for(var c in k.StaticCanvas)"prototype"!==c&&(k.Canvas[c]=k.StaticCanvas[c]);k.isTouchSupported&&
(k.Canvas.prototype._setCursorFromEvent=function(){});k.Element=k.Canvas})();(function(){var b={mt:0,tr:1,mr:2,br:3,mb:4,bl:5,ml:6,tl:7},h=k.util.addListener,f=k.util.removeListener;k.util.object.extend(k.Canvas.prototype,{cursorMap:"n-resize ne-resize e-resize se-resize s-resize sw-resize w-resize nw-resize".split(" "),_initEventListeners:function(){this._bindEvents();h(k.window,"resize",this._onResize);h(this.upperCanvasEl,"mousedown",this._onMouseDown);h(this.upperCanvasEl,"mousemove",this._onMouseMove);
h(this.upperCanvasEl,"mousewheel",this._onMouseWheel);h(this.upperCanvasEl,"touchstart",this._onMouseDown);h(this.upperCanvasEl,"touchmove",this._onMouseMove);"undefined"!==typeof eventjs&&"add"in eventjs&&(eventjs.add(this.upperCanvasEl,"gesture",this._onGesture),eventjs.add(this.upperCanvasEl,"drag",this._onDrag),eventjs.add(this.upperCanvasEl,"orientation",this._onOrientationChange),eventjs.add(this.upperCanvasEl,"shake",this._onShake),eventjs.add(this.upperCanvasEl,"longpress",this._onLongPress))},
_bindEvents:function(){this._onMouseDown=this._onMouseDown.bind(this);this._onMouseMove=this._onMouseMove.bind(this);this._onMouseUp=this._onMouseUp.bind(this);this._onResize=this._onResize.bind(this);this._onGesture=this._onGesture.bind(this);this._onDrag=this._onDrag.bind(this);this._onShake=this._onShake.bind(this);this._onLongPress=this._onLongPress.bind(this);this._onOrientationChange=this._onOrientationChange.bind(this);this._onMouseWheel=this._onMouseWheel.bind(this)},removeListeners:function(){f(k.window,
"resize",this._onResize);f(this.upperCanvasEl,"mousedown",this._onMouseDown);f(this.upperCanvasEl,"mousemove",this._onMouseMove);f(this.upperCanvasEl,"mousewheel",this._onMouseWheel);f(this.upperCanvasEl,"touchstart",this._onMouseDown);f(this.upperCanvasEl,"touchmove",this._onMouseMove);"undefined"!==typeof eventjs&&"remove"in eventjs&&(eventjs.remove(this.upperCanvasEl,"gesture",this._onGesture),eventjs.remove(this.upperCanvasEl,"drag",this._onDrag),eventjs.remove(this.upperCanvasEl,"orientation",
this._onOrientationChange),eventjs.remove(this.upperCanvasEl,"shake",this._onShake),eventjs.remove(this.upperCanvasEl,"longpress",this._onLongPress))},_onGesture:function(e,a){this.__onTransformGesture&&this.__onTransformGesture(e,a)},_onDrag:function(e,a){this.__onDrag&&this.__onDrag(e,a)},_onMouseWheel:function(e,a){this.__onMouseWheel&&this.__onMouseWheel(e,a)},_onOrientationChange:function(e,a){this.__onOrientationChange&&this.__onOrientationChange(e,a)},_onShake:function(e,a){this.__onShake&&
this.__onShake(e,a)},_onLongPress:function(e,a){this.__onLongPress&&this.__onLongPress(e,a)},_onMouseDown:function(e){this.__onMouseDown(e);h(k.document,"touchend",this._onMouseUp);h(k.document,"touchmove",this._onMouseMove);f(this.upperCanvasEl,"mousemove",this._onMouseMove);f(this.upperCanvasEl,"touchmove",this._onMouseMove);"touchstart"===e.type?f(this.upperCanvasEl,"mousedown",this._onMouseDown):(h(k.document,"mouseup",this._onMouseUp),h(k.document,"mousemove",this._onMouseMove))},_onMouseUp:function(e){this.__onMouseUp(e);
f(k.document,"mouseup",this._onMouseUp);f(k.document,"touchend",this._onMouseUp);f(k.document,"mousemove",this._onMouseMove);f(k.document,"touchmove",this._onMouseMove);h(this.upperCanvasEl,"mousemove",this._onMouseMove);h(this.upperCanvasEl,"touchmove",this._onMouseMove);if("touchend"===e.type){var a=this;setTimeout(function(){h(a.upperCanvasEl,"mousedown",a._onMouseDown)},400)}},_onMouseMove:function(e){!this.allowTouchScrolling&&e.preventDefault&&e.preventDefault();this.__onMouseMove(e)},_onResize:function(){this.calcOffset()},
_shouldRender:function(e,a){var c=this.getActiveGroup()||this.getActiveObject();return!!(e&&(e.isMoving||e!==c)||!e&&c||!e&&!c&&!this._groupSelector||a&&this._previousPointer&&this.selection&&(a.x!==this._previousPointer.x||a.y!==this._previousPointer.y))},__onMouseUp:function(e){var a;if(this.isDrawingMode&&this._isCurrentlyDrawing)this._onMouseUpInDrawingMode(e);else{this._currentTransform?(this._finalizeCurrentTransform(),a=this._currentTransform.target):a=this.findTarget(e,!0);var c=this._shouldRender(a,
this.getPointer(e));this._maybeGroupObjects(e);a&&(a.isMoving=!1);c&&this.renderAll();this._handleCursorAndEvent(e,a)}},_handleCursorAndEvent:function(e,a){this._setCursorFromEvent(e,a);var c=this;setTimeout(function(){c._setCursorFromEvent(e,a)},50);this.fire("mouse:up",{target:a,e:e});a&&a.fire("mouseup",{e:e})},_finalizeCurrentTransform:function(){var e=this._currentTransform.target;e._scaling&&(e._scaling=!1);e.setCoords();this.stateful&&e.hasStateChanged()&&(this.fire("object:modified",{target:e}),
e.fire("modified"));this._restoreOriginXY(e)},_restoreOriginXY:function(e){if(this._previousOriginX&&this._previousOriginY){var a=e.translateToOriginPoint(e.getCenterPoint(),this._previousOriginX,this._previousOriginY);e.originX=this._previousOriginX;e.originY=this._previousOriginY;e.left=a.x;e.top=a.y;this._previousOriginY=this._previousOriginX=null}},_onMouseDownInDrawingMode:function(e){this._isCurrentlyDrawing=!0;this.discardActiveObject(e).renderAll();this.clipTo&&k.util.clipContext(this,this.contextTop);
var a=k.util.invertTransform(this.viewportTransform),a=k.util.transformPoint(this.getPointer(e,!0),a);this.freeDrawingBrush.onMouseDown(a);this.fire("mouse:down",{e:e});a=this.findTarget(e);"undefined"!==typeof a&&a.fire("mousedown",{e:e,target:a})},_onMouseMoveInDrawingMode:function(e){if(this._isCurrentlyDrawing){var a=k.util.invertTransform(this.viewportTransform),a=k.util.transformPoint(this.getPointer(e,!0),a);this.freeDrawingBrush.onMouseMove(a)}this.setCursor(this.freeDrawingCursor);this.fire("mouse:move",
{e:e});a=this.findTarget(e);"undefined"!==typeof a&&a.fire("mousemove",{e:e,target:a})},_onMouseUpInDrawingMode:function(e){this._isCurrentlyDrawing=!1;this.clipTo&&this.contextTop.restore();this.freeDrawingBrush.onMouseUp();this.fire("mouse:up",{e:e});var a=this.findTarget(e);"undefined"!==typeof a&&a.fire("mouseup",{e:e,target:a})},__onMouseDown:function(e){if(("which"in e?1===e.which:1===e.button)||k.isTouchSupported)if(this.isDrawingMode)this._onMouseDownInDrawingMode(e);else if(!this._currentTransform){var a=
this.findTarget(e),c=this.getPointer(e,!0);this._previousPointer=c;var g=this._shouldRender(a,c),d=this._shouldGroup(e,a);this._shouldClearSelection(e,a)?this._clearSelection(e,a,c):d&&(this._handleGrouping(e,a),a=this.getActiveGroup());a&&a.selectable&&!d&&(this._beforeTransform(e,a),this._setupCurrentTransform(e,a));g&&this.renderAll();this.fire("mouse:down",{target:a,e:e});a&&a.fire("mousedown",{e:e})}},_beforeTransform:function(e,a){this.stateful&&a.saveState();if(a._findTargetCorner(this.getPointer(e)))this.onBeforeScaleRotate(a);
a!==this.getActiveGroup()&&a!==this.getActiveObject()&&(this.deactivateAll(),this.setActiveObject(a,e))},_clearSelection:function(e,a,c){this.deactivateAllWithDispatch(e);a&&a.selectable?this.setActiveObject(a,e):this.selection&&(this._groupSelector={ex:c.x,ey:c.y,top:0,left:0})},_setOriginToCenter:function(e){this._previousOriginX=this._currentTransform.target.originX;this._previousOriginY=this._currentTransform.target.originY;var a=e.getCenterPoint();e.originX="center";e.originY="center";e.left=
a.x;e.top=a.y;this._currentTransform.left=e.left;this._currentTransform.top=e.top},_setCenterToOrigin:function(e){var a=e.translateToOriginPoint(e.getCenterPoint(),this._previousOriginX,this._previousOriginY);e.originX=this._previousOriginX;e.originY=this._previousOriginY;e.left=a.x;e.top=a.y;this._previousOriginY=this._previousOriginX=null},__onMouseMove:function(e){var a,c;if(this.isDrawingMode)this._onMouseMoveInDrawingMode(e);else if(!("undefined"!==typeof e.touches&&1<e.touches.length)){var g=
this._groupSelector;g?(c=this.getPointer(e,!0),g.left=c.x-g.ex,g.top=c.y-g.ey,this.renderTop()):this._currentTransform?this._transformObject(e):(a=this.findTarget(e),!a||a&&!a.selectable?this.setCursor(this.defaultCursor):this._setCursorFromEvent(e,a));this.fire("mouse:move",{target:a,e:e});a&&a.fire("mousemove",{e:e})}},_transformObject:function(e){var a=this.getPointer(e),c=this._currentTransform;c.reset=!1;c.target.isMoving=!0;this._beforeScaleTransform(e,c);this._performTransformAction(e,c,a);
this.renderAll()},_performTransformAction:function(e,a,c){var g=c.x;c=c.y;var d=a.target,f=a.action;"rotate"===f?(this._rotateObject(g,c),this._fire("rotating",d,e)):"scale"===f?(this._onScale(e,a,g,c),this._fire("scaling",d,e)):"scaleX"===f?(this._scaleObject(g,c,"x"),this._fire("scaling",d,e)):"scaleY"===f?(this._scaleObject(g,c,"y"),this._fire("scaling",d,e)):(this._translateObject(g,c),this._fire("moving",d,e),this.setCursor(this.moveCursor))},_fire:function(e,a,c){this.fire("object:"+e,{target:a,
e:c});a.fire(e,{e:c})},_beforeScaleTransform:function(e,a){if("scale"===a.action||"scaleX"===a.action||"scaleY"===a.action){var c=this._shouldCenterTransform(e,a.target);if(c&&("center"!==a.originX||"center"!==a.originY)||!c&&"center"===a.originX&&"center"===a.originY)this._resetCurrentTransform(e),a.reset=!0}},_onScale:function(e,a,c,g){!e.shiftKey&&!this.uniScaleTransform||a.target.get("lockUniScaling")?(a.reset||"scale"!==a.currentAction||this._resetCurrentTransform(e,a.target),a.currentAction=
"scaleEqually",this._scaleObject(c,g,"equally")):(a.currentAction="scale",this._scaleObject(c,g))},_setCursorFromEvent:function(e,a){if(a&&a.selectable){var c=this.getActiveGroup();(c=a._findTargetCorner&&(!c||!c.contains(a))&&a._findTargetCorner(this.getPointer(e,!0)))?this._setCornerCursor(c,a):this.setCursor(a.hoverCursor||this.hoverCursor)}else return this.setCursor(this.defaultCursor),!1;return!0},_setCornerCursor:function(e,a){if(e in b)this.setCursor(this._getRotatedCornerCursor(e,a));else if("mtr"===
e&&a.hasRotatingPoint)this.setCursor(this.rotationCursor);else return this.setCursor(this.defaultCursor),!1},_getRotatedCornerCursor:function(e,a){var c=Math.round(a.getAngle()%360/45);0>c&&(c+=8);c+=b[e];return this.cursorMap[c%8]}})})();(function(){var b=Math.min,h=Math.max;k.util.object.extend(k.Canvas.prototype,{_shouldGroup:function(f,e){var a=this.getActiveObject();return f.shiftKey&&(this.getActiveGroup()||a&&a!==e)&&this.selection},_handleGrouping:function(f,e){if(e===this.getActiveGroup()&&
(e=this.findTarget(f,!0),!e||e.isType("group")))return;this.getActiveGroup()?this._updateActiveGroup(e,f):this._createActiveGroup(e,f);this._activeGroup&&this._activeGroup.saveCoords()},_updateActiveGroup:function(f,e){var a=this.getActiveGroup();if(a.contains(f)){if(a.removeWithUpdate(f),this._resetObjectTransform(a),f.set("active",!1),1===a.size()){this.discardActiveGroup(e);this.setActiveObject(a.item(0));return}}else a.addWithUpdate(f),this._resetObjectTransform(a);this.fire("selection:created",
{target:a,e:e});a.set("active",!0)},_createActiveGroup:function(f,e){if(this._activeObject&&f!==this._activeObject){var a=this._createGroup(f);a.addWithUpdate();this.setActiveGroup(a);this._activeObject=null;this.fire("selection:created",{target:a,e:e})}f.set("active",!0)},_createGroup:function(f){var e=this.getObjects();f=e.indexOf(this._activeObject)<e.indexOf(f)?[this._activeObject,f]:[f,this._activeObject];return new k.Group(f,{canvas:this})},_groupSelectedObjects:function(f){var e=this._collectObjects();
1===e.length?this.setActiveObject(e[0],f):1<e.length&&(e=new k.Group(e.reverse(),{canvas:this}),e.addWithUpdate(),this.setActiveGroup(e,f),e.saveCoords(),this.fire("selection:created",{target:e}),this.renderAll())},_collectObjects:function(){var f=[],e;e=this._groupSelector.ex;for(var a=this._groupSelector.ey,c=e+this._groupSelector.left,g=a+this._groupSelector.top,d=new k.Point(b(e,c),b(a,g)),r=new k.Point(h(e,c),h(a,g)),a=e===c&&a===g,c=this._objects.length;c--&&!((e=this._objects[c])&&e.selectable&&
e.visible&&(e.intersectsWithRect(d,r)||e.isContainedWithinRect(d,r)||e.containsPoint(d)||e.containsPoint(r))&&(e.set("active",!0),f.push(e),a)););return f},_maybeGroupObjects:function(f){this.selection&&this._groupSelector&&this._groupSelectedObjects(f);if(f=this.getActiveGroup())f.setObjectsCoords().setCoords(),f.isMoving=!1,this.setCursor(this.defaultCursor);this._currentTransform=this._groupSelector=null}})})();k.util.object.extend(k.StaticCanvas.prototype,{toDataURL:function(b){b||(b={});var h=
b.format||"png",f=b.quality||1,e=b.multiplier||1;b={left:b.left,top:b.top,width:b.width,height:b.height};return 1!==e?this.__toDataURLWithMultiplier(h,f,b,e):this.__toDataURL(h,f,b)},__toDataURL:function(b,h,f){this.renderAll(!0);var e=this.upperCanvasEl||this.lowerCanvasEl;f=this.__getCroppedCanvas(e,f);"jpg"===b&&(b="jpeg");b=k.StaticCanvas.supports("toDataURLWithQuality")?(f||e).toDataURL("image/"+b,h):(f||e).toDataURL("image/"+b);this.contextTop&&this.clearContext(this.contextTop);this.renderAll();
return b},__getCroppedCanvas:function(b,h){var f,e;if("left"in h||"top"in h||"width"in h||"height"in h)f=k.util.createCanvasElement(),e=f.getContext("2d"),f.width=h.width||this.width,f.height=h.height||this.height,e.drawImage(b,-h.left||0,-h.top||0);return f},__toDataURLWithMultiplier:function(b,h,f,e){var a=this.getWidth(),c=this.getHeight(),g=a*e,d=c*e,k=this.getActiveObject(),w=this.getActiveGroup(),l=this.contextTop||this.contextContainer;1<e&&this.setWidth(g).setHeight(d);l.scale(e,e);f.left&&
(f.left*=e);f.top&&(f.top*=e);f.width?f.width*=e:1>e&&(f.width=g);f.height?f.height*=e:1>e&&(f.height=d);w?this._tempRemoveBordersControlsFromGroup(w):k&&this.deactivateAll&&this.deactivateAll();this.renderAll(!0);b=this.__toDataURL(b,h,f);this.width=a;this.height=c;l.scale(1/e,1/e);this.setWidth(a).setHeight(c);w?this._restoreBordersControlsOnGroup(w):k&&this.setActiveObject&&this.setActiveObject(k);this.contextTop&&this.clearContext(this.contextTop);this.renderAll();return b},toDataURLWithMultiplier:function(b,
h,f){return this.toDataURL({format:b,multiplier:h,quality:f})},_tempRemoveBordersControlsFromGroup:function(b){b.origHasControls=b.hasControls;b.origBorderColor=b.borderColor;b.hasControls=!0;b.borderColor="rgba(0,0,0,0)";b.forEachObject(function(h){h.origBorderColor=h.borderColor;h.borderColor="rgba(0,0,0,0)"})},_restoreBordersControlsOnGroup:function(b){b.hideControls=b.origHideControls;b.borderColor=b.origBorderColor;b.forEachObject(function(b){b.borderColor=b.origBorderColor;delete b.origBorderColor})}});
(function(b){var h=b.fabric||(b.fabric={});b=h.util.object.extend;var f=h.util.toFixed,e=h.util.string.capitalize,a=h.util.degreesToRadians,c=h.StaticCanvas.supports("setLineDash");h.Object||(h.Object=h.util.createClass({type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,cornerSize:12,transparentCorners:!0,hoverCursor:null,padding:0,borderColor:"rgba(102,153,255,0.75)",cornerColor:"rgba(102,153,255,0.5)",centeredScaling:!1,
centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:10,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,transformMatrix:null,minScaleLimit:.01,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,hasRotatingPoint:!0,rotatingPointOffset:40,perPixelTargetFind:!1,includeDefaultValues:!0,clipTo:null,lockMovementX:!1,
lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockUniScaling:!1,lockScalingFlip:!1,stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeLineJoin strokeMiterLimit angle opacity fill fillRule globalCompositeOperation shadow clipTo visible backgroundColor".split(" "),initialize:function(a){a&&this.setOptions(a)},_initGradient:function(a){!a.fill||!a.fill.colorStops||a.fill instanceof
h.Gradient||this.set("fill",new h.Gradient(a.fill))},_initPattern:function(a){!a.fill||!a.fill.source||a.fill instanceof h.Pattern||this.set("fill",new h.Pattern(a.fill));!a.stroke||!a.stroke.source||a.stroke instanceof h.Pattern||this.set("stroke",new h.Pattern(a.stroke))},_initClipping:function(a){a.clipTo&&"string"===typeof a.clipTo&&(a=h.util.getFunctionBody(a.clipTo),"undefined"!==typeof a&&(this.clipTo=new Function("ctx",a)))},setOptions:function(a){for(var d in a)this.set(d,a[d]);this._initGradient(a);
this._initPattern(a);this._initClipping(a)},transform:function(g,d){var c=d?this._getLeftTopCoords():this.getCenterPoint();g.translate(c.x,c.y);g.rotate(a(this.angle));g.scale(this.scaleX*(this.flipX?-1:1),this.scaleY*(this.flipY?-1:1))},toObject:function(a){var d=h.Object.NUM_FRACTION_DIGITS,d={type:this.type,originX:this.originX,originY:this.originY,left:f(this.left,d),top:f(this.top,d),width:f(this.width,d),height:f(this.height,d),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,
stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:f(this.strokeWidth,d),strokeDashArray:this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:f(this.strokeMiterLimit,d),scaleX:f(this.scaleX,d),scaleY:f(this.scaleY,d),angle:f(this.getAngle(),d),flipX:this.flipX,flipY:this.flipY,opacity:f(this.opacity,d),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,clipTo:this.clipTo&&
String(this.clipTo),backgroundColor:this.backgroundColor,fillRule:this.fillRule,globalCompositeOperation:this.globalCompositeOperation};this.includeDefaultValues||(d=this._removeDefaultValues(d));h.util.populateWithProperties(this,d,a);return d},toDatalessObject:function(a){return this.toObject(a)},_removeDefaultValues:function(a){var d=h.util.getKlass(a.type).prototype;d.stateProperties.forEach(function(c){a[c]===d[c]&&delete a[c]});return a},toString:function(){return"#<fabric."+e(this.type)+">"},
get:function(a){return this[a]},_setObject:function(a){for(var d in a)this._set(d,a[d])},set:function(a,d){"object"===typeof a?this._setObject(a):"function"===typeof d&&"clipTo"!==a?this._set(a,d(this.get(a))):this._set(a,d);return this},_set:function(a,d){if("scaleX"===a||"scaleY"===a)d=this._constrainScale(d);"scaleX"===a&&0>d?(this.flipX=!this.flipX,d*=-1):"scaleY"===a&&0>d?(this.flipY=!this.flipY,d*=-1):"width"===a||"height"===a?this.minScaleLimit=f(Math.min(.1,1/Math.max(this.width,this.height)),
2):"shadow"!==a||!d||d instanceof h.Shadow||(d=new h.Shadow(d));this[a]=d;return this},toggle:function(a){var d=this.get(a);"boolean"===typeof d&&this.set(a,!d);return this},setSourcePath:function(a){this.sourcePath=a;return this},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:[1,0,0,1,0,0]},render:function(a,d){0===this.width&&0===this.height||!this.visible||(a.save(),this._setupCompositeOperation(a),d||this.transform(a),this._setStrokeStyles(a),
this._setFillStyles(a),this.transformMatrix&&a.transform.apply(a,this.transformMatrix),this._setOpacity(a),this._setShadow(a),this.clipTo&&h.util.clipContext(this,a),this._render(a,d),this.clipTo&&a.restore(),this._removeShadow(a),this._restoreCompositeOperation(a),a.restore())},_setOpacity:function(a){this.group&&this.group._setOpacity(a);a.globalAlpha*=this.opacity},_setStrokeStyles:function(a){this.stroke&&(a.lineWidth=this.strokeWidth,a.lineCap=this.strokeLineCap,a.lineJoin=this.strokeLineJoin,
a.miterLimit=this.strokeMiterLimit,a.strokeStyle=this.stroke.toLive?this.stroke.toLive(a,this):this.stroke)},_setFillStyles:function(a){this.fill&&(a.fillStyle=this.fill.toLive?this.fill.toLive(a,this):this.fill)},_renderControls:function(c,d){if(this.active&&!d){var e=this.getViewportTransform();c.save();var f;this.group&&(f=h.util.transformPoint(this.group.getCenterPoint(),e),c.translate(f.x,f.y),c.rotate(a(this.group.angle)));f=h.util.transformPoint(this.getCenterPoint(),e,null!=this.group);this.group&&
(f.x*=this.group.scaleX,f.y*=this.group.scaleY);c.translate(f.x,f.y);c.rotate(a(this.angle));this.drawBorders(c);this.drawControls(c);c.restore()}},_setShadow:function(a){if(this.shadow){var d=this.canvas&&this.canvas.viewportTransform[0]||1,c=this.canvas&&this.canvas.viewportTransform[3]||1;a.shadowColor=this.shadow.color;a.shadowBlur=this.shadow.blur*(d+c)*(this.scaleX+this.scaleY)/4;a.shadowOffsetX=this.shadow.offsetX*d*this.scaleX;a.shadowOffsetY=this.shadow.offsetY*c*this.scaleY}},_removeShadow:function(a){this.shadow&&
(a.shadowColor="",a.shadowBlur=a.shadowOffsetX=a.shadowOffsetY=0)},_renderFill:function(a){this.fill&&(a.save(),this.fill.gradientTransform&&a.transform.apply(a,this.fill.gradientTransform),this.fill.toLive&&a.translate(-this.width/2+this.fill.offsetX||0,-this.height/2+this.fill.offsetY||0),"evenodd"===this.fillRule?a.fill("evenodd"):a.fill(),a.restore(),this.shadow&&!this.shadow.affectStroke&&this._removeShadow(a))},_renderStroke:function(a){this.stroke&&0!==this.strokeWidth&&(a.save(),this.strokeDashArray?
(1&this.strokeDashArray.length&&this.strokeDashArray.push.apply(this.strokeDashArray,this.strokeDashArray),c?(a.setLineDash(this.strokeDashArray),this._stroke&&this._stroke(a)):this._renderDashedStroke&&this._renderDashedStroke(a),a.stroke()):(this.stroke.gradientTransform&&a.transform.apply(a,this.stroke.gradientTransform),this._stroke?this._stroke(a):a.stroke()),this._removeShadow(a),a.restore())},clone:function(a,d){return this.constructor.fromObject?this.constructor.fromObject(this.toObject(d),
a):new h.Object(this.toObject(d))},cloneAsImage:function(a){var d=this.toDataURL();h.util.loadImage(d,function(d){a&&a(new h.Image(d))});return this},toDataURL:function(a){a||(a={});var d=h.util.createCanvasElement(),c=this.getBoundingRect();d.width=c.width;d.height=c.height;h.util.wrapElement(d,"div");c=new h.StaticCanvas(d);"jpg"===a.format&&(a.format="jpeg");"jpeg"===a.format&&(c.backgroundColor="#fff");var e={active:this.get("active"),left:this.getLeft(),top:this.getTop()};this.set("active",!1);
this.setPositionByOrigin(new h.Point(d.width/2,d.height/2),"center","center");d=this.canvas;c.add(this);a=c.toDataURL(a);this.set(e).setCoords();this.canvas=d;c.dispose();return a},isType:function(a){return this.type===a},complexity:function(){return 0},toJSON:function(a){return this.toObject(a)},setGradient:function(a,d){d||(d={});var c={colorStops:[]};c.type=d.type||(d.r1||d.r2?"radial":"linear");c.coords={x1:d.x1,y1:d.y1,x2:d.x2,y2:d.y2};if(d.r1||d.r2)c.coords.r1=d.r1,c.coords.r2=d.r2;for(var e in d.colorStops){var f=
new h.Color(d.colorStops[e]);c.colorStops.push({offset:e,color:f.toRgb(),opacity:f.getAlpha()})}return this.set(a,h.Gradient.forObject(this,c))},setPatternFill:function(a){return this.set("fill",new h.Pattern(a))},setShadow:function(a){return this.set("shadow",a?new h.Shadow(a):null)},setColor:function(a){this.set("fill",a);return this},setAngle:function(a){var d=("center"!==this.originX||"center"!==this.originY)&&this.centeredRotation;d&&this._setOriginToCenter();this.set("angle",a);d&&this._resetOrigin();
return this},centerH:function(){this.canvas.centerObjectH(this);return this},centerV:function(){this.canvas.centerObjectV(this);return this},center:function(){this.canvas.centerObject(this);return this},remove:function(){this.canvas.remove(this);return this},getLocalPointer:function(a,d){d=d||this.canvas.getPointer(a);var c=this.translateToOriginPoint(this.getCenterPoint(),"left","top");return{x:d.x-c.x,y:d.y-c.y}},_setupCompositeOperation:function(a){this.globalCompositeOperation&&(this._prevGlobalCompositeOperation=
a.globalCompositeOperation,a.globalCompositeOperation=this.globalCompositeOperation)},_restoreCompositeOperation:function(a){this.globalCompositeOperation&&this._prevGlobalCompositeOperation&&(a.globalCompositeOperation=this._prevGlobalCompositeOperation)}}),h.util.createAccessors(h.Object),h.Object.prototype.rotate=h.Object.prototype.setAngle,b(h.Object.prototype,h.Observable),h.Object.NUM_FRACTION_DIGITS=2,h.Object.__uid=0)})("undefined"!==typeof b?b:this);(function(){var b=k.util.degreesToRadians;
k.util.object.extend(k.Object.prototype,{translateToCenterPoint:function(h,f,e){var a=h.x,c=h.y,g=this.stroke?this.strokeWidth:0;"left"===f?a=h.x+(this.getWidth()+g*this.scaleX)/2:"right"===f&&(a=h.x-(this.getWidth()+g*this.scaleX)/2);"top"===e?c=h.y+(this.getHeight()+g*this.scaleY)/2:"bottom"===e&&(c=h.y-(this.getHeight()+g*this.scaleY)/2);return k.util.rotatePoint(new k.Point(a,c),h,b(this.angle))},translateToOriginPoint:function(h,f,e){var a=h.x,c=h.y,g=this.stroke?this.strokeWidth:0;"left"===
f?a=h.x-(this.getWidth()+g*this.scaleX)/2:"right"===f&&(a=h.x+(this.getWidth()+g*this.scaleX)/2);"top"===e?c=h.y-(this.getHeight()+g*this.scaleY)/2:"bottom"===e&&(c=h.y+(this.getHeight()+g*this.scaleY)/2);return k.util.rotatePoint(new k.Point(a,c),h,b(this.angle))},getCenterPoint:function(){var b=new k.Point(this.left,this.top);return this.translateToCenterPoint(b,this.originX,this.originY)},getPointByOrigin:function(b,f){var e=this.getCenterPoint();return this.translateToOriginPoint(e,b,f)},toLocalPoint:function(h,
f,e){var a=this.getCenterPoint(),c=this.stroke?this.strokeWidth:0;f&&e?(f="left"===f?a.x-(this.getWidth()+c*this.scaleX)/2:"right"===f?a.x+(this.getWidth()+c*this.scaleX)/2:a.x,e="top"===e?a.y-(this.getHeight()+c*this.scaleY)/2:"bottom"===e?a.y+(this.getHeight()+c*this.scaleY)/2:a.y):(f=this.left,e=this.top);return k.util.rotatePoint(new k.Point(h.x,h.y),a,-b(this.angle)).subtractEquals(new k.Point(f,e))},setPositionByOrigin:function(b,f,e){b=this.translateToCenterPoint(b,f,e);b=this.translateToOriginPoint(b,
this.originX,this.originY);this.set("left",b.x);this.set("top",b.y)},adjustPosition:function(h){var f=b(this.angle),e=this.getWidth()/2,a=Math.cos(f)*e,e=Math.sin(f)*e,c=this.getWidth(),g=Math.cos(f)*c,f=Math.sin(f)*c;"center"===this.originX&&"left"===h||"right"===this.originX&&"center"===h?(this.left-=a,this.top-=e):"left"===this.originX&&"center"===h||"center"===this.originX&&"right"===h?(this.left+=a,this.top+=e):"left"===this.originX&&"right"===h?(this.left+=g,this.top+=f):"right"===this.originX&&
"left"===h&&(this.left-=g,this.top-=f);this.setCoords();this.originX=h},_setOriginToCenter:function(){this._originalOriginX=this.originX;this._originalOriginY=this.originY;var b=this.getCenterPoint();this.originY=this.originX="center";this.left=b.x;this.top=b.y},_resetOrigin:function(){var b=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX;this.originY=this._originalOriginY;this.left=b.x;this.top=b.y;this._originalOriginY=
this._originalOriginX=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","center")}})})();(function(){var b=k.util.degreesToRadians;k.util.object.extend(k.Object.prototype,{oCoords:null,intersectsWithRect:function(b,f){var e=this.oCoords,a=new k.Point(e.tl.x,e.tl.y),c=new k.Point(e.tr.x,e.tr.y),g=new k.Point(e.bl.x,e.bl.y),e=new k.Point(e.br.x,e.br.y);return"Intersection"===k.Intersection.intersectPolygonRectangle([a,c,e,g],b,f).status},intersectsWithObject:function(b){function f(a){return{tl:new k.Point(a.tl.x,
a.tl.y),tr:new k.Point(a.tr.x,a.tr.y),bl:new k.Point(a.bl.x,a.bl.y),br:new k.Point(a.br.x,a.br.y)}}var e=f(this.oCoords);b=f(b.oCoords);return"Intersection"===k.Intersection.intersectPolygonPolygon([e.tl,e.tr,e.br,e.bl],[b.tl,b.tr,b.br,b.bl]).status},isContainedWithinObject:function(b){var f=b.getBoundingRect();b=new k.Point(f.left,f.top);f=new k.Point(f.left+f.width,f.top+f.height);return this.isContainedWithinRect(b,f)},isContainedWithinRect:function(b,f){var e=this.getBoundingRect();return e.left>=
b.x&&e.left+e.width<=f.x&&e.top>=b.y&&e.top+e.height<=f.y},containsPoint:function(b){var f=this._getImageLines(this.oCoords);b=this._findCrossPoints(b,f);return 0!==b&&1===b%2},_getImageLines:function(b){return{topline:{o:b.tl,d:b.tr},rightline:{o:b.tr,d:b.br},bottomline:{o:b.br,d:b.bl},leftline:{o:b.bl,d:b.tl}}},_findCrossPoints:function(b,f){var e,a,c,g=0,d;for(d in f)if(c=f[d],!(c.o.y<b.y&&c.d.y<b.y||c.o.y>=b.y&&c.d.y>=b.y)&&(c.o.x===c.d.x&&c.o.x>=b.x?e=c.o.x:(e=(c.d.y-c.o.y)/(c.d.x-c.o.x),a=b.y-
0*b.x,c=c.o.y-e*c.o.x,e=-(a-c)/(0-e)),e>=b.x&&(g+=1),2===g))break;return g},getBoundingRectWidth:function(){return this.getBoundingRect().width},getBoundingRectHeight:function(){return this.getBoundingRect().height},getBoundingRect:function(){this.oCoords||this.setCoords();var b=[this.oCoords.tl.x,this.oCoords.tr.x,this.oCoords.br.x,this.oCoords.bl.x],f=k.util.array.min(b),b=k.util.array.max(b),b=Math.abs(f-b),e=[this.oCoords.tl.y,this.oCoords.tr.y,this.oCoords.br.y,this.oCoords.bl.y],a=k.util.array.min(e),
e=k.util.array.max(e);return{left:f,top:a,width:b,height:Math.abs(a-e)}},getWidth:function(){return this.width*this.scaleX},getHeight:function(){return this.height*this.scaleY},_constrainScale:function(b){return Math.abs(b)<this.minScaleLimit?0>b?-this.minScaleLimit:this.minScaleLimit:b},scale:function(b){b=this._constrainScale(b);0>b&&(this.flipX=!this.flipX,this.flipY=!this.flipY,b*=-1);this.scaleY=this.scaleX=b;this.setCoords();return this},scaleToWidth:function(b){var f=this.getBoundingRectWidth()/
this.getWidth();return this.scale(b/this.width/f)},scaleToHeight:function(b){var f=this.getBoundingRectHeight()/this.getHeight();return this.scale(b/this.height/f)},setCoords:function(){var h=b(this.angle),f=this.getViewportTransform(),e=function(a){return k.util.transformPoint(a,f)},a=this._calculateCurrentDimensions(!1),c=a.x,g=a.y;0>c&&(c=Math.abs(c));var a=Math.sqrt(Math.pow(c/2,2)+Math.pow(g/2,2)),d=Math.atan(isFinite(g/c)?g/c:0),l=Math.cos(d+h)*a,d=Math.sin(d+h)*a,a=Math.sin(h),h=Math.cos(h),
w=this.getCenterPoint(),g=new k.Point(c,g),w=new k.Point(w.x-l,w.y-d),d=new k.Point(w.x+g.x*h,w.y+g.x*a),c=e(new k.Point(w.x-g.y*a,w.y+g.y*h)),l=e(new k.Point(d.x-g.y*a,d.y+g.y*h)),g=e(w),e=e(d),d=new k.Point((g.x+c.x)/2,(g.y+c.y)/2),w=new k.Point((e.x+g.x)/2,(e.y+g.y)/2),z=new k.Point((l.x+e.x)/2,(l.y+e.y)/2),ia=new k.Point((l.x+c.x)/2,(l.y+c.y)/2),a=new k.Point(w.x+a*this.rotatingPointOffset,w.y-h*this.rotatingPointOffset);this.oCoords={tl:g,tr:e,br:l,bl:c,ml:d,mt:w,mr:z,mb:ia,mtr:a};this._setCornerCoords&&
this._setCornerCoords();return this}})})();k.util.object.extend(k.Object.prototype,{sendToBack:function(){this.group?k.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas.sendToBack(this);return this},bringToFront:function(){this.group?k.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas.bringToFront(this);return this},sendBackwards:function(b){this.group?k.StaticCanvas.prototype.sendBackwards.call(this.group,this,b):this.canvas.sendBackwards(this,b);return this},
bringForward:function(b){this.group?k.StaticCanvas.prototype.bringForward.call(this.group,this,b):this.canvas.bringForward(this,b);return this},moveTo:function(b){this.group?k.StaticCanvas.prototype.moveTo.call(this.group,this,b):this.canvas.moveTo(this,b);return this}});k.util.object.extend(k.Object.prototype,{getSvgStyles:function(){var b=this.fill?this.fill.toLive?"url(#SVGID_"+this.fill.id+")":this.fill:"none",h=this.fillRule,f=this.stroke?this.stroke.toLive?"url(#SVGID_"+this.stroke.id+")":this.stroke:
"none",e=this.strokeWidth?this.strokeWidth:"0",a=this.strokeDashArray?this.strokeDashArray.join(" "):"";return["stroke: ",f,"; stroke-width: ",e,"; stroke-dasharray: ",a,"; stroke-linecap: ",this.strokeLineCap?this.strokeLineCap:"butt","; stroke-linejoin: ",this.strokeLineJoin?this.strokeLineJoin:"miter","; stroke-miterlimit: ",this.strokeMiterLimit?this.strokeMiterLimit:"4","; fill: ",b,"; fill-rule: ",h,"; opacity: ","undefined"!==typeof this.opacity?this.opacity:"1",";",this.shadow?"filter: url(#SVGID_"+
this.shadow.id+");":"",this.visible?"":" visibility: hidden;"].join("")},getSvgTransform:function(){if(this.group&&"path-group"===this.group.type)return"";var b=k.util.toFixed,h=this.getAngle(),f=!this.canvas||this.canvas.svgViewportTransformation?this.getViewportTransform():[1,0,0,1,0,0],e=k.util.transformPoint(this.getCenterPoint(),f),a=k.Object.NUM_FRACTION_DIGITS,e="path-group"===this.type?"":"translate("+b(e.x,a)+" "+b(e.y,a)+")",h=0!==h?" rotate("+b(h,a)+")":"",b=1===this.scaleX&&1===this.scaleY&&
1===f[0]&&1===f[3]?"":" scale("+b(this.scaleX*f[0],a)+" "+b(this.scaleY*f[3],a)+")",a="path-group"===this.type?this.width*f[0]:0,f="path-group"===this.type?this.height*f[3]:0;return[e,h,b,this.flipX?" matrix(-1 0 0 1 "+a+" 0) ":"",this.flipY?" matrix(1 0 0 -1 0 "+f+")":""].join("")},getSvgTransformMatrix:function(){return this.transformMatrix?" matrix("+this.transformMatrix.join(" ")+") ":""},_createBaseSVGMarkup:function(){var b=[];this.fill&&this.fill.toLive&&b.push(this.fill.toSVG(this,!1));this.stroke&&
this.stroke.toLive&&b.push(this.stroke.toSVG(this,!1));this.shadow&&b.push(this.shadow.toSVG(this));return b}});k.util.object.extend(k.Object.prototype,{hasStateChanged:function(){return this.stateProperties.some(function(b){return this.get(b)!==this.originalState[b]},this)},saveState:function(b){this.stateProperties.forEach(function(b){this.originalState[b]=this.get(b)},this);b&&b.stateProperties&&b.stateProperties.forEach(function(b){this.originalState[b]=this.get(b)},this);return this},setupState:function(){this.originalState=
{};this.saveState();return this}});(function(){var b=k.util.degreesToRadians;k.util.object.extend(k.Object.prototype,{_controlsVisibility:null,_findTargetCorner:function(b){if(!this.hasControls||!this.active)return!1;var f=b.x;b=b.y;var e,a;for(a in this.oCoords)if(this.isControlVisible(a)&&("mtr"!==a||this.hasRotatingPoint)&&(!this.get("lockUniScaling")||"mt"!==a&&"mr"!==a&&"mb"!==a&&"ml"!==a)&&(e=this._getImageLines(this.oCoords[a].corner),e=this._findCrossPoints({x:f,y:b},e),0!==e&&1===e%2))return this.__corner=
a;return!1},_setCornerCoords:function(){var h=this.oCoords,f=b(45-this.angle),e=Math.sqrt(2*Math.pow(this.cornerSize,2))/2,a=e*Math.cos(f),f=e*Math.sin(f),c,g;for(g in h)e=h[g].x,c=h[g].y,h[g].corner={tl:{x:e-f,y:c-a},tr:{x:e+a,y:c-f},bl:{x:e-a,y:c+f},br:{x:e+f,y:c+a}}},_calculateCurrentDimensions:function(b){var f=this.getViewportTransform(),e=this.strokeWidth,a=this.width,c=this.height,g="round"===this.strokeLineCap||"square"===this.strokeLineCap,d="line"===this.type&&0===this.width,l="line"===
this.type&&0===this.height,w=d||l;d?a=e:l&&(c=e);(g&&l||!w)&&(a+=0>a?-e:e);(g&&d||!w)&&(c+=0>c?-e:e);a=a*this.scaleX+2*this.padding;c=c*this.scaleY+2*this.padding;return b?k.util.transformPoint(new k.Point(a,c),f,!0):{x:a,y:c}},drawBorders:function(b){if(!this.hasBorders)return this;b.save();b.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1;b.strokeStyle=this.borderColor;b.lineWidth=1/this.borderScaleFactor;var f=this._calculateCurrentDimensions(!0),e=f.x,f=f.y;this.group&&(e*=this.group.scaleX,
f*=this.group.scaleY);b.strokeRect(~~-(e/2)-.5,~~-(f/2)-.5,~~e+1,~~f+1);this.hasRotatingPoint&&this.isControlVisible("mtr")&&!this.get("lockRotation")&&this.hasControls&&(e=-f/2,b.beginPath(),b.moveTo(0,e),b.lineTo(0,e-this.rotatingPointOffset),b.closePath(),b.stroke());b.restore();return this},drawControls:function(b){if(!this.hasControls)return this;var f=this._calculateCurrentDimensions(!0),e=f.x,f=f.y,a=-(e/2),c=-(f/2),g=this.cornerSize/2,d=this.transparentCorners?"strokeRect":"fillRect";b.save();
b.lineWidth=1;b.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1;b.strokeStyle=b.fillStyle=this.cornerColor;this._drawControl("tl",b,d,a-g,c-g);this._drawControl("tr",b,d,a+e-g,c-g);this._drawControl("bl",b,d,a-g,c+f-g);this._drawControl("br",b,d,a+e-g,c+f-g);this.get("lockUniScaling")||(this._drawControl("mt",b,d,a+e/2-g,c-g),this._drawControl("mb",b,d,a+e/2-g,c+f-g),this._drawControl("mr",b,d,a+e-g,c+f/2-g),this._drawControl("ml",b,d,a-g,c+f/2-g));this.hasRotatingPoint&&this._drawControl("mtr",
b,d,a+e/2-g,c-this.rotatingPointOffset-g);b.restore();return this},_drawControl:function(b,f,e,a,c){this.isControlVisible(b)&&(b=this.cornerSize,"undefined"!==typeof G_vmlCanvasManager||this.transparentCorners||f.clearRect(a,c,b,b),f[e](a,c,b,b))},isControlVisible:function(b){return this._getControlsVisibility()[b]},setControlVisible:function(b,f){this._getControlsVisibility()[b]=f;return this},setControlsVisibility:function(b){b||(b={});for(var f in b)this.setControlVisible(f,b[f]);return this},
_getControlsVisibility:function(){this._controlsVisibility||(this._controlsVisibility={tl:!0,tr:!0,br:!0,bl:!0,ml:!0,mt:!0,mr:!0,mb:!0,mtr:!0});return this._controlsVisibility}})})();(function(b){function h(a,d){var c=a.origin,e=a.axis1,b=a.axis2,f=a.dimension,h=d.nearest,k=d.center,l=d.farthest;return function(){switch(this.get(c)){case h:return Math.min(this.get(e),this.get(b));case k:return Math.min(this.get(e),this.get(b))+.5*this.get(f);case l:return Math.max(this.get(e),this.get(b))}}}var f=
b.fabric||(b.fabric={}),e=f.util.object.extend,a={x1:1,x2:1,y1:1,y2:1},c=f.StaticCanvas.supports("setLineDash");f.Line?f.warn("fabric.Line is already defined"):(f.Line=f.util.createClass(f.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,initialize:function(a,d){d=d||{};a||(a=[0,0,0,0]);this.callSuper("initialize",d);this.set("x1",a[0]);this.set("y1",a[1]);this.set("x2",a[2]);this.set("y2",a[3]);this._setWidthHeight(d)},_setWidthHeight:function(a){a||(a={});this.width=Math.abs(this.x2-this.x1);this.height=
Math.abs(this.y2-this.y1);this.left="left"in a?a.left:this._getLeftToOriginX();this.top="top"in a?a.top:this._getTopToOriginY()},_set:function(c,d){this.callSuper("_set",c,d);"undefined"!==typeof a[c]&&this._setWidthHeight();return this},_getLeftToOriginX:h({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:h({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(a,
d){a.beginPath();if(d){var e=this.getCenterPoint();a.translate(e.x-this.strokeWidth/2,e.y-this.strokeWidth/2)}if(!this.strokeDashArray||this.strokeDashArray&&c)e=this.calcLinePoints(),a.moveTo(e.x1,e.y1),a.lineTo(e.x2,e.y2);a.lineWidth=this.strokeWidth;e=a.strokeStyle;a.strokeStyle=this.stroke||a.fillStyle;this.stroke&&this._renderStroke(a);a.strokeStyle=e},_renderDashedStroke:function(a){var d=this.calcLinePoints();a.beginPath();f.util.drawDashedLine(a,d.x1,d.y1,d.x2,d.y2,this.strokeDashArray);a.closePath()},
toObject:function(a){return e(this.callSuper("toObject",a),this.calcLinePoints())},calcLinePoints:function(){var a=this.x1<=this.x2?-1:1,d=this.y1<=this.y2?-1:1;return{x1:a*this.width*.5,x2:a*this.width*-.5,y1:d*this.height*.5,y2:d*this.height*-.5}},toSVG:function(a){var d=this._createBaseSVGMarkup(),c={x1:this.x1,x2:this.x2,y1:this.y1,y2:this.y2};this.group&&"path-group"===this.group.type||(c=this.calcLinePoints());d.push("<line ",'x1="',c.x1,'" y1="',c.y1,'" x2="',c.x2,'" y2="',c.y2,'" style="',
this.getSvgStyles(),'" transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'"/>\n');return a?a(d.join("")):d.join("")},complexity:function(){return 1}}),f.Line.ATTRIBUTE_NAMES=f.SHARED_ATTRIBUTES.concat(["x1","y1","x2","y2"]),f.Line.fromElement=function(a,d){var c=f.parseAttributes(a,f.Line.ATTRIBUTE_NAMES);return new f.Line([c.x1||0,c.y1||0,c.x2||0,c.y2||0],e(c,d))},f.Line.fromObject=function(a){return new f.Line([a.x1,a.y1,a.x2,a.y2],a)})})("undefined"!==typeof b?b:this);(function(b){var h=
b.fabric||(b.fabric={}),f=Math.PI,e=h.util.object.extend;h.Circle?h.warn("fabric.Circle is already defined."):(h.Circle=h.util.createClass(h.Object,{type:"circle",radius:0,startAngle:0,endAngle:2*f,initialize:function(a){a=a||{};this.callSuper("initialize",a);this.set("radius",a.radius||0);this.startAngle=a.startAngle||this.startAngle;this.endAngle=a.endAngle||this.endAngle},_set:function(a,c){this.callSuper("_set",a,c);"radius"===a&&this.setRadius(c);return this},toObject:function(a){return e(this.callSuper("toObject",
a),{radius:this.get("radius"),startAngle:this.startAngle,endAngle:this.endAngle})},toSVG:function(a){var c=this._createBaseSVGMarkup(),g=0,d=0,e=(this.endAngle-this.startAngle)%(2*f);0===e?(this.group&&"path-group"===this.group.type&&(g=this.left+this.radius,d=this.top+this.radius),c.push("<circle ",'cx="'+g+'" cy="'+d+'" ','r="',this.radius,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform()," ",this.getSvgTransformMatrix(),'"/>\n')):c.push('<path d="M '+Math.cos(this.startAngle)*
this.radius+" "+Math.sin(this.startAngle)*this.radius," A "+this.radius+" "+this.radius," 0 ",+(e>f?1:0)+" 1"," "+Math.cos(this.endAngle)*this.radius+" "+Math.sin(this.endAngle)*this.radius,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform()," ",this.getSvgTransformMatrix(),'"/>\n');return a?a(c.join("")):c.join("")},_render:function(a,c){a.beginPath();a.arc(c?this.left+this.radius:0,c?this.top+this.radius:0,this.radius,this.startAngle,this.endAngle,!1);this._renderFill(a);this._renderStroke(a)},
getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(a){this.radius=a;this.set("width",2*a).set("height",2*a)},complexity:function(){return 1}}),h.Circle.ATTRIBUTE_NAMES=h.SHARED_ATTRIBUTES.concat(["cx","cy","r"]),h.Circle.fromElement=function(a,c){c||(c={});var g=h.parseAttributes(a,h.Circle.ATTRIBUTE_NAMES);if(!("radius"in g&&0<=g.radius))throw Error("value of `r` attribute is required and can not be negative");
g.left=g.left||0;g.top=g.top||0;g=new h.Circle(e(g,c));g.left-=g.radius;g.top-=g.radius;return g},h.Circle.fromObject=function(a){return new h.Circle(a)})})("undefined"!==typeof b?b:this);(function(b){var h=b.fabric||(b.fabric={});h.Triangle?h.warn("fabric.Triangle is already defined"):(h.Triangle=h.util.createClass(h.Object,{type:"triangle",initialize:function(b){b=b||{};this.callSuper("initialize",b);this.set("width",b.width||100).set("height",b.height||100)},_render:function(b){var e=this.width/
2,a=this.height/2;b.beginPath();b.moveTo(-e,a);b.lineTo(0,-a);b.lineTo(e,a);b.closePath();this._renderFill(b);this._renderStroke(b)},_renderDashedStroke:function(b){var e=this.width/2,a=this.height/2;b.beginPath();h.util.drawDashedLine(b,-e,a,0,-a,this.strokeDashArray);h.util.drawDashedLine(b,0,-a,e,a,this.strokeDashArray);h.util.drawDashedLine(b,e,a,-e,a,this.strokeDashArray);b.closePath()},toSVG:function(b){var e=this._createBaseSVGMarkup(),a=this.width/2,c=this.height/2,a=[-a+" "+c,"0 "+-c,a+" "+
c].join();e.push("<polygon ",'points="',a,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),'"/>');return b?b(e.join("")):e.join("")},complexity:function(){return 1}}),h.Triangle.fromObject=function(b){return new h.Triangle(b)})})("undefined"!==typeof b?b:this);(function(b){var h=b.fabric||(b.fabric={}),f=2*Math.PI,e=h.util.object.extend;h.Ellipse?h.warn("fabric.Ellipse is already defined."):(h.Ellipse=h.util.createClass(h.Object,{type:"ellipse",rx:0,ry:0,initialize:function(a){a=
a||{};this.callSuper("initialize",a);this.set("rx",a.rx||0);this.set("ry",a.ry||0)},_set:function(a,c){this.callSuper("_set",a,c);switch(a){case "rx":this.rx=c;this.set("width",2*c);break;case "ry":this.ry=c,this.set("height",2*c)}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(a){return e(this.callSuper("toObject",a),{rx:this.get("rx"),ry:this.get("ry")})},toSVG:function(a){var c=this._createBaseSVGMarkup(),
b=0,d=0;this.group&&"path-group"===this.group.type&&(b=this.left+this.rx,d=this.top+this.ry);c.push("<ellipse ",'cx="',b,'" cy="',d,'" ','rx="',this.rx,'" ry="',this.ry,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'"/>\n');return a?a(c.join("")):c.join("")},_render:function(a,c){a.beginPath();a.save();a.transform(1,0,0,this.ry/this.rx,0,0);a.arc(c?this.left+this.rx:0,c?(this.top+this.ry)*this.rx/this.ry:0,this.rx,0,f,!1);a.restore();this._renderFill(a);
this._renderStroke(a)},complexity:function(){return 1}}),h.Ellipse.ATTRIBUTE_NAMES=h.SHARED_ATTRIBUTES.concat(["cx","cy","rx","ry"]),h.Ellipse.fromElement=function(a,c){c||(c={});var b=h.parseAttributes(a,h.Ellipse.ATTRIBUTE_NAMES);b.left=b.left||0;b.top=b.top||0;b=new h.Ellipse(e(b,c));b.top-=b.ry;b.left-=b.rx;return b},h.Ellipse.fromObject=function(a){return new h.Ellipse(a)})})("undefined"!==typeof b?b:this);(function(b){var h=b.fabric||(b.fabric={}),f=h.util.object.extend;h.Rect?console.warn("fabric.Rect is already defined"):
(b=h.Object.prototype.stateProperties.concat(),b.push("rx","ry","x","y"),h.Rect=h.util.createClass(h.Object,{stateProperties:b,type:"rect",rx:0,ry:0,strokeDashArray:null,initialize:function(b){b=b||{};this.callSuper("initialize",b);this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(b,a){if(1===this.width&&1===this.height)b.fillRect(0,0,1,1);else{var c=this.rx?Math.min(this.rx,this.width/2):0,g=this.ry?Math.min(this.ry,this.height/
2):0,d=this.width,f=this.height,h=a?this.left:-this.width/2,k=a?this.top:-this.height/2,l=0!==c||0!==g;b.beginPath();b.moveTo(h+c,k);b.lineTo(h+d-c,k);l&&b.bezierCurveTo(h+d-.4477152502*c,k,h+d,k+.4477152502*g,h+d,k+g);b.lineTo(h+d,k+f-g);l&&b.bezierCurveTo(h+d,k+f-.4477152502*g,h+d-.4477152502*c,k+f,h+d-c,k+f);b.lineTo(h+c,k+f);l&&b.bezierCurveTo(h+.4477152502*c,k+f,h,k+f-.4477152502*g,h,k+f-g);b.lineTo(h,k+g);l&&b.bezierCurveTo(h,k+.4477152502*g,h+.4477152502*c,k,h+c,k);b.closePath();this._renderFill(b);
this._renderStroke(b)}},_renderDashedStroke:function(b){var a=-this.width/2,c=-this.height/2,g=this.width,d=this.height;b.beginPath();h.util.drawDashedLine(b,a,c,a+g,c,this.strokeDashArray);h.util.drawDashedLine(b,a+g,c,a+g,c+d,this.strokeDashArray);h.util.drawDashedLine(b,a+g,c+d,a,c+d,this.strokeDashArray);h.util.drawDashedLine(b,a,c+d,a,c,this.strokeDashArray);b.closePath()},toObject:function(b){b=f(this.callSuper("toObject",b),{rx:this.get("rx")||0,ry:this.get("ry")||0});this.includeDefaultValues||
this._removeDefaultValues(b);return b},toSVG:function(b){var a=this._createBaseSVGMarkup(),c=this.left,g=this.top;this.group&&"path-group"===this.group.type||(c=-this.width/2,g=-this.height/2);a.push("<rect ",'x="',c,'" y="',g,'" rx="',this.get("rx"),'" ry="',this.get("ry"),'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'"/>\n');return b?b(a.join("")):a.join("")},complexity:function(){return 1}}),
h.Rect.ATTRIBUTE_NAMES=h.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),h.Rect.fromElement=function(b,a){if(!b)return null;a=a||{};var c=h.parseAttributes(b,h.Rect.ATTRIBUTE_NAMES);c.left=c.left||0;c.top=c.top||0;c=new h.Rect(f(a?h.util.object.clone(a):{},c));c.visible=0<c.width&&0<c.height;return c},h.Rect.fromObject=function(b){return new h.Rect(b)})})("undefined"!==typeof b?b:this);(function(b){var h=b.fabric||(b.fabric={});h.Polyline?h.warn("fabric.Polyline is already defined"):
(h.Polyline=h.util.createClass(h.Object,{type:"polyline",points:null,minX:0,minY:0,initialize:function(b,e){return h.Polygon.prototype.initialize.call(this,b,e)},_calcDimensions:function(){return h.Polygon.prototype._calcDimensions.call(this)},_applyPointOffset:function(){return h.Polygon.prototype._applyPointOffset.call(this)},toObject:function(b){return h.Polygon.prototype.toObject.call(this,b)},toSVG:function(b){return h.Polygon.prototype.toSVG.call(this,b)},_render:function(b){h.Polygon.prototype.commonRender.call(this,
b)&&(this._renderFill(b),this._renderStroke(b))},_renderDashedStroke:function(b){var e,a;b.beginPath();for(var c=0,g=this.points.length;c<g;c++)e=this.points[c],a=this.points[c+1]||e,h.util.drawDashedLine(b,e.x,e.y,a.x,a.y,this.strokeDashArray)},complexity:function(){return this.get("points").length}}),h.Polyline.ATTRIBUTE_NAMES=h.SHARED_ATTRIBUTES.concat(),h.Polyline.fromElement=function(b,e){if(!b)return null;e||(e={});var a=h.parsePointsAttribute(b.getAttribute("points")),c=h.parseAttributes(b,
h.Polyline.ATTRIBUTE_NAMES);return new h.Polyline(a,h.util.object.extend(c,e))},h.Polyline.fromObject=function(b){return new h.Polyline(b.points,b,!0)})})("undefined"!==typeof b?b:this);(function(b){var h=b.fabric||(b.fabric={}),f=h.util.object.extend,e=h.util.array.min,a=h.util.array.max,c=h.util.toFixed;h.Polygon?h.warn("fabric.Polygon is already defined"):(h.Polygon=h.util.createClass(h.Object,{type:"polygon",points:null,minX:0,minY:0,initialize:function(a,d){d=d||{};this.points=a||[];this.callSuper("initialize",
d);this._calcDimensions();"top"in d||(this.top=this.minY);"left"in d||(this.left=this.minX)},_calcDimensions:function(){var c=this.points,d=e(c,"x"),b=e(c,"y"),f=a(c,"x"),c=a(c,"y");this.width=f-d||0;this.height=c-b||0;this.minX=d||0;this.minY=b||0},_applyPointOffset:function(){this.points.forEach(function(a){a.x-=this.minX+this.width/2;a.y-=this.minY+this.height/2},this)},toObject:function(a){return f(this.callSuper("toObject",a),{points:this.points.concat()})},toSVG:function(a){for(var d=[],b=this._createBaseSVGMarkup(),
e=0,f=this.points.length;e<f;e++)d.push(c(this.points[e].x,2),",",c(this.points[e].y,2)," ");b.push("<",this.type," ",'points="',d.join(""),'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform()," ",this.getSvgTransformMatrix(),'"/>\n');return a?a(b.join("")):b.join("")},_render:function(a){this.commonRender(a)&&(this._renderFill(a),this.stroke||this.strokeDashArray)&&(a.closePath(),this._renderStroke(a))},commonRender:function(a){var d,c=this.points.length;if(!c||isNaN(this.points[c-
1].y))return!1;a.beginPath();this._applyPointOffset&&(this.group&&"path-group"===this.group.type||this._applyPointOffset(),this._applyPointOffset=null);a.moveTo(this.points[0].x,this.points[0].y);for(var b=0;b<c;b++)d=this.points[b],a.lineTo(d.x,d.y);return!0},_renderDashedStroke:function(a){h.Polyline.prototype._renderDashedStroke.call(this,a);a.closePath()},complexity:function(){return this.points.length}}),h.Polygon.ATTRIBUTE_NAMES=h.SHARED_ATTRIBUTES.concat(),h.Polygon.fromElement=function(a,
d){if(!a)return null;d||(d={});var c=h.parsePointsAttribute(a.getAttribute("points")),b=h.parseAttributes(a,h.Polygon.ATTRIBUTE_NAMES);return new h.Polygon(c,f(b,d))},h.Polygon.fromObject=function(a){return new h.Polygon(a.points,a,!0)})})("undefined"!==typeof b?b:this);(function(b){var h=b.fabric||(b.fabric={}),f=h.util.array.min,e=h.util.array.max,a=h.util.object.extend,c=Object.prototype.toString,g=h.util.drawArc,d={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},k={m:"l",M:"L"};h.Path?h.warn("fabric.Path is already defined"):
(h.Path=h.util.createClass(h.Object,{type:"path",path:null,minX:0,minY:0,initialize:function(a,d){d=d||{};this.setOptions(d);if(!a)throw Error("`path` argument is required");var b="[object Array]"===c.call(a);if(this.path=b?a:a.match&&a.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi))b||(this.path=this._parsePath()),this._setPositionDimensions(),d.sourcePath&&this.setSourcePath(d.sourcePath)},_setPositionDimensions:function(){var a=this._parseDimensions();this.minX=a.left;this.minY=a.top;this.width=a.width;
this.height=a.height;a.left+="center"===this.originX?this.width/2:"right"===this.originX?this.width:0;a.top+="center"===this.originY?this.height/2:"bottom"===this.originY?this.height:0;this.top=this.top||a.top;this.left=this.left||a.left;this.pathOffset=this.pathOffset||{x:this.minX+this.width/2,y:this.minY+this.height/2}},_render:function(a){var d,c=null,b=0,e=0,f=0,h=0,k=0,l=0,r,m,n=-this.pathOffset.x,p=-this.pathOffset.y;this.group&&"path-group"===this.group.type&&(p=n=0);a.beginPath();for(var q=
0,t=this.path.length;q<t;++q){d=this.path[q];switch(d[0]){case "l":f+=d[1];h+=d[2];a.lineTo(f+n,h+p);break;case "L":f=d[1];h=d[2];a.lineTo(f+n,h+p);break;case "h":f+=d[1];a.lineTo(f+n,h+p);break;case "H":f=d[1];a.lineTo(f+n,h+p);break;case "v":h+=d[1];a.lineTo(f+n,h+p);break;case "V":h=d[1];a.lineTo(f+n,h+p);break;case "m":f+=d[1];h+=d[2];b=f;e=h;a.moveTo(f+n,h+p);break;case "M":f=d[1];h=d[2];b=f;e=h;a.moveTo(f+n,h+p);break;case "c":r=f+d[5];m=h+d[6];k=f+d[3];l=h+d[4];a.bezierCurveTo(f+d[1]+n,h+d[2]+
p,k+n,l+p,r+n,m+p);f=r;h=m;break;case "C":f=d[5];h=d[6];k=d[3];l=d[4];a.bezierCurveTo(d[1]+n,d[2]+p,k+n,l+p,f+n,h+p);break;case "s":r=f+d[3];m=h+d[4];null===c[0].match(/[CcSs]/)?(k=f,l=h):(k=2*f-k,l=2*h-l);a.bezierCurveTo(k+n,l+p,f+d[1]+n,h+d[2]+p,r+n,m+p);k=f+d[1];l=h+d[2];f=r;h=m;break;case "S":r=d[3];m=d[4];null===c[0].match(/[CcSs]/)?(k=f,l=h):(k=2*f-k,l=2*h-l);a.bezierCurveTo(k+n,l+p,d[1]+n,d[2]+p,r+n,m+p);f=r;h=m;k=d[1];l=d[2];break;case "q":r=f+d[3];m=h+d[4];k=f+d[1];l=h+d[2];a.quadraticCurveTo(k+
n,l+p,r+n,m+p);f=r;h=m;break;case "Q":r=d[3];m=d[4];a.quadraticCurveTo(d[1]+n,d[2]+p,r+n,m+p);f=r;h=m;k=d[1];l=d[2];break;case "t":r=f+d[1];m=h+d[2];null===c[0].match(/[QqTt]/)?(k=f,l=h):(k=2*f-k,l=2*h-l);a.quadraticCurveTo(k+n,l+p,r+n,m+p);f=r;h=m;break;case "T":r=d[1];m=d[2];null===c[0].match(/[QqTt]/)?(k=f,l=h):(k=2*f-k,l=2*h-l);a.quadraticCurveTo(k+n,l+p,r+n,m+p);f=r;h=m;break;case "a":g(a,f+n,h+p,[d[1],d[2],d[3],d[4],d[5],d[6]+f+n,d[7]+h+p]);f+=d[6];h+=d[7];break;case "A":g(a,f+n,h+p,[d[1],d[2],
d[3],d[4],d[5],d[6]+n,d[7]+p]);f=d[6];h=d[7];break;case "z":case "Z":f=b,h=e,a.closePath()}c=d}this._renderFill(a);this._renderStroke(a)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(d){d=a(this.callSuper("toObject",d),{path:this.path.map(function(a){return a.slice()}),pathOffset:this.pathOffset});this.sourcePath&&(d.sourcePath=this.sourcePath);this.transformMatrix&&(d.transformMatrix=this.transformMatrix);return d},
toDatalessObject:function(a){a=this.toObject(a);this.sourcePath&&(a.path=this.sourcePath);delete a.sourcePath;return a},toSVG:function(a){for(var d=[],c=this._createBaseSVGMarkup(),b="",e=0,g=this.path.length;e<g;e++)d.push(this.path[e].join(" "));d=d.join(" ");this.group&&"path-group"===this.group.type||(b=" translate("+-this.pathOffset.x+", "+-this.pathOffset.y+") ");c.push("<path ",'d="',d,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),b,this.getSvgTransformMatrix(),'" stroke-linecap="round" ',
"/>\n");return a?a(c.join("")):c.join("")},complexity:function(){return this.path.length},_parsePath:function(){for(var a=[],c=[],b,e,g=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/ig,f,h=0,l=this.path.length;h<l;h++){b=this.path[h];f=b.slice(1).trim();for(c.length=0;e=g.exec(f);)c.push(e[0]);b=[b.charAt(0)];f=0;for(var m=c.length;f<m;f++)e=parseFloat(c[f]),isNaN(e)||b.push(e);e=b[0];f=d[e.toLowerCase()];m=k[e]||e;if(b.length-1>f)for(var n=1,p=b.length;n<p;n+=f)a.push([e].concat(b.slice(n,n+
f))),e=m;else a.push(b)}return a},_parseDimensions:function(){for(var a=[],d=[],c,b=null,g=0,k=0,l=0,r=0,m=0,n=0,p,q,t,u=0,y=this.path.length;u<y;++u){c=this.path[u];switch(c[0]){case "l":l+=c[1];r+=c[2];t=[];break;case "L":l=c[1];r=c[2];t=[];break;case "h":l+=c[1];t=[];break;case "H":l=c[1];t=[];break;case "v":r+=c[1];t=[];break;case "V":r=c[1];t=[];break;case "m":l+=c[1];r+=c[2];g=l;k=r;t=[];break;case "M":l=c[1];r=c[2];g=l;k=r;t=[];break;case "c":p=l+c[5];q=r+c[6];m=l+c[3];n=r+c[4];t=h.util.getBoundsOfCurve(l,
r,l+c[1],r+c[2],m,n,p,q);l=p;r=q;break;case "C":l=c[5];r=c[6];m=c[3];n=c[4];t=h.util.getBoundsOfCurve(l,r,c[1],c[2],m,n,l,r);break;case "s":p=l+c[3];q=r+c[4];null===b[0].match(/[CcSs]/)?(m=l,n=r):(m=2*l-m,n=2*r-n);t=h.util.getBoundsOfCurve(l,r,m,n,l+c[1],r+c[2],p,q);m=l+c[1];n=r+c[2];l=p;r=q;break;case "S":p=c[3];q=c[4];null===b[0].match(/[CcSs]/)?(m=l,n=r):(m=2*l-m,n=2*r-n);t=h.util.getBoundsOfCurve(l,r,m,n,c[1],c[2],p,q);l=p;r=q;m=c[1];n=c[2];break;case "q":p=l+c[3];q=r+c[4];m=l+c[1];n=r+c[2];t=
h.util.getBoundsOfCurve(l,r,m,n,m,n,p,q);l=p;r=q;break;case "Q":m=c[1];n=c[2];t=h.util.getBoundsOfCurve(l,r,m,n,m,n,c[3],c[4]);l=c[3];r=c[4];break;case "t":p=l+c[1];q=r+c[2];null===b[0].match(/[QqTt]/)?(m=l,n=r):(m=2*l-m,n=2*r-n);t=h.util.getBoundsOfCurve(l,r,m,n,m,n,p,q);l=p;r=q;break;case "T":p=c[1];q=c[2];null===b[0].match(/[QqTt]/)?(m=l,n=r):(m=2*l-m,n=2*r-n);t=h.util.getBoundsOfCurve(l,r,m,n,m,n,p,q);l=p;r=q;break;case "a":t=h.util.getBoundsOfArc(l,r,c[1],c[2],c[3],c[4],c[5],c[6]+l,c[7]+r);l+=
c[6];r+=c[7];break;case "A":t=h.util.getBoundsOfArc(l,r,c[1],c[2],c[3],c[4],c[5],c[6],c[7]);l=c[6];r=c[7];break;case "z":case "Z":l=g,r=k}b=c;t.forEach(function(c){a.push(c.x);d.push(c.y)});a.push(l);d.push(r)}c=f(a);b=f(d);g=e(a);k=e(d);return{left:c,top:b,width:g-c,height:k-b}}}),h.Path.fromObject=function(a,d){"string"===typeof a.path?h.loadSVGFromURL(a.path,function(c){c=c[0];var b=a.path;delete a.path;h.util.object.extend(c,a);c.setSourcePath(b);d(c)}):d(new h.Path(a.path,a))},h.Path.ATTRIBUTE_NAMES=
h.SHARED_ATTRIBUTES.concat(["d"]),h.Path.fromElement=function(d,c,b){d=h.parseAttributes(d,h.Path.ATTRIBUTE_NAMES);c&&c(new h.Path(d.d,a(d,b)))},h.Path.async=!0)})("undefined"!==typeof b?b:this);(function(b){var h=b.fabric||(b.fabric={}),f=h.util.object.extend,e=h.util.array.invoke,a=h.Object.prototype.toObject;h.PathGroup?h.warn("fabric.PathGroup is already defined"):(h.PathGroup=h.util.createClass(h.Path,{type:"path-group",fill:"",initialize:function(a,b){b=b||{};this.paths=a||[];for(var d=this.paths.length;d--;)this.paths[d].group=
this;b.toBeParsed&&(this.parseDimensionsFromPaths(b),delete b.toBeParsed);this.setOptions(b);this.setCoords();b.sourcePath&&this.setSourcePath(b.sourcePath)},parseDimensionsFromPaths:function(a){for(var b,d,e=[],f=[],k,l=this.transformMatrix,m=this.paths.length;m--;)for(b=this.paths[m],d=b.height+b.strokeWidth,k=b.width+b.strokeWidth,b=[{x:b.left,y:b.top},{x:b.left+k,y:b.top},{x:b.left,y:b.top+d},{x:b.left+k,y:b.top+d}],k=0;k<b.length;k++)d=b[k],l&&(d=h.util.transformPoint(d,l,!1)),e.push(d.x),f.push(d.y);
a.width=Math.max.apply(null,e);a.height=Math.max.apply(null,f)},render:function(a){if(this.visible){a.save();this.transformMatrix&&a.transform.apply(a,this.transformMatrix);this.transform(a);this._setShadow(a);this.clipTo&&h.util.clipContext(this,a);a.translate(-this.width/2,-this.height/2);for(var b=0,d=this.paths.length;b<d;++b)this.paths[b].render(a,!0);this.clipTo&&a.restore();this._removeShadow(a);a.restore()}},_set:function(a,b){if("fill"===a&&b&&this.isSameColor())for(var d=this.paths.length;d--;)this.paths[d]._set(a,
b);return this.callSuper("_set",a,b)},toObject:function(c){c=f(a.call(this,c),{paths:e(this.getObjects(),"toObject",c)});this.sourcePath&&(c.sourcePath=this.sourcePath);return c},toDatalessObject:function(a){a=this.toObject(a);this.sourcePath&&(a.paths=this.sourcePath);return a},toSVG:function(a){for(var b=this.getObjects(),d=this.getPointByOrigin("left","top"),d="translate("+d.x+" "+d.y+")",d=["<g ",'style="',this.getSvgStyles(),'" ','transform="',this.getSvgTransformMatrix(),d,this.getSvgTransform(),
'" ',">\n"],e=0,f=b.length;e<f;e++)d.push(b[e].toSVG(a));d.push("</g>\n");return a?a(d.join("")):d.join("")},toString:function(){return"#<fabric.PathGroup ("+this.complexity()+"): { top: "+this.top+", left: "+this.left+" }>"},isSameColor:function(){var a=(this.getObjects()[0].get("fill")||"").toLowerCase();return this.getObjects().every(function(b){return(b.get("fill")||"").toLowerCase()===a})},complexity:function(){return this.paths.reduce(function(a,b){return a+(b&&b.complexity?b.complexity():0)},
0)},getObjects:function(){return this.paths}}),h.PathGroup.fromObject=function(a,b){"string"===typeof a.paths?h.loadSVGFromURL(a.paths,function(d){var e=a.paths;delete a.paths;d=h.util.groupSVGElements(d,a,e);b(d)}):h.util.enlivenObjects(a.paths,function(d){delete a.paths;b(new h.PathGroup(d,a))})},h.PathGroup.async=!0)})("undefined"!==typeof b?b:this);(function(b){var h=b.fabric||(b.fabric={}),f=h.util.object.extend,e=h.util.array.min,a=h.util.array.max,c=h.util.array.invoke;if(!h.Group){var g={lockMovementX:!0,
lockMovementY:!0,lockRotation:!0,lockScalingX:!0,lockScalingY:!0,lockUniScaling:!0};h.Group=h.util.createClass(h.Object,h.Collection,{type:"group",initialize:function(a,c){c=c||{};this._objects=a||[];for(var b=this._objects.length;b--;)this._objects[b].group=this;this.originalState={};this.callSuper("initialize");c.originX&&(this.originX=c.originX);c.originY&&(this.originY=c.originY);this._calcBounds();this._updateObjectsCoords();this.callSuper("initialize",c);this.setCoords();this.saveCoords()},
_updateObjectsCoords:function(){this.forEachObject(this._updateObjectCoords,this)},_updateObjectCoords:function(a){var c=a.getLeft(),b=a.getTop(),e=this.getCenterPoint();a.set({originalLeft:c,originalTop:b,left:c-e.x,top:b-e.y});a.setCoords();a.__origHasControls=a.hasControls;a.hasControls=!1},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(a){this._restoreObjectsState();a&&(this._objects.push(a),a.group=this);this.forEachObject(this._setObjectActive,this);
this._calcBounds();this._updateObjectsCoords();return this},_setObjectActive:function(a){a.set("active",!0);a.group=this},removeWithUpdate:function(a){this._moveFlippedObject(a);this._restoreObjectsState();this.forEachObject(this._setObjectActive,this);this.remove(a);this._calcBounds();this._updateObjectsCoords();return this},_onObjectAdded:function(a){a.group=this},_onObjectRemoved:function(a){delete a.group;a.set("active",!1)},delegatedProperties:{fill:!0,opacity:!0,fontFamily:!0,fontWeight:!0,
fontSize:!0,fontStyle:!0,lineHeight:!0,textDecoration:!0,textAlign:!0,backgroundColor:!0},_set:function(a,c){if(a in this.delegatedProperties)for(var b=this._objects.length;b--;)this._objects[b].set(a,c);this.callSuper("_set",a,c)},toObject:function(a){return f(this.callSuper("toObject",a),{objects:c(this._objects,"toObject",a)})},render:function(a){if(this.visible){a.save();this.clipTo&&h.util.clipContext(this,a);this.transform(a);for(var c=0,b=this._objects.length;c<b;c++)this._renderObject(this._objects[c],
a);this.clipTo&&a.restore();a.restore()}},_renderControls:function(a,c){this.callSuper("_renderControls",a,c);for(var b=0,e=this._objects.length;b<e;b++)this._objects[b]._renderControls(a)},_renderObject:function(a,c){var b=a.hasRotatingPoint;a.visible&&(a.hasRotatingPoint=!1,a.render(c),a.hasRotatingPoint=b)},_restoreObjectsState:function(){this._objects.forEach(this._restoreObjectState,this);return this},realizeTransform:function(a){this._moveFlippedObject(a);this._setObjectPosition(a);return a},
_moveFlippedObject:function(a){var c=a.get("originX"),b=a.get("originY"),e=a.getCenterPoint();a.set({originX:"center",originY:"center",left:e.x,top:e.y});this._toggleFlipping(a);e=a.getPointByOrigin(c,b);a.set({originX:c,originY:b,left:e.x,top:e.y});return this},_toggleFlipping:function(a){this.flipX&&(a.toggle("flipX"),a.set("left",-a.get("left")),a.setAngle(-a.getAngle()));this.flipY&&(a.toggle("flipY"),a.set("top",-a.get("top")),a.setAngle(-a.getAngle()))},_restoreObjectState:function(a){this._setObjectPosition(a);
a.setCoords();a.hasControls=a.__origHasControls;delete a.__origHasControls;a.set("active",!1);a.setCoords();delete a.group;return this},_setObjectPosition:function(a){var c=this.getCenterPoint(),b=this._getRotatedLeftTop(a);a.set({angle:a.getAngle()+this.getAngle(),left:c.x+b.left,top:c.y+b.top,scaleX:a.get("scaleX")*this.get("scaleX"),scaleY:a.get("scaleY")*this.get("scaleY")})},_getRotatedLeftTop:function(a){var c=this.getAngle()*(Math.PI/180);return{left:-Math.sin(c)*a.getTop()*this.get("scaleY")+
Math.cos(c)*a.getLeft()*this.get("scaleX"),top:Math.cos(c)*a.getTop()*this.get("scaleY")+Math.sin(c)*a.getLeft()*this.get("scaleX")}},destroy:function(){this._objects.forEach(this._moveFlippedObject,this);return this._restoreObjectsState()},saveCoords:function(){this._originalLeft=this.get("left");this._originalTop=this.get("top");return this},hasMoved:function(){return this._originalLeft!==this.get("left")||this._originalTop!==this.get("top")},setObjectsCoords:function(){this.forEachObject(function(a){a.setCoords()});
return this},_calcBounds:function(a){for(var c=[],b=[],e,g,f=["tr","br","bl","tl"],h=0,k=this._objects.length;h<k;++h){e=this._objects[h];e.setCoords();for(var l=0;l<f.length;l++)g=f[l],c.push(e.oCoords[g].x),b.push(e.oCoords[g].y)}this.set(this._getBounds(c,b,a))},_getBounds:function(d,c,b){var g=h.util.invertTransform(this.getViewportTransform()),f=h.util.transformPoint(new h.Point(e(d),e(c)),g);d=h.util.transformPoint(new h.Point(a(d),a(c)),g);d={width:d.x-f.x||0,height:d.y-f.y||0};b||(d.left=
f.x||0,d.top=f.y||0,"center"===this.originX&&(d.left+=d.width/2),"right"===this.originX&&(d.left+=d.width),"center"===this.originY&&(d.top+=d.height/2),"bottom"===this.originY&&(d.top+=d.height));return d},toSVG:function(a){for(var c=["<g ",'transform="',this.getSvgTransform(),'">\n'],b=0,e=this._objects.length;b<e;b++)c.push(this._objects[b].toSVG(a));c.push("</g>\n");return a?a(c.join("")):c.join("")},get:function(a){if(a in g){if(this[a])return this[a];for(var c=0,b=this._objects.length;c<b;c++)if(this._objects[c][a])return!0;
return!1}return a in this.delegatedProperties?this._objects[0]&&this._objects[0].get(a):this[a]}});h.Group.fromObject=function(a,c){h.util.enlivenObjects(a.objects,function(b){delete a.objects;c&&c(new h.Group(b,a))})};h.Group.async=!0}})("undefined"!==typeof b?b:this);(function(b){var h=k.util.object.extend;b.fabric||(b.fabric={});b.fabric.Image?k.warn("fabric.Image is already defined."):(k.Image=k.util.createClass(k.Object,{type:"image",crossOrigin:"",alignX:"none",alignY:"none",meetOrSlice:"meet",
_lastScaleX:1,_lastScaleY:1,initialize:function(b,e){e||(e={});this.filters=[];this.resizeFilters=[];this.callSuper("initialize",e);this._initElement(b,e);this._initConfig(e);e.filters&&(this.filters=e.filters,this.applyFilters())},getElement:function(){return this._element},setElement:function(b,e,a){this._originalElement=this._element=b;this._initConfig(a);0!==this.filters.length?this.applyFilters(e):e&&e();return this},setCrossOrigin:function(b){this.crossOrigin=b;this._element.crossOrigin=b;return this},
getOriginalSize:function(){var b=this.getElement();return{width:b.width,height:b.height}},_stroke:function(b){b.save();this._setStrokeStyles(b);b.beginPath();b.strokeRect(-this.width/2,-this.height/2,this.width,this.height);b.closePath();b.restore()},_renderDashedStroke:function(b){var e=-this.width/2,a=-this.height/2,c=this.width,g=this.height;b.save();this._setStrokeStyles(b);b.beginPath();k.util.drawDashedLine(b,e,a,e+c,a,this.strokeDashArray);k.util.drawDashedLine(b,e+c,a,e+c,a+g,this.strokeDashArray);
k.util.drawDashedLine(b,e+c,a+g,e,a+g,this.strokeDashArray);k.util.drawDashedLine(b,e,a+g,e,a,this.strokeDashArray);b.closePath();b.restore()},toObject:function(b){return h(this.callSuper("toObject",b),{src:this._originalElement.src||this._originalElement._src,filters:this.filters.map(function(b){return b&&b.toObject()}),crossOrigin:this.crossOrigin,alignX:this.alignX,alignY:this.alignY,meetOrSlice:this.meetOrSlice})},toSVG:function(b){var e=[],a=-this.width/2,c=-this.height/2,g="none";this.group&&
"path-group"===this.group.type&&(a=this.left,c=this.top);"none"!==this.alignX&&"none"!==this.alignY&&(g="x"+this.alignX+"Y"+this.alignY+" "+this.meetOrSlice);e.push('<g transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'">\n','<image xlink:href="',this.getSvgSrc(),'" x="',a,'" y="',c,'" style="',this.getSvgStyles(),'" width="',this.width,'" height="',this.height,'" preserveAspectRatio="',g,'"',"></image>\n");if(this.stroke||this.strokeDashArray)g=this.fill,this.fill=null,e.push("<rect ",
'x="',a,'" y="',c,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),'"/>\n'),this.fill=g;e.push("</g>\n");return b?b(e.join("")):e.join("")},getSrc:function(){if(this.getElement())return this.getElement().src||this.getElement()._src},setSrc:function(b,e,a){k.util.loadImage(b,function(c){return this.setElement(c,e,a)},this,a&&a.crossOrigin)},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},clone:function(b,e){this.constructor.fromObject(this.toObject(e),
b)},applyFilters:function(b,e,a,c){e=e||this.filters;if(a=a||this._originalElement){var g=a,d=k.util.createCanvasElement(),h=k.util.createImage(),l=this;d.width=g.width;d.height=g.height;d.getContext("2d").drawImage(g,0,0,g.width,g.height);if(0===e.length)return this._element=a,b&&b(),d;e.forEach(function(a){a&&a.applyTo(d,a.scaleX||l.scaleX,a.scaleY||l.scaleY);!c&&a&&"Resize"===a.type&&(l.width*=a.scaleX,l.height*=a.scaleY)});h.width=d.width;h.height=d.height;k.isLikelyNode?(h.src=d.toBuffer(void 0,
k.Image.pngCompression),l._element=h,!c&&(l._filteredEl=h),b&&b()):(h.onload=function(){l._element=h;!c&&(l._filteredEl=h);b&&b();h.onload=d=g=null},h.src=d.toDataURL("image/png"));return d}},_render:function(b,e){var a,c,g=this._findMargins(),d;a=e?this.left:-this.width/2;c=e?this.top:-this.height/2;"slice"===this.meetOrSlice&&(b.beginPath(),b.rect(a,c,this.width,this.height),b.clip());!1===this.isMoving&&this.resizeFilters.length&&this._needsResize()?(this._lastScaleX=this.scaleX,this._lastScaleY=
this.scaleY,d=this.applyFilters(null,this.resizeFilters,this._filteredEl||this._originalElement,!0)):d=this._element;d&&b.drawImage(d,a+g.marginX,c+g.marginY,g.width,g.height);this._renderStroke(b)},_needsResize:function(){return this.scaleX!==this._lastScaleX||this.scaleY!==this._lastScaleY},_findMargins:function(){var b=this.width,e=this.height,a=0,c=0;if("none"!==this.alignX||"none"!==this.alignY)b=[this.width/this._element.width,this.height/this._element.height],e="meet"===this.meetOrSlice?Math.min.apply(null,
b):Math.max.apply(null,b),b=this._element.width*e,e*=this._element.height,"Mid"===this.alignX&&(a=(this.width-b)/2),"Max"===this.alignX&&(a=this.width-b),"Mid"===this.alignY&&(c=(this.height-e)/2),"Max"===this.alignY&&(c=this.height-e);return{width:b,height:e,marginX:a,marginY:c}},_resetWidthHeight:function(){var b=this.getElement();this.set("width",b.width);this.set("height",b.height)},_initElement:function(b){this.setElement(k.util.getById(b));k.util.addClass(this.getElement(),k.Image.CSS_CANVAS)},
_initConfig:function(b){b||(b={});this.setOptions(b);this._setWidthHeight(b);this._element&&this.crossOrigin&&(this._element.crossOrigin=this.crossOrigin)},_initFilters:function(b,e){b.filters&&b.filters.length?k.util.enlivenObjects(b.filters,function(a){e&&e(a)},"fabric.Image.filters"):e&&e()},_setWidthHeight:function(b){this.width="width"in b?b.width:this.getElement()?this.getElement().width||0:0;this.height="height"in b?b.height:this.getElement()?this.getElement().height||0:0},complexity:function(){return 1}}),
k.Image.CSS_CANVAS="canvas-img",k.Image.prototype.getSvgSrc=k.Image.prototype.getSrc,k.Image.fromObject=function(b,e){k.util.loadImage(b.src,function(a){k.Image.prototype._initFilters.call(b,b,function(c){b.filters=c||[];c=new k.Image(a,b);e&&e(c)})},null,b.crossOrigin)},k.Image.fromURL=function(b,e,a){k.util.loadImage(b,function(b){e&&e(new k.Image(b,a))},null,a&&a.crossOrigin)},k.Image.ATTRIBUTE_NAMES=k.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href".split(" ")),k.Image.fromElement=
function(b,e,a){b=k.parseAttributes(b,k.Image.ATTRIBUTE_NAMES);var c="xMidYMid",g="meet",d;b.preserveAspectRatio&&(d=b.preserveAspectRatio.split(" "));d&&d.length&&(g=d.pop(),"meet"!==g&&"slice"!==g?(c=g,g="meet"):d.length&&(c=d.pop()));d="none"!==c?c.slice(1,4):"none";c="none"!==c?c.slice(5,8):"none";b.alignX=d;b.alignY=c;b.meetOrSlice=g;k.Image.fromURL(b["xlink:href"],e,h(a?k.util.object.clone(a):{},b))},k.Image.async=!0,k.Image.pngCompression=1)})("undefined"!==typeof b?b:this);(function(b){var h=
b.fabric||(b.fabric={}),f=h.util.object.extend,e=h.util.object.clone,a=h.util.toFixed,c=h.StaticCanvas.supports("setLineDash");h.Text?h.warn("fabric.Text is already defined"):(b=h.Object.prototype.stateProperties.concat(),b.push("fontFamily","fontWeight","fontSize","text","textDecoration","textAlign","fontStyle","lineHeight","textBackgroundColor"),h.Text=h.util.createClass(h.Object,{_dimensionAffectingProps:{fontSize:!0,fontWeight:!0,fontFamily:!0,fontStyle:!0,lineHeight:!0,stroke:!0,strokeWidth:!0,
text:!0,textAlign:!0},_reNewline:/\r?\n/,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",textDecoration:"",textAlign:"left",fontStyle:"",lineHeight:1.16,textBackgroundColor:"",stateProperties:b,stroke:null,shadow:null,_fontSizeFraction:.25,_fontSizeMult:1.13,initialize:function(a,d){d=d||{};this.text=a;this.__skipDimension=!0;this.setOptions(d);this.__skipDimension=!1;this._initDimensions()},_initDimensions:function(a){if(!this.__skipDimension){a||(a=h.util.createCanvasElement().getContext("2d"),
this._setTextStyles(a));this._textLines=this.text.split(this._reNewline);this._clearCache();var d=this.textAlign;this.textAlign="left";this.width=this._getTextWidth(a);this.textAlign=d;this.height=this._getTextHeight(a)}},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_render:function(a){this.clipTo&&h.util.clipContext(this,a);this._renderTextBackground(a);this._renderText(a);this._renderTextDecoration(a);this.clipTo&&
a.restore()},_renderText:function(a){a.save();this._translateForTextAlign(a);this._setOpacity(a);this._setShadow(a);this._setupCompositeOperation(a);this._renderTextFill(a);this._renderTextStroke(a);this._restoreCompositeOperation(a);this._removeShadow(a);a.restore()},_translateForTextAlign:function(a){"left"!==this.textAlign&&"justify"!==this.textAlign&&a.translate("center"===this.textAlign?this.width/2:this.width,0)},_setTextStyles:function(a){a.textBaseline="alphabetic";this.skipTextAlign||(a.textAlign=
this.textAlign);a.font=this._getFontDeclaration()},_getTextHeight:function(){return this._textLines.length*this._getHeightOfLine()},_getTextWidth:function(a){for(var d=this._getLineWidth(a,0),b=1,c=this._textLines.length;b<c;b++){var e=this._getLineWidth(a,b);e>d&&(d=e)}return d},_renderChars:function(a,d,b,c,e){d[a](b,c,e)},_renderTextLine:function(a,d,b,c,e,f){e-=this.fontSize*this._fontSizeFraction;if("justify"!==this.textAlign)this._renderChars(a,d,b,c,e,f);else{var h=this._getLineWidth(d,f),
k=this.width;if(k>=h){h=b.split(/\s+/);b=this._getWidthOfWords(d,b,f);for(var k=(k-b)/(h.length-1),l=b=0,m=h.length;l<m;l++)this._renderChars(a,d,h[l],c+b,e,f),b+=d.measureText(h[l]).width+k}else this._renderChars(a,d,b,c,e,f)}},_getWidthOfWords:function(a,d){return a.measureText(d.replace(/\s+/g,"")).width},_getLeftOffset:function(){return-this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextFill:function(a){if(this.fill||this._skipFillStrokeCheck){for(var d=0,b=0,c=this._textLines.length;b<
c;b++){var e=this._getHeightOfLine(a,b),f=e/this.lineHeight;this._renderTextLine("fillText",a,this._textLines[b],this._getLeftOffset(),this._getTopOffset()+d+f,b);d+=e}this.shadow&&!this.shadow.affectStroke&&this._removeShadow(a)}},_renderTextStroke:function(a){if(this.stroke&&0!==this.strokeWidth||this._skipFillStrokeCheck){var d=0;a.save();this.strokeDashArray&&(1&this.strokeDashArray.length&&this.strokeDashArray.push.apply(this.strokeDashArray,this.strokeDashArray),c&&a.setLineDash(this.strokeDashArray));
a.beginPath();for(var b=0,e=this._textLines.length;b<e;b++){var f=this._getHeightOfLine(a,b),h=f/this.lineHeight;this._renderTextLine("strokeText",a,this._textLines[b],this._getLeftOffset(),this._getTopOffset()+d+h,b);d+=f}a.closePath();a.restore()}},_getHeightOfLine:function(){return this.fontSize*this._fontSizeMult*this.lineHeight},_renderTextBackground:function(a){this._renderTextBoxBackground(a);this._renderTextLinesBackground(a)},_renderTextBoxBackground:function(a){this.backgroundColor&&(a.save(),
a.fillStyle=this.backgroundColor,a.fillRect(this._getLeftOffset(),this._getTopOffset(),this.width,this.height),a.restore())},_renderTextLinesBackground:function(a){var d=0,b=this._getHeightOfLine();if(this.textBackgroundColor){a.save();a.fillStyle=this.textBackgroundColor;for(var c=0,e=this._textLines.length;c<e;c++){if(""!==this._textLines[c]){var f=this._getLineWidth(a,c),h=this._getLineLeftOffset(f);a.fillRect(this._getLeftOffset()+h,this._getTopOffset()+d,f,this.fontSize*this._fontSizeMult)}d+=
b}a.restore()}},_getLineLeftOffset:function(a){return"center"===this.textAlign?(this.width-a)/2:"right"===this.textAlign?this.width-a:0},_clearCache:function(){this.__lineWidths=[];this.__lineHeights=[];this.__lineOffsets=[]},_shouldClearCache:function(){var a=!1,d;for(d in this._dimensionAffectingProps)this["__"+d]!==this[d]&&(this["__"+d]=this[d],a=!0);return a},_getLineWidth:function(a,d){if(this.__lineWidths[d])return this.__lineWidths[d];this.__lineWidths[d]=a.measureText(this._textLines[d]).width;
return this.__lineWidths[d]},_renderTextDecoration:function(a){if(this.textDecoration){var d=this.height/2,b=[];-1<this.textDecoration.indexOf("underline")&&b.push(.85);-1<this.textDecoration.indexOf("line-through")&&b.push(.43);-1<this.textDecoration.indexOf("overline")&&b.push(-.12);if(0<b.length){var c,e=0,f,h,k;c=0;for(f=this._textLines.length;c<f;c++){var l=this._getLineWidth(a,c),m=this._getLineLeftOffset(l),n=this._getHeightOfLine(a,c);h=0;for(k=b.length;h<k;h++)a.fillRect(this._getLeftOffset()+
m,e+(this._fontSizeMult-1+b[h])*this.fontSize-d,l,this.fontSize/15);e+=n}}}},_getFontDeclaration:function(){return[h.isLikelyNode?this.fontWeight:this.fontStyle,h.isLikelyNode?this.fontStyle:this.fontWeight,this.fontSize+"px",h.isLikelyNode?'"'+this.fontFamily+'"':this.fontFamily].join(" ")},render:function(a,d){this.visible&&(a.save(),this._setTextStyles(a),this._shouldClearCache()&&this._initDimensions(a),d||this.transform(a),this._setStrokeStyles(a),this._setFillStyles(a),this.transformMatrix&&
a.transform.apply(a,this.transformMatrix),this.group&&"path-group"===this.group.type&&a.translate(this.left,this.top),this._render(a),a.restore())},toObject:function(a){a=f(this.callSuper("toObject",a),{text:this.text,fontSize:this.fontSize,fontWeight:this.fontWeight,fontFamily:this.fontFamily,fontStyle:this.fontStyle,lineHeight:this.lineHeight,textDecoration:this.textDecoration,textAlign:this.textAlign,textBackgroundColor:this.textBackgroundColor});this.includeDefaultValues||this._removeDefaultValues(a);
return a},toSVG:function(a){var d=this._createBaseSVGMarkup(),b=this._getSVGLeftTopOffsets(this.ctx),b=this._getSVGTextAndBg(b.textTop,b.textLeft);this._wrapSVGTextAndBg(d,b);return a?a(d.join("")):d.join("")},_getSVGLeftTopOffsets:function(a){a=this._getHeightOfLine(a,0);return{textLeft:-this.width/2+(this.group&&"path-group"===this.group.type?this.left:0),textTop:0+(this.group&&"path-group"===this.group.type?-this.top:0),lineTop:a}},_wrapSVGTextAndBg:function(a,d){a.push('\t<g transform="',this.getSvgTransform(),
this.getSvgTransformMatrix(),'">\n',d.textBgRects.join(""),"\t\t<text ",this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",this.textDecoration?'text-decoration="'+this.textDecoration+'" ':"",'style="',this.getSvgStyles(),'" >',d.textSpans.join(""),"</text>\n","\t</g>\n")},_getSVGTextAndBg:function(a,d){var b=[],c=[],e=
0;this._setSVGBg(c);for(var f=0,h=this._textLines.length;f<h;f++)this.textBackgroundColor&&this._setSVGTextLineBg(c,f,d,a,e),this._setSVGTextLineText(f,b,e,d,a,c),e+=this._getHeightOfLine(this.ctx,f);return{textSpans:b,textBgRects:c}},_setSVGTextLineText:function(b,d,c,e,f){c=this.fontSize*(this._fontSizeMult-this._fontSizeFraction)-f+c-this.height/2;d.push('<tspan x="',a(e+this._getLineLeftOffset(this.__lineWidths[b]),4),'" ','y="',a(c,4),'" ',this._getFillAttributes(this.fill),">",h.util.string.escapeXml(this._textLines[b]),
"</tspan>")},_setSVGTextLineBg:function(b,d,c,e,f){b.push("\t\t<rect ",this._getFillAttributes(this.textBackgroundColor),' x="',a(c+this._getLineLeftOffset(this.__lineWidths[d]),4),'" y="',a(f-this.height/2,4),'" width="',a(this.__lineWidths[d],4),'" height="',a(this._getHeightOfLine(this.ctx,d)/this.lineHeight,4),'"></rect>\n')},_setSVGBg:function(b){this.backgroundColor&&b.push("\t\t<rect ",this._getFillAttributes(this.backgroundColor),' x="',a(-this.width/2,4),'" y="',a(-this.height/2,4),'" width="',
a(this.width,4),'" height="',a(this.height,4),'"></rect>\n')},_getFillAttributes:function(a){var d=a&&"string"===typeof a?new h.Color(a):"";return d&&d.getSource()&&1!==d.getAlpha()?'opacity="'+d.getAlpha()+'" fill="'+d.setAlpha(1).toRgb()+'"':'fill="'+a+'"'},_set:function(a,d){this.callSuper("_set",a,d);a in this._dimensionAffectingProps&&(this._initDimensions(),this.setCoords())},complexity:function(){return 1}}),h.Text.ATTRIBUTE_NAMES=h.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size text-decoration text-anchor".split(" ")),
h.Text.DEFAULT_SVG_FONT_SIZE=16,h.Text.fromElement=function(a,d){if(!a)return null;var b=h.parseAttributes(a,h.Text.ATTRIBUTE_NAMES);d=h.util.object.extend(d?h.util.object.clone(d):{},b);d.top=d.top||0;d.left=d.left||0;"dx"in b&&(d.left+=b.dx);"dy"in b&&(d.top+=b.dy);"fontSize"in d||(d.fontSize=h.Text.DEFAULT_SVG_FONT_SIZE);d.originX||(d.originX="left");var b=a.textContent.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," "),b=new h.Text(b,d),c=0;"left"===b.originX&&(c=b.getWidth()/2);"right"===b.originX&&
(c=-b.getWidth()/2);b.set({left:b.getLeft()+c,top:b.getTop()-b.getHeight()/2+b.fontSize*(.18+b._fontSizeFraction)});return b},h.Text.fromObject=function(a){return new h.Text(a.text,e(a))},h.util.createAccessors(h.Text))})("undefined"!==typeof b?b:this);delete window.fabric;return b}().fabric;b.fabric=l}}});(function(){var b=Q(n.com.fabricjs).fabric,l=u([13,27,32]),m=l[0],k=l[1],p=l[2];window.onkeydown=function(a){return a.keyCode!=p};var h=D("Attribute",[L],{get __init__(){return q(this,function(a,
b){a.game=b;a.game.attributes.append(a);a.install();a.reset()})},get reset(){return q(this,function(a){a.commit()})},get predict(){return q(this,function(a){})},get interact(){return q(this,function(a){})},get commit(){return q(this,function(a){})}}),f=D("Sprite",[h],{get __init__(){return q(this,function(a,b,c,e){a.width=c;a.height=e;h.__init__(a,b)})},get install(){return q(this,function(a){a.image=new b.Rect(C({width:a.game.scaleX(a.width),height:a.game.scaleY(a.height),originX:"center",originY:"center",
fill:"white"}))})},get reset(){return q(this,function(a,b,c,e,f){if("undefined"==typeof b||null!=b&&b.__class__==t)b=0;if("undefined"==typeof c||null!=c&&c.__class__==t)c=0;if("undefined"==typeof e||null!=e&&e.__class__==t)e=0;if("undefined"==typeof f||null!=f&&f.__class__==t)f=0;if(arguments.length){var g=arguments.length-1;if(arguments[g]&&arguments[g].__class__==t){var g=arguments[g--],k;for(k in g)switch(k){case "self":a=g[k];break;case "vX":b=g[k];break;case "vY":c=g[k];break;case "x":e=g[k];
break;case "y":f=g[k]}}}a.vX=b;a.vY=c;a.x=e;a.y=f;h.reset(a)})},get predict(){return q(this,function(a){a.x+=a.vX*a.game.deltaT;a.y+=a.vY*a.game.deltaT})},get commit(){return q(this,function(a){a.image.left=a.game.orthoX(a.x);a.image.top=a.game.orthoY(a.y)})},get draw(){return q(this,function(a){a.game.canvas.add(a.image)})}}),e=D("Paddle",[f],{get __init__(){return q(this,function(a,b,c){a.index=c;f.__init__(a,b,a.width,a.height)})},get reset(){return q(this,function(a){f.reset(a,t({x:a.index?Math.floor(500)-
a.margin:Math.floor(-500)+a.margin,y:0}))})},get predict(){return q(this,function(a){a.vY=0;a.index?a.game.keyCode==M("K")?a.vY=a.speed:a.game.keyCode==M("M")&&(a.vY=-a.speed):a.game.keyCode==M("A")?a.vY=a.speed:a.game.keyCode==M("Z")&&(a.vY=-a.speed);f.predict(a)})},get interact(){return q(this,function(a){a.y=Math.max(Math.floor(a.height/2)-Math.floor(325),Math.min(a.y,Math.floor(325)-Math.floor(a.height/2)));a.y-Math.floor(a.height/2)<a.game.ball.y&&a.game.ball.y<a.y+Math.floor(a.height/2)&&(0==
a.index&&a.game.ball.x<a.x||1==a.index&&a.game.ball.x>a.x)&&(a.game.ball.x=a.x,a.game.ball.vX=-a.game.ball.vX,a.game.ball.speedUp(a))})}});e.margin=30;e.width=10;e.height=100;e.speed=400;var a=D("Ball",[f],{get __init__(){return q(this,function(a,b){f.__init__(a,b,a.side,a.side)})},get reset(){return q(this,function(a){var b=a.game.serviceIndex*Math.PI+(.5<Math.random()?1:-1)*Math.random()*Math.atan(.65);f.reset(a,t({vX:a.speed*Math.cos(b),vY:a.speed*Math.sin(b)}))})},get predict(){return q(this,
function(a){f.predict(a);a.x<Math.floor(-500)?a.game.scored(1):a.x>Math.floor(500)&&a.game.scored(0);a.y>Math.floor(325)?(a.y=Math.floor(325),a.vY=-a.vY):a.y<Math.floor(-325)&&(a.y=Math.floor(-325),a.vY=-a.vY)})},get speedUp(){return q(this,function(a,b){var c=1+.15*Math.pow(1-Math.abs(a.y-b.y)/Math.floor(b.height/2),2);Math.abs(a.vX)<3*a.speed&&(a.vX*=c,a.vY*=c)})}});a.side=8;a.speed=300;var c=D("Scoreboard",[h],{get install(){return q(this,function(a){for(var c=[],e=u([u(["AZ keys:",-.4375]),u(["KM keys:",
.0625])]),f=0;f<e.length;f++){var g=e[f],h=g[1];c.append(new b.Text("Player {}".format(g[0]),C({fill:"white",fontFamily:"arial",fontSize:"{}".format(a.game.canvas.width/30),left:a.game.orthoX(1E3*h),top:a.game.orthoY(Math.floor(325)+a.nameShift)})))}a.playerLabels=c;a.hintLabel=new b.Text("[spacebar] starts game, [enter] resets score",C({fill:"white",fontFamily:"arial",fontSize:"{}".format(a.game.canvas.width/70),left:a.game.orthoX(-437.5),top:a.game.orthoY(Math.floor(325)+a.hintShift)}));a.image=
new b.Line(y([a.game.orthoX(Math.floor(-500)),a.game.orthoY(Math.floor(325)),a.game.orthoX(Math.floor(500)),a.game.orthoY(Math.floor(325))]),C({stroke:"white"}))})},get increment(){return q(this,function(a,b){a.scores[b]++})},get reset(){return q(this,function(a){a.scores=y([0,0]);h.reset(a)})},get commit(){return q(this,function(a){for(var c=[],e=S(a.scores,u([-.125,.375])),f=0;f<e.length;f++){var g=e[f],h=g[1];c.append(new b.Text("{}".format(g[0]),C({fill:"white",fontFamily:"arial",fontSize:"{}".format(a.game.canvas.width/
30),left:a.game.orthoX(1E3*h),top:a.game.orthoY(Math.floor(325)+a.nameShift)})))}a.scoreLabels=c})},get draw(){return q(this,function(a){for(var b=S(a.playerLabels,a.scoreLabels),c=0;c<b.length;c++){var e=b[c],f=e[1];a.game.canvas.add(e[0]);a.game.canvas.add(f);a.game.canvas.add(a.hintLabel)}a.game.canvas.add(a.image)})}});c.nameShift=75;c.hintShift=25;var l=D("Game",[L],{get __init__(){return q(this,function(d){d.serviceIndex=.5<Math.random()?1:0;d.pause=!0;d.keyCode=null;d.textFrame=document.getElementById("text_frame");
d.canvasFrame=document.getElementById("canvas_frame");d.buttonsFrame=document.getElementById("buttons_frame");d.canvas=new b.Canvas("canvas",C({backgroundColor:"black",originX:"center",originY:"center"}));d.canvas.onWindowDraw=d.draw;d.canvas.lineWidth=2;d.canvas.clear();d.attributes=y([]);d.paddles=function(){for(var a=[],b=0;2>b;b++)a.append(e(d,b));return a}();d.ball=a(d);d.scoreboard=c(d);window.setInterval(d.update,10);window.setInterval(d.draw,20);window.addEventListener("keydown",d.keydown);
window.addEventListener("keyup",d.keyup);d.buttons=y([]);for(var f=u("A Z K M space enter".split(" ")),g=0;g<f.length;g++){var h=f[g],k=document.getElementById(h);k.addEventListener("mousedown",function(a){return function(){return d.mouseOrTouch(a,!0)}}(h));k.addEventListener("touchstart",function(a){return function(){return d.mouseOrTouch(a,!0)}}(h));k.addEventListener("mouseup",function(a){return function(){return d.mouseOrTouch(a,!1)}}(h));k.addEventListener("touchend",function(a){return function(){return d.mouseOrTouch(a,
!1)}}(h));k.style.cursor="pointer";k.style.userSelect="none";d.buttons.append(k)}d.time=+new Date;window.onresize=d.resize;d.resize()})},get install(){return q(this,function(a){a=a.attributes;for(var b=0;b<a.length;b++)a[b].install()})},get mouseOrTouch(){return q(this,function(a,b,c){a.keyCode=c?"space"==b?p:"enter"==b?m:M(b):null})},get update(){return q(this,function(a){var b=a.time;a.time=+new Date;a.deltaT=(a.time-b)/1E3;if(a.pause)a.keyCode==p?a.pause=!1:a.keyCode==m&&a.scoreboard.reset();else{for(var b=
a.attributes,c=0;c<b.length;c++){var e=b[c];e.predict()}b=a.attributes;for(c=0;c<b.length;c++)e=b[c],e.interact();b=a.attributes;for(c=0;c<b.length;c++)e=b[c],e.commit()}})},get scored(){return q(this,function(a,b){a.scoreboard.increment(b);a.serviceIndex=1-b;for(var c=a.paddles,e=0;e<c.length;e++)c[e].reset();a.ball.reset();a.pause=!0})},get commit(){return q(this,function(a){a=a.attributes;for(var b=0;b<a.length;b++)a[b].commit()})},get draw(){return q(this,function(a){a.canvas.clear();a=a.attributes;
for(var b=0;b<a.length;b++)a[b].draw()})},get resize(){return q(this,function(a){a.pageWidth=window.innerWidth;a.pageHeight=window.innerHeight;a.textTop=0;a.pageHeight>1.2*a.pageWidth?(a.canvasWidth=a.pageWidth,a.canvasTop=a.textTop+300):(a.canvasWidth=.6*a.pageWidth,a.canvasTop=a.textTop+200);a.canvasLeft=.5*(a.pageWidth-a.canvasWidth);a.canvasHeight=.6*a.canvasWidth;a.buttonsTop=a.canvasTop+a.canvasHeight+50;a.buttonsWidth=500;a.textFrame.style.top=a.textTop;a.textFrame.style.left=a.canvasLeft+
.05*a.canvasWidth;a.textFrame.style.width=.9*a.canvasWidth;a.canvasFrame.style.top=a.canvasTop;a.canvasFrame.style.left=a.canvasLeft;a.canvas.setDimensions(C({width:a.canvasWidth,height:a.canvasHeight}));a.buttonsFrame.style.top=a.buttonsTop;a.buttonsFrame.style.left=.5*(a.pageWidth-a.buttonsWidth);a.buttonsFrame.style.width=a.canvasWidth;a.install();a.commit();a.draw()})},get scaleX(){return q(this,function(a,b){return a.canvas.width/1E3*b})},get scaleY(){return q(this,function(a,b){return a.canvas.height/
750*b})},get orthoX(){return q(this,function(a,b){return a.scaleX(b+Math.floor(500))})},get orthoY(){return q(this,function(a,b){return a.scaleY(750-Math.floor(325)-b)})},get keydown(){return q(this,function(a,b){a.keyCode=b.keyCode})},get keyup(){return q(this,function(a,b){a.keyCode=null})}}),g=l();n.Attribute=h;n.Ball=a;n.Game=l;n.Paddle=e;n.Scoreboard=c;n.Sprite=f;n.enter=m;n.esc=k;n.fieldHeight=650;n.game=g;n.orthoHeight=750;n.orthoWidth=1E3;n.space=p})();return n}window.pong=pong();

//# sourceMappingURL=extra/sourcemap/pong.min.js.map
