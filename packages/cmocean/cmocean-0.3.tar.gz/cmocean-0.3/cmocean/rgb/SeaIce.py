
from matplotlib.colors import LinearSegmentedColormap
from numpy import nan, inf

# Used to reconstruct the colormap in pycam02ucs.cm.viscm
parameters = {'xp': [-3.5644133874287434, 0.23692942457759614, -25.681317020920034, -32.247272787112763, -11.85825224998797, -5.9834497223418452],
              'yp': [-25.3060821484992, -61.246050552922583, -23.578199052132703, -11.828593996840425, -8.7184044233807185, -5.608214849921012],
              'min_Jp': 20.1526717557,
              'max_Jp': 97.4045801527}

cm_data = [[ 0.10208179,  0.16108456,  0.35131051],
       [ 0.10432355,  0.16341737,  0.35743316],
       [ 0.10655717,  0.16574542,  0.36355589],
       [ 0.10878037,  0.16806569,  0.36969619],
       [ 0.11098375,  0.17036433,  0.37592774],
       [ 0.11317909,  0.17265924,  0.3821576 ],
       [ 0.11536015,  0.17494139,  0.38843404],
       [ 0.11752458,  0.17720755,  0.39477448],
       [ 0.11968089,  0.17947111,  0.40111105],
       [ 0.12181696,  0.18171404,  0.40753693],
       [ 0.12394116,  0.18394967,  0.41398501],
       [ 0.12605344,  0.18617858,  0.42045356],
       [ 0.1281441 ,  0.1883865 ,  0.42701522],
       [ 0.13022599,  0.19059395,  0.43356815],
       [ 0.13228592,  0.1927815 ,  0.44021023],
       [ 0.13433203,  0.19496256,  0.44687585],
       [ 0.13636202,  0.19713462,  0.45357868],
       [ 0.13837006,  0.1992899 ,  0.46035776],
       [ 0.14036686,  0.20144585,  0.46712924],
       [ 0.14233412,  0.20357622,  0.47402182],
       [ 0.14429035,  0.20571023,  0.48089526],
       [ 0.14621711,  0.20782201,  0.48787561],
       [ 0.14812828,  0.2099338 ,  0.49485759],
       [ 0.15001062,  0.21202817,  0.50192602],
       [ 0.15187268,  0.21411951,  0.50901407],
       [ 0.15370467,  0.21619615,  0.51617883],
       [ 0.15551289,  0.21826934,  0.52336913],
       [ 0.15728745,  0.22032821,  0.53063824],
       [ 0.15903623,  0.22238619,  0.53792531],
       [ 0.16074492,  0.22442766,  0.54530614],
       [ 0.16242773,  0.2264742 ,  0.55268255],
       [ 0.16406046,  0.2284993 ,  0.56018137],
       [ 0.16566342,  0.23053189,  0.56767101],
       [ 0.16721428,  0.2325498 ,  0.57525857],
       [ 0.16872175,  0.23456813,  0.58287794],
       [ 0.17018285,  0.23658833,  0.590527  ],
       [ 0.17157864,  0.23859631,  0.59827683],
       [ 0.17292331,  0.24061297,  0.60603566],
       [ 0.17420274,  0.24263076,  0.61384544],
       [ 0.17540368,  0.24464536,  0.62173451],
       [ 0.17653384,  0.24667185,  0.62964016],
       [ 0.17758505,  0.24871143,  0.63756617],
       [ 0.1785303 ,  0.25075309,  0.64557737],
       [ 0.17937464,  0.25281215,  0.65361345],
       [ 0.18010875,  0.25489357,  0.66166514],
       [ 0.18071922,  0.25700126,  0.66973054],
       [ 0.18119083,  0.25914023,  0.67780529],
       [ 0.18150644,  0.26131676,  0.68588178],
       [ 0.18164693,  0.2635387 ,  0.69394828],
       [ 0.18159094,  0.26581555,  0.70198858],
       [ 0.18131646,  0.26815915,  0.70997807],
       [ 0.18079836,  0.27058281,  0.71788878],
       [ 0.18001191,  0.2731021 ,  0.725683  ],
       [ 0.17893231,  0.27573406,  0.73331614],
       [ 0.17753632,  0.27849662,  0.7407369 ],
       [ 0.17580387,  0.28140754,  0.7478889 ],
       [ 0.17369391,  0.28448272,  0.75473488],
       [ 0.17122665,  0.28773748,  0.76118691],
       [ 0.16840341,  0.29117974,  0.76719431],
       [ 0.16523663,  0.29481127,  0.77271577],
       [ 0.16176924,  0.29862478,  0.7777175 ],
       [ 0.15804191,  0.30260614,  0.78219218],
       [ 0.15409725,  0.30673616,  0.78615122],
       [ 0.14999008,  0.31099072,  0.78961965],
       [ 0.1457565 ,  0.3153471 ,  0.79263554],
       [ 0.14142364,  0.31978449,  0.7952407 ],
       [ 0.1370518 ,  0.3242772 ,  0.79748075],
       [ 0.13263637,  0.32881288,  0.79939675],
       [ 0.12819797,  0.33337665,  0.80102733],
       [ 0.12376975,  0.33795301,  0.80241118],
       [ 0.11936251,  0.34253248,  0.80358041],
       [ 0.11497627,  0.3471092 ,  0.80456067],
       [ 0.11062233,  0.35167652,  0.80537659],
       [ 0.106311  ,  0.35622918,  0.80604977],
       [ 0.10205201,  0.36076309,  0.8065991 ],
       [ 0.09785478,  0.36527509,  0.80704105],
       [ 0.09373209,  0.36976229,  0.80739097],
       [ 0.08969286,  0.37422314,  0.80766113],
       [ 0.08574275,  0.37865723,  0.80786091],
       [ 0.08189306,  0.38306372,  0.8079998 ],
       [ 0.0781561 ,  0.38744208,  0.80808613],
       [ 0.07454532,  0.39179208,  0.80812721],
       [ 0.0710755 ,  0.39611368,  0.80812947],
       [ 0.06776277,  0.400407  ,  0.8080986 ],
       [ 0.06462775,  0.4046719 ,  0.80804065],
       [ 0.06168965,  0.40890872,  0.8079602 ],
       [ 0.0589656 ,  0.41311832,  0.80786022],
       [ 0.05647631,  0.41730122,  0.80774419],
       [ 0.05424296,  0.421458  ,  0.80761518],
       [ 0.05228662,  0.42558925,  0.80747597],
       [ 0.05062754,  0.42969559,  0.80732903],
       [ 0.04928431,  0.43377765,  0.80717659],
       [ 0.04827299,  0.43783607,  0.80702067],
       [ 0.04760625,  0.44187148,  0.80686309],
       [ 0.04729258,  0.44588451,  0.80670548],
       [ 0.04734353,  0.44987488,  0.80655233],
       [ 0.04774883,  0.45384426,  0.80640166],
       [ 0.04850239,  0.45779325,  0.80625469],
       [ 0.04959366,  0.46172246,  0.80611249],
       [ 0.05100823,  0.46563246,  0.80597608],
       [ 0.05272864,  0.46952382,  0.80584634],
       [ 0.05473545,  0.47339706,  0.80572424],
       [ 0.05701094,  0.47725227,  0.80561232],
       [ 0.05952887,  0.4810906 ,  0.80550888],
       [ 0.06226803,  0.48491256,  0.80541454],
       [ 0.06520791,  0.48871865,  0.80532986],
       [ 0.06832897,  0.49250933,  0.80525536],
       [ 0.07161302,  0.49628508,  0.8051915 ],
       [ 0.07504423,  0.50004615,  0.80513951],
       [ 0.07860576,  0.50379326,  0.80509857],
       [ 0.08228378,  0.50752685,  0.80506892],
       [ 0.08606601,  0.51124732,  0.80505086],
       [ 0.08994147,  0.51495505,  0.80504465],
       [ 0.09390044,  0.51865044,  0.80505053],
       [ 0.09793413,  0.52233387,  0.80506846],
       [ 0.10203488,  0.52600576,  0.80509841],
       [ 0.10619611,  0.52966642,  0.80514056],
       [ 0.11041206,  0.53331618,  0.80519501],
       [ 0.11467766,  0.53695534,  0.80526189],
       [ 0.11898847,  0.54058423,  0.80534111],
       [ 0.12334032,  0.54420331,  0.80543178],
       [ 0.12773029,  0.54781271,  0.80553468],
       [ 0.13215555,  0.55141267,  0.80564984],
       [ 0.13661368,  0.55500346,  0.80577726],
       [ 0.14110259,  0.55858529,  0.80591692],
       [ 0.1456205 ,  0.56215841,  0.80606874],
       [ 0.15016572,  0.56572332,  0.80623083],
       [ 0.15473733,  0.56927995,  0.80640475],
       [ 0.15933433,  0.57282848,  0.80659043],
       [ 0.16395593,  0.57636908,  0.80678779],
       [ 0.1686015 ,  0.57990192,  0.80699673],
       [ 0.17327056,  0.58342715,  0.80721713],
       [ 0.17796284,  0.58694501,  0.80744813],
       [ 0.1826783 ,  0.59045574,  0.80768867],
       [ 0.18741681,  0.59395925,  0.80794012],
       [ 0.19217841,  0.59745563,  0.80820233],
       [ 0.19696324,  0.60094498,  0.80847516],
       [ 0.20177153,  0.60442736,  0.80875844],
       [ 0.2066036 ,  0.60790286,  0.809052  ],
       [ 0.21145984,  0.61137151,  0.80935566],
       [ 0.21634081,  0.61483339,  0.8096689 ],
       [ 0.22124748,  0.61828867,  0.80999006],
       [ 0.22618001,  0.62173716,  0.81032078],
       [ 0.23113904,  0.62517886,  0.81066092],
       [ 0.23612528,  0.62861374,  0.81101029],
       [ 0.24113948,  0.63204178,  0.81136873],
       [ 0.24618243,  0.63546292,  0.8117361 ],
       [ 0.25125499,  0.6388771 ,  0.81211223],
       [ 0.25635804,  0.64228425,  0.81249699],
       [ 0.26149249,  0.64568426,  0.81289025],
       [ 0.26665931,  0.64907704,  0.81329189],
       [ 0.27185948,  0.65246244,  0.81370181],
       [ 0.27709401,  0.65584033,  0.81411993],
       [ 0.28236394,  0.65921056,  0.8145462 ],
       [ 0.28767032,  0.66257295,  0.8149806 ],
       [ 0.2930142 ,  0.6659273 ,  0.81542312],
       [ 0.29839667,  0.66927341,  0.81587379],
       [ 0.30381879,  0.67261107,  0.8163327 ],
       [ 0.30928164,  0.67594003,  0.81679994],
       [ 0.31478626,  0.67926004,  0.81727568],
       [ 0.3203337 ,  0.68257084,  0.81776012],
       [ 0.32592496,  0.68587216,  0.81825351],
       [ 0.33156102,  0.6891637 ,  0.81875618],
       [ 0.33724281,  0.69244517,  0.81926848],
       [ 0.3429712 ,  0.69571625,  0.81979086],
       [ 0.348747  ,  0.69897665,  0.82032381],
       [ 0.35457094,  0.70222604,  0.8208679 ],
       [ 0.36044368,  0.7054641 ,  0.82142378],
       [ 0.36636575,  0.70869052,  0.82199215],
       [ 0.37233761,  0.71190499,  0.82257381],
       [ 0.37836126,  0.71510711,  0.82316778],
       [ 0.38443606,  0.71829661,  0.82377602],
       [ 0.3905613 ,  0.72147323,  0.82440039],
       [ 0.39673684,  0.72463674,  0.82504202],
       [ 0.40296235,  0.72778688,  0.82570209],
       [ 0.40923734,  0.73092346,  0.8263819 ],
       [ 0.41556287,  0.73404615,  0.82708114],
       [ 0.42193763,  0.73715483,  0.82780172],
       [ 0.42835913,  0.74024952,  0.82854642],
       [ 0.43482606,  0.74333019,  0.82931675],
       [ 0.44133691,  0.74639685,  0.83011426],
       [ 0.44789246,  0.74944928,  0.83093844],
       [ 0.45448836,  0.75248785,  0.831793  ],
       [ 0.46112214,  0.7555128 ,  0.83267982],
       [ 0.46779151,  0.75852437,  0.83360045],
       [ 0.47449573,  0.76152267,  0.83455515],
       [ 0.48123046,  0.76450826,  0.8355468 ],
       [ 0.48799262,  0.76748167,  0.83657711],
       [ 0.4947795 ,  0.77044336,  0.83764735],
       [ 0.50158891,  0.77339379,  0.83875835],
       [ 0.50841669,  0.77633377,  0.83991216],
       [ 0.51525992,  0.77926394,  0.84110982],
       [ 0.52211565,  0.78218503,  0.84235231],
       [ 0.52898067,  0.78509783,  0.84364064],
       [ 0.53585209,  0.78800313,  0.84497554],
       [ 0.54272721,  0.79090172,  0.84635757],
       [ 0.54960246,  0.79379459,  0.84778772],
       [ 0.5564758 ,  0.79668249,  0.84926598],
       [ 0.563345  ,  0.79956624,  0.85079242],
       [ 0.5702076 ,  0.80244671,  0.85236724],
       [ 0.57706027,  0.80532498,  0.85399108],
       [ 0.5839024 ,  0.80820164,  0.855663  ],
       [ 0.59073225,  0.81107749,  0.85738273],
       [ 0.59754775,  0.81395341,  0.85915016],
       [ 0.60434646,  0.81683041,  0.86096539],
       [ 0.61112854,  0.81970895,  0.8628271 ],
       [ 0.61789285,  0.82258974,  0.86473473],
       [ 0.62463831,  0.82547351,  0.86668768],
       [ 0.63136246,  0.82836131,  0.8686861 ],
       [ 0.63806635,  0.8312534 ,  0.87072834],
       [ 0.64474939,  0.83415039,  0.87281365],
       [ 0.65141107,  0.8370529 ,  0.87494125],
       [ 0.65805033,  0.83996165,  0.87711068],
       [ 0.6646669 ,  0.84287719,  0.87932108],
       [ 0.67126137,  0.84579986,  0.88157125],
       [ 0.67783361,  0.84873015,  0.88386036],
       [ 0.68438355,  0.85166855,  0.88618758],
       [ 0.69091078,  0.8546156 ,  0.88855226],
       [ 0.69741546,  0.85757173,  0.89095353],
       [ 0.70389818,  0.86053722,  0.89339032],
       [ 0.7103591 ,  0.86351247,  0.89586183],
       [ 0.71679839,  0.86649787,  0.89836725],
       [ 0.72321624,  0.86949378,  0.9009058 ],
       [ 0.72961286,  0.87250057,  0.9034767 ],
       [ 0.73598879,  0.87551851,  0.90607905],
       [ 0.7423443 ,  0.87854791,  0.9087121 ],
       [ 0.74867968,  0.88158911,  0.9113751 ],
       [ 0.75499523,  0.8846424 ,  0.91406731],
       [ 0.76129171,  0.88770796,  0.91678779],
       [ 0.76756942,  0.89078609,  0.91953585],
       [ 0.77382849,  0.89387713,  0.92231085],
       [ 0.7800692 ,  0.89698135,  0.92511208],
       [ 0.78629185,  0.90009904,  0.92793886],
       [ 0.79249764,  0.90323022,  0.93079012],
       [ 0.79868695,  0.90637513,  0.93366512],
       [ 0.80485934,  0.90953426,  0.93656346],
       [ 0.81101502,  0.91270788,  0.93948446],
       [ 0.81715425,  0.91589628,  0.94242742],
       [ 0.82328018,  0.91909886,  0.94539039],
       [ 0.82939033,  0.92231672,  0.94837375],
       [ 0.83548477,  0.92555017,  0.95137678],
       [ 0.84156443,  0.92879928,  0.95439836],
       [ 0.84763234,  0.9320635 ,  0.95743645],
       [ 0.85368495,  0.93534425,  0.96049165],
       [ 0.85972214,  0.93864193,  0.96356312],
       [ 0.86575021,  0.94195499,  0.96664711],
       [ 0.87176263,  0.9452858 ,  0.96974525],
       [ 0.87776196,  0.94863398,  0.97285512],
       [ 0.88375044,  0.95199925,  0.97597418],
       [ 0.88972283,  0.95538368,  0.97910297],
       [ 0.89568688,  0.95878533,  0.98223584],
       [ 0.90163419,  0.96220736,  0.98537403],
       [ 0.9075708 ,  0.96564845,  0.98851153],
       [ 0.91349339,  0.96911034,  0.99164582],
       [ 0.91939879,  0.97259482,  0.99477329],
       [ 0.92528685,  0.97610291,  0.99788714]]

test_cm = LinearSegmentedColormap.from_list(__file__, cm_data)


if __name__ == "__main__":
    import matplotlib.pyplot as plt
    import numpy as np

    try:
        from pycam02ucs.cm.viscm import viscm
        viscm(test_cm)
    except ImportError:
        print("pycam02ucs not found, falling back on simple display")
        plt.imshow(np.linspace(0, 100, 256)[None, :], aspect='auto',
                   cmap=test_cm)
    plt.show()
