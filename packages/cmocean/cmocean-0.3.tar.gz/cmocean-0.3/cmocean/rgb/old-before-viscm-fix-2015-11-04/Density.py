
from matplotlib.colors import LinearSegmentedColormap
from numpy import nan, inf

# Used to reconstruct the colormap in pycam02ucs.cm.viscm
parameters = {'xp': [16.121891585344997, 50.921796085858603, 10.671796085858603, -14.703203914141397, -17.875928056390336, -6.124894998539105],
              'yp': [-2.5423728813559308, -13.458333333333314, -43.208333333333314, -35.333333333333314, -8.83264462809916, -2.5051652892562117],
              'min_JK': 15.0,
              'max_JK': 95.0}

cm_data = [[ 0.19007201,  0.07744143,  0.13567093],
       [ 0.19485069,  0.07893536,  0.13938026],
       [ 0.19961564,  0.08041511,  0.14310145],
       [ 0.20440156,  0.08184555,  0.14685414],
       [ 0.20917788,  0.08325821,  0.15062297],
       [ 0.21397236,  0.08462412,  0.15442499],
       [ 0.21875896,  0.08597085,  0.15824643],
       [ 0.223563  ,  0.08727108,  0.16210406],
       [ 0.2283584 ,  0.08855318,  0.16598316],
       [ 0.23317263,  0.08978652,  0.16990305],
       [ 0.23797493,  0.09100554,  0.17384491],
       [ 0.24279955,  0.09217084,  0.1778341 ],
       [ 0.24761192,  0.09332214,  0.18184798],
       [ 0.25244114,  0.09442492,  0.18590979],
       [ 0.25726436,  0.09550599,  0.19000435],
       [ 0.26209372,  0.09655033,  0.19414314],
       [ 0.26692661,  0.09756054,  0.19832651],
       [ 0.27175244,  0.09854959,  0.2025476 ],
       [ 0.27659308,  0.09948884,  0.20682827],
       [ 0.28142336,  0.10041023,  0.21114857],
       [ 0.2862568 ,  0.10129544,  0.21552368],
       [ 0.29109151,  0.10214604,  0.21995513],
       [ 0.29591565,  0.1029777 ,  0.2244338 ],
       [ 0.30074414,  0.1037687 ,  0.22897879],
       [ 0.30556698,  0.10453211,  0.23358323],
       [ 0.31037773,  0.10527661,  0.23824318],
       [ 0.31518534,  0.10598798,  0.24297327],
       [ 0.31998607,  0.10667047,  0.24777381],
       [ 0.32477144,  0.10733613,  0.25263839],
       [ 0.32954054,  0.10798556,  0.25757012],
       [ 0.33430168,  0.1086039 ,  0.26258649],
       [ 0.339044  ,  0.1092074 ,  0.26767782],
       [ 0.3437638 ,  0.1098011 ,  0.27284414],
       [ 0.34845902,  0.11038738,  0.27808818],
       [ 0.35312726,  0.11096919,  0.28341246],
       [ 0.35777038,  0.11154131,  0.28882833],
       [ 0.36238006,  0.11211743,  0.29432843],
       [ 0.36695211,  0.11270401,  0.29991257],
       [ 0.37148287,  0.11330672,  0.30558158],
       [ 0.37596839,  0.11393195,  0.31133572],
       [ 0.38040442,  0.11458683,  0.31717454],
       [ 0.38478653,  0.11527917,  0.32309684],
       [ 0.38911012,  0.11601741,  0.3291006 ],
       [ 0.3933705 ,  0.1168105 ,  0.33518292],
       [ 0.39756301,  0.11766776,  0.34134002],
       [ 0.40168306,  0.11859872,  0.34756726],
       [ 0.40572627,  0.1196129 ,  0.35385915],
       [ 0.40968851,  0.12071959,  0.36020942],
       [ 0.41356604,  0.12192767,  0.36661113],
       [ 0.41735554,  0.12324534,  0.37305677],
       [ 0.4210542 ,  0.12467998,  0.37953841],
       [ 0.42465972,  0.1262379 ,  0.38604782],
       [ 0.4281704 ,  0.12792428,  0.39257666],
       [ 0.43158509,  0.12974302,  0.39911657],
       [ 0.43490319,  0.13169675,  0.40565939],
       [ 0.43812464,  0.13378677,  0.41219718],
       [ 0.44124992,  0.13601325,  0.41872205],
       [ 0.44427993,  0.13837507,  0.42522684],
       [ 0.44721597,  0.14086998,  0.43170509],
       [ 0.45005965,  0.14349483,  0.43815094],
       [ 0.45281286,  0.1462457 ,  0.44455909],
       [ 0.45547769,  0.14911804,  0.45092488],
       [ 0.45805639,  0.1521068 ,  0.45724417],
       [ 0.4605513 ,  0.15520661,  0.46351341],
       [ 0.46296486,  0.15841185,  0.46972955],
       [ 0.46529954,  0.16171679,  0.47589005],
       [ 0.46755779,  0.16511567,  0.48199278],
       [ 0.46974207,  0.16860278,  0.48803605],
       [ 0.47185478,  0.17217252,  0.49401849],
       [ 0.47389828,  0.17581947,  0.49993909],
       [ 0.47587488,  0.17953838,  0.50579709],
       [ 0.47778678,  0.18332424,  0.51159202],
       [ 0.47963614,  0.1871723 ,  0.51732358],
       [ 0.48142501,  0.19107803,  0.52299169],
       [ 0.48315539,  0.19503718,  0.5285964 ],
       [ 0.48482918,  0.19904574,  0.53413792],
       [ 0.4864482 ,  0.20309999,  0.53961656],
       [ 0.4880142 ,  0.2071964 ,  0.54503272],
       [ 0.48952886,  0.21133171,  0.55038689],
       [ 0.49099379,  0.21550289,  0.55567961],
       [ 0.49241051,  0.2197071 ,  0.5609115 ],
       [ 0.49378051,  0.22394171,  0.56608318],
       [ 0.4951052 ,  0.2282043 ,  0.57119534],
       [ 0.49638593,  0.23249259,  0.57624866],
       [ 0.49762402,  0.2368045 ,  0.58124388],
       [ 0.49882072,  0.24113807,  0.5861817 ],
       [ 0.49997723,  0.24549153,  0.59106288],
       [ 0.50109474,  0.2498632 ,  0.59588814],
       [ 0.50217435,  0.25425154,  0.60065822],
       [ 0.50321717,  0.25865513,  0.60537386],
       [ 0.50422424,  0.26307265,  0.61003579],
       [ 0.50519694,  0.26750263,  0.61464448],
       [ 0.5061362 ,  0.27194402,  0.61920074],
       [ 0.50704262,  0.27639598,  0.62370549],
       [ 0.50791715,  0.28085756,  0.62815943],
       [ 0.50876067,  0.28532786,  0.63256322],
       [ 0.50957408,  0.28980607,  0.63691752],
       [ 0.51035822,  0.29429142,  0.64122297],
       [ 0.51111395,  0.29878321,  0.6454802 ],
       [ 0.51184207,  0.30328079,  0.64968981],
       [ 0.51254341,  0.30778354,  0.65385241],
       [ 0.5132189 ,  0.31229083,  0.65796849],
       [ 0.51386931,  0.31680213,  0.66203864],
       [ 0.51449515,  0.32131714,  0.66606349],
       [ 0.51509715,  0.32583541,  0.67004356],
       [ 0.51567606,  0.33035654,  0.67397934],
       [ 0.5162326 ,  0.33488016,  0.67787131],
       [ 0.51676749,  0.33940591,  0.68171993],
       [ 0.51728144,  0.34393349,  0.68552564],
       [ 0.51777515,  0.34846259,  0.68928886],
       [ 0.51824929,  0.35299295,  0.69300999],
       [ 0.51870446,  0.35752438,  0.69668945],
       [ 0.51914135,  0.36205665,  0.70032759],
       [ 0.51956065,  0.36658954,  0.70392474],
       [ 0.51996304,  0.37112286,  0.70748122],
       [ 0.52034921,  0.37565641,  0.71099734],
       [ 0.52071984,  0.38019002,  0.71447339],
       [ 0.52107562,  0.38472355,  0.71790962],
       [ 0.52141724,  0.38925685,  0.72130628],
       [ 0.52174527,  0.39378984,  0.7246636 ],
       [ 0.52206008,  0.39832258,  0.72798178],
       [ 0.52236273,  0.40285477,  0.731261  ],
       [ 0.52265392,  0.40738628,  0.73450141],
       [ 0.52293438,  0.41191702,  0.73770317],
       [ 0.52320485,  0.41644689,  0.7408664 ],
       [ 0.52346605,  0.42097579,  0.74399121],
       [ 0.52371874,  0.42550364,  0.74707771],
       [ 0.5239637 ,  0.43003035,  0.75012595],
       [ 0.52420169,  0.43455585,  0.75313601],
       [ 0.52443352,  0.43908005,  0.75610791],
       [ 0.52465926,  0.44360325,  0.75904158],
       [ 0.52488041,  0.44812504,  0.7619371 ],
       [ 0.52509786,  0.45264532,  0.76479446],
       [ 0.52531249,  0.457164  ,  0.76761364],
       [ 0.52552521,  0.461681  ,  0.7703946 ],
       [ 0.52573695,  0.46619624,  0.77313729],
       [ 0.52594865,  0.47070963,  0.77584163],
       [ 0.52616131,  0.47522109,  0.77850755],
       [ 0.52637594,  0.47973052,  0.78113496],
       [ 0.52659358,  0.48423782,  0.78372376],
       [ 0.5268153 ,  0.4887429 ,  0.78627384],
       [ 0.52704221,  0.49324565,  0.78878507],
       [ 0.52727547,  0.49774596,  0.79125733],
       [ 0.52751624,  0.5022437 ,  0.79369047],
       [ 0.52776576,  0.50673876,  0.79608437],
       [ 0.52802499,  0.51123113,  0.79843876],
       [ 0.52829537,  0.51572061,  0.80075355],
       [ 0.52857844,  0.52020696,  0.80302864],
       [ 0.52887558,  0.52469002,  0.8052639 ],
       [ 0.52918822,  0.52916962,  0.80745919],
       [ 0.52951784,  0.53364559,  0.80961436],
       [ 0.52986595,  0.53811774,  0.81172929],
       [ 0.53023412,  0.54258588,  0.81380384],
       [ 0.53062396,  0.5470498 ,  0.81583791],
       [ 0.53103711,  0.55150929,  0.8178314 ],
       [ 0.53147527,  0.55596413,  0.81978421],
       [ 0.53194018,  0.56041408,  0.82169627],
       [ 0.53243362,  0.5648589 ,  0.82356753],
       [ 0.5329574 ,  0.56929834,  0.82539796],
       [ 0.5335134 ,  0.57373213,  0.82718755],
       [ 0.53410349,  0.57816001,  0.82893631],
       [ 0.53472963,  0.58258169,  0.8306443 ],
       [ 0.53539376,  0.58699688,  0.83231159],
       [ 0.53609789,  0.59140529,  0.83393828],
       [ 0.53684376,  0.59580674,  0.83552431],
       [ 0.53763349,  0.60020088,  0.8370699 ],
       [ 0.53846931,  0.6045873 ,  0.83857541],
       [ 0.53935331,  0.60896569,  0.84004109],
       [ 0.54028756,  0.61333571,  0.84146726],
       [ 0.54127415,  0.61769702,  0.84285427],
       [ 0.54231517,  0.62204929,  0.84420253],
       [ 0.5434127 ,  0.62639217,  0.8455125 ],
       [ 0.54456879,  0.63072533,  0.84678467],
       [ 0.54578548,  0.63504841,  0.84801962],
       [ 0.54706479,  0.63936108,  0.84921794],
       [ 0.54840869,  0.643663  ,  0.85038032],
       [ 0.54981912,  0.64795383,  0.85150747],
       [ 0.55129788,  0.65223328,  0.85260004],
       [ 0.55284642,  0.65650123,  0.85365828],
       [ 0.55446703,  0.66075709,  0.85468379],
       [ 0.55616141,  0.66500056,  0.85567752],
       [ 0.55793121,  0.66923132,  0.85664047],
       [ 0.55977795,  0.67344909,  0.8575737 ],
       [ 0.56170312,  0.67765358,  0.85847833],
       [ 0.56370807,  0.68184452,  0.85935551],
       [ 0.56579408,  0.68602167,  0.86020647],
       [ 0.56796196,  0.690185  ,  0.86103157],
       [ 0.57021317,  0.69433405,  0.86183297],
       [ 0.57254869,  0.6984686 ,  0.86261208],
       [ 0.57496937,  0.70258847,  0.86337028],
       [ 0.57747593,  0.70669347,  0.86410901],
       [ 0.58006898,  0.71078345,  0.86482973],
       [ 0.58274898,  0.71485832,  0.86553371],
       [ 0.58551623,  0.71891803,  0.86622203],
       [ 0.58837118,  0.72296235,  0.86689694],
       [ 0.59131398,  0.72699119,  0.86756   ],
       [ 0.59434467,  0.73100449,  0.8682128 ],
       [ 0.59746317,  0.73500222,  0.86885696],
       [ 0.60066931,  0.73898438,  0.86949381],
       [ 0.60396279,  0.742951  ,  0.87012471],
       [ 0.60734332,  0.74690201,  0.87075186],
       [ 0.6108104 ,  0.75083744,  0.87137689],
       [ 0.61436348,  0.75475734,  0.87200145],
       [ 0.61800191,  0.75866177,  0.87262716],
       [ 0.62172505,  0.76255086,  0.873255  ],
       [ 0.62553207,  0.76642465,  0.87388716],
       [ 0.62942212,  0.77028324,  0.87452537],
       [ 0.63339427,  0.77412673,  0.87517124],
       [ 0.63744754,  0.77795527,  0.87582636],
       [ 0.64158105,  0.78176901,  0.87649176],
       [ 0.64579368,  0.78556808,  0.87716939],
       [ 0.65008428,  0.78935263,  0.877861  ],
       [ 0.65445174,  0.79312282,  0.87856815],
       [ 0.6588949 ,  0.79687882,  0.87929238],
       [ 0.6634128 ,  0.80062083,  0.8800345 ],
       [ 0.6680041 ,  0.80434899,  0.88079665],
       [ 0.67266756,  0.8080635 ,  0.88158043],
       [ 0.67740197,  0.81176455,  0.88238734],
       [ 0.68220621,  0.81545231,  0.88321862],
       [ 0.68707928,  0.81912697,  0.88407537],
       [ 0.69201969,  0.82278872,  0.8849597 ],
       [ 0.69702626,  0.82643775,  0.88587311],
       [ 0.70209778,  0.83007425,  0.88681707],
       [ 0.7072335 ,  0.83369837,  0.88779223],
       [ 0.71243191,  0.83731031,  0.88880081],
       [ 0.71769177,  0.84091028,  0.88984445],
       [ 0.72301192,  0.84449845,  0.89092468],
       [ 0.72839166,  0.84807494,  0.8920423 ],
       [ 0.73382964,  0.85163996,  0.8931993 ],
       [ 0.73932451,  0.85519371,  0.89439758],
       [ 0.74487515,  0.85873639,  0.89563877],
       [ 0.75048097,  0.86226806,  0.89692374],
       [ 0.75614053,  0.86578897,  0.89825466],
       [ 0.76185247,  0.86929934,  0.89963357],
       [ 0.76761563,  0.87279936,  0.90106222],
       [ 0.77342961,  0.87628907,  0.90254147],
       [ 0.77929249,  0.87976883,  0.9040741 ],
       [ 0.78520299,  0.88323887,  0.90566208],
       [ 0.79116006,  0.88669938,  0.90730708],
       [ 0.79716268,  0.89015054,  0.90901078],
       [ 0.8032089 ,  0.89359277,  0.91077587],
       [ 0.80929725,  0.89702637,  0.91260439],
       [ 0.81542671,  0.90045157,  0.91449798],
       [ 0.8215952 ,  0.90386885,  0.91645923],
       [ 0.82780089,  0.90727868,  0.91849039],
       [ 0.83404207,  0.91068148,  0.92059351],
       [ 0.84031672,  0.91407782,  0.92277078],
       [ 0.84662259,  0.91746832,  0.92502446],
       [ 0.85295753,  0.92085363,  0.92735659],
       [ 0.85931874,  0.92423461,  0.92976944],
       [ 0.86570396,  0.927612  ,  0.93226476],
       [ 0.8721106 ,  0.93098667,  0.93484425],
       [ 0.87853522,  0.9343598 ,  0.93750993],
       [ 0.88497485,  0.93773248,  0.94026318],
       [ 0.89142694,  0.94110572,  0.94310489],
       [ 0.89788838,  0.94448075,  0.94603595]]

test_cm = LinearSegmentedColormap.from_list(__file__, cm_data)


if __name__ == "__main__":
    import matplotlib.pyplot as plt
    import numpy as np

    try:
        from pycam02ucs.cm.viscm import viscm
        viscm(test_cm)
    except ImportError:
        print("pycam02ucs not found, falling back on simple display")
        plt.imshow(np.linspace(0, 100, 256)[None, :], aspect='auto',
                   cmap=test_cm)
    plt.show()
