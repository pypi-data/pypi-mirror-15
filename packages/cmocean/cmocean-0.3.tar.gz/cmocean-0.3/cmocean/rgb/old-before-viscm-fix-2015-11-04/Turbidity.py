
from matplotlib.colors import LinearSegmentedColormap
from numpy import nan, inf

# Used to reconstruct the colormap in pycam02ucs.cm.viscm
parameters = {'xp': [0.58240736074719734, 6.0096523611751991, 12.524034763882469, 14.892901092139653, 6.6018689432394808, -7.0191124442393686],
              'yp': [4.6747967479675197, 7.4661590524534631, 11.907783417935718, 24.936548223350258, 32.635363790186119, 23.456006768189525],
              'min_JK': 15.0,
              'max_JK': 95.0}

cm_data = [[ 0.13110868,  0.11943546,  0.09346605],
       [ 0.13493423,  0.1220596 ,  0.09570666],
       [ 0.13876004,  0.12467086,  0.09793424],
       [ 0.142586  ,  0.12726982,  0.10014873],
       [ 0.14641123,  0.12985734,  0.10235053],
       [ 0.15023656,  0.13243361,  0.10453886],
       [ 0.154062  ,  0.13499912,  0.1067135 ],
       [ 0.15788693,  0.13755458,  0.10887466],
       [ 0.16171194,  0.14010022,  0.11102172],
       [ 0.16553723,  0.1426364 ,  0.11315431],
       [ 0.16936264,  0.1451636 ,  0.11527238],
       [ 0.1731881 ,  0.14768227,  0.11737577],
       [ 0.17701418,  0.15019257,  0.1194639 ],
       [ 0.18084098,  0.15269484,  0.12153652],
       [ 0.18466822,  0.15518956,  0.1235937 ],
       [ 0.18849625,  0.15767695,  0.12563505],
       [ 0.19232539,  0.16015722,  0.12766019],
       [ 0.19615576,  0.16263064,  0.1296689 ],
       [ 0.19998715,  0.16509763,  0.13166126],
       [ 0.20381981,  0.16755839,  0.13363698],
       [ 0.20765407,  0.17001309,  0.13559571],
       [ 0.21149001,  0.17246197,  0.13753728],
       [ 0.21532765,  0.17490532,  0.13946164],
       [ 0.2191668 ,  0.17734349,  0.14136887],
       [ 0.22300792,  0.17977654,  0.14325853],
       [ 0.2268511 ,  0.1822047 ,  0.14513048],
       [ 0.23069639,  0.18462819,  0.14698462],
       [ 0.23454374,  0.18704729,  0.14882096],
       [ 0.23839305,  0.18946226,  0.15063954],
       [ 0.24224466,  0.19187321,  0.15244002],
       [ 0.24609861,  0.19428032,  0.15422232],
       [ 0.24995493,  0.19668382,  0.15598636],
       [ 0.25381365,  0.1990839 ,  0.15773208],
       [ 0.25767449,  0.20148089,  0.15945974],
       [ 0.26153775,  0.20387487,  0.161169  ],
       [ 0.26540347,  0.20626602,  0.16285978],
       [ 0.26927166,  0.20865454,  0.16453203],
       [ 0.27314231,  0.21104062,  0.16618572],
       [ 0.27701543,  0.21342444,  0.16782083],
       [ 0.28089078,  0.2158063 ,  0.16943757],
       [ 0.28476852,  0.2181863 ,  0.17103573],
       [ 0.28864869,  0.22056462,  0.17261524],
       [ 0.29253127,  0.22294142,  0.17417608],
       [ 0.29641622,  0.22531691,  0.17571824],
       [ 0.30030353,  0.22769125,  0.17724171],
       [ 0.30419315,  0.23006464,  0.1787465 ],
       [ 0.30808487,  0.23243733,  0.18023283],
       [ 0.31197879,  0.23480944,  0.18170054],
       [ 0.31587491,  0.23718113,  0.18314957],
       [ 0.31977317,  0.23955258,  0.18457995],
       [ 0.32367354,  0.24192397,  0.18599168],
       [ 0.32757594,  0.24429547,  0.18738479],
       [ 0.33148033,  0.24666726,  0.1887593 ],
       [ 0.33538664,  0.24903953,  0.19011524],
       [ 0.3392947 ,  0.25141248,  0.19145277],
       [ 0.34320451,  0.25378628,  0.19277186],
       [ 0.34711605,  0.25616106,  0.19407246],
       [ 0.35102925,  0.25853702,  0.1953546 ],
       [ 0.35494404,  0.26091431,  0.19661833],
       [ 0.35886033,  0.26329312,  0.19786369],
       [ 0.36277805,  0.26567363,  0.19909071],
       [ 0.36669711,  0.268056  ,  0.20029946],
       [ 0.37061743,  0.27044041,  0.20148996],
       [ 0.37453892,  0.27282703,  0.20266229],
       [ 0.37846139,  0.27521608,  0.20381664],
       [ 0.38238485,  0.2776077 ,  0.20495292],
       [ 0.38630921,  0.28000205,  0.20607118],
       [ 0.39023437,  0.28239932,  0.20717149],
       [ 0.39416022,  0.28479967,  0.2082539 ],
       [ 0.39808666,  0.28720328,  0.20931849],
       [ 0.40201358,  0.28961034,  0.21036532],
       [ 0.40594087,  0.29202101,  0.21139447],
       [ 0.40986842,  0.29443548,  0.21240601],
       [ 0.41379611,  0.29685393,  0.21340003],
       [ 0.41772381,  0.29927654,  0.21437661],
       [ 0.4216514 ,  0.30170348,  0.21533587],
       [ 0.42557873,  0.30413496,  0.21627791],
       [ 0.4295057 ,  0.30657113,  0.21720276],
       [ 0.43343218,  0.30901219,  0.21811052],
       [ 0.43735803,  0.31145831,  0.2190013 ],
       [ 0.4412831 ,  0.31390969,  0.21987519],
       [ 0.44520726,  0.31636651,  0.2207323 ],
       [ 0.44913035,  0.31882896,  0.22157275],
       [ 0.45305221,  0.32129724,  0.22239665],
       [ 0.45697269,  0.32377153,  0.22320413],
       [ 0.46089163,  0.32625203,  0.22399532],
       [ 0.46480884,  0.32873894,  0.22477034],
       [ 0.46872417,  0.33123245,  0.22552933],
       [ 0.47263742,  0.33373276,  0.22627245],
       [ 0.47654843,  0.33624009,  0.22699982],
       [ 0.480457  ,  0.33875462,  0.22771162],
       [ 0.48436294,  0.34127657,  0.22840799],
       [ 0.48826604,  0.34380614,  0.22908911],
       [ 0.4921661 ,  0.34634355,  0.22975516],
       [ 0.4960629 ,  0.34888902,  0.23040632],
       [ 0.49995623,  0.35144275,  0.23104281],
       [ 0.50384586,  0.35400497,  0.23166481],
       [ 0.50773155,  0.35657591,  0.23227256],
       [ 0.51161306,  0.35915579,  0.23286627],
       [ 0.51549015,  0.36174483,  0.23344618],
       [ 0.51936256,  0.36434327,  0.23401254],
       [ 0.52323002,  0.36695135,  0.23456562],
       [ 0.52709229,  0.36956928,  0.23510557],
       [ 0.53094908,  0.37219734,  0.23563277],
       [ 0.53480008,  0.37483575,  0.23614755],
       [ 0.53864499,  0.37748477,  0.2366502 ],
       [ 0.54248352,  0.38014466,  0.23714108],
       [ 0.54631533,  0.38281567,  0.23762054],
       [ 0.55014011,  0.38549805,  0.23808894],
       [ 0.55395752,  0.38819209,  0.23854668],
       [ 0.55776721,  0.39089803,  0.23899416],
       [ 0.56156883,  0.39361616,  0.23943184],
       [ 0.565362  ,  0.39634676,  0.23986015],
       [ 0.56914638,  0.39909009,  0.24027946],
       [ 0.57292157,  0.40184643,  0.24069024],
       [ 0.57668716,  0.40461609,  0.24109317],
       [ 0.58044271,  0.40739936,  0.24148879],
       [ 0.58418782,  0.41019653,  0.24187771],
       [ 0.58792204,  0.4130079 ,  0.24226054],
       [ 0.59164493,  0.41583377,  0.24263793],
       [ 0.59535602,  0.41867446,  0.24301058],
       [ 0.59905486,  0.42153027,  0.2433792 ],
       [ 0.60274094,  0.42440151,  0.24374456],
       [ 0.60641382,  0.42728849,  0.24410717],
       [ 0.61007297,  0.43019154,  0.24446806],
       [ 0.61371784,  0.43311098,  0.2448282 ],
       [ 0.61734791,  0.43604713,  0.24518851],
       [ 0.62096265,  0.43900031,  0.24554996],
       [ 0.6245615 ,  0.44197086,  0.24591356],
       [ 0.6281439 ,  0.44495908,  0.2462804 ],
       [ 0.6317093 ,  0.44796532,  0.24665156],
       [ 0.63525711,  0.45098989,  0.24702804],
       [ 0.63878676,  0.45403312,  0.24741105],
       [ 0.64229764,  0.45709532,  0.24780205],
       [ 0.64578915,  0.46017682,  0.24820237],
       [ 0.6492607 ,  0.46327792,  0.24861339],
       [ 0.65271169,  0.46639893,  0.24903653],
       [ 0.65614151,  0.46954015,  0.24947327],
       [ 0.65954956,  0.47270187,  0.24992513],
       [ 0.66293524,  0.47588441,  0.25039349],
       [ 0.66629796,  0.479088  ,  0.25088027],
       [ 0.66963713,  0.48231292,  0.25138715],
       [ 0.67295217,  0.48555942,  0.25191586],
       [ 0.67624253,  0.48882773,  0.2524682 ],
       [ 0.67950765,  0.49211808,  0.25304597],
       [ 0.682747  ,  0.49543068,  0.25365103],
       [ 0.68596006,  0.49876569,  0.25428532],
       [ 0.68914636,  0.5021233 ,  0.2549508 ],
       [ 0.69230544,  0.50550363,  0.2556494 ],
       [ 0.69543685,  0.50890683,  0.2563831 ],
       [ 0.69854021,  0.51233297,  0.25715384],
       [ 0.70161514,  0.51578215,  0.25796362],
       [ 0.70466132,  0.5192544 ,  0.25881445],
       [ 0.70767854,  0.52274969,  0.25970854],
       [ 0.71066651,  0.52626806,  0.26064758],
       [ 0.71362502,  0.52980947,  0.26163348],
       [ 0.71655392,  0.53337386,  0.26266808],
       [ 0.71945312,  0.53696114,  0.26375322],
       [ 0.72232255,  0.54057119,  0.26489062],
       [ 0.72516222,  0.54420387,  0.266082  ],
       [ 0.72797232,  0.5478589 ,  0.26732925],
       [ 0.73075299,  0.55153606,  0.26863392],
       [ 0.73350428,  0.5552352 ,  0.26999718],
       [ 0.73622639,  0.55895607,  0.27142036],
       [ 0.73891959,  0.56269839,  0.27290471],
       [ 0.7415842 ,  0.56646185,  0.27445135],
       [ 0.74422057,  0.57024614,  0.27606131],
       [ 0.74682911,  0.57405091,  0.27773549],
       [ 0.74941029,  0.57787581,  0.27947467],
       [ 0.75196459,  0.58172045,  0.28127954],
       [ 0.75449255,  0.58558445,  0.28315064],
       [ 0.75699475,  0.58946742,  0.28508839],
       [ 0.75947183,  0.59336893,  0.28709315],
       [ 0.76192462,  0.59728844,  0.28916522],
       [ 0.7643535 ,  0.60122571,  0.29130448],
       [ 0.76675914,  0.60518032,  0.29351091],
       [ 0.76914223,  0.60915187,  0.29578438],
       [ 0.77150345,  0.61313994,  0.29812467],
       [ 0.7738435 ,  0.61714414,  0.30053147],
       [ 0.7761631 ,  0.62116408,  0.30300438],
       [ 0.77846296,  0.62519936,  0.30554293],
       [ 0.78074383,  0.62924959,  0.30814659],
       [ 0.78300697,  0.63331411,  0.31081484],
       [ 0.78525267,  0.63739279,  0.31354688],
       [ 0.78748163,  0.64148529,  0.31634199],
       [ 0.78969456,  0.64559126,  0.31919939],
       [ 0.79189211,  0.64971041,  0.32211829],
       [ 0.79407494,  0.65384242,  0.32509784],
       [ 0.79624371,  0.65798702,  0.32813719],
       [ 0.79839901,  0.66214394,  0.33123547],
       [ 0.80054143,  0.66631295,  0.33439178],
       [ 0.80267156,  0.6704938 ,  0.33760526],
       [ 0.80478993,  0.67468628,  0.34087501],
       [ 0.80690018,  0.67888872,  0.34419944],
       [ 0.80900011,  0.68310225,  0.34757813],
       [ 0.81109016,  0.68732671,  0.35101019],
       [ 0.81317079,  0.69156196,  0.35449478],
       [ 0.81524241,  0.69580787,  0.35803104],
       [ 0.81730543,  0.70006433,  0.36161816],
       [ 0.81936499,  0.70432905,  0.36525359],
       [ 0.82141737,  0.70860385,  0.36893785],
       [ 0.82346265,  0.71288876,  0.37267028],
       [ 0.82550113,  0.71718373,  0.37645017],
       [ 0.82753431,  0.72148816,  0.38027627],
       [ 0.82956679,  0.72580014,  0.38414583],
       [ 0.83159371,  0.7301219 ,  0.38806041],
       [ 0.8336153 ,  0.73445343,  0.39201942],
       [ 0.8356325 ,  0.73879442,  0.3960219 ],
       [ 0.8376522 ,  0.74314201,  0.40006368],
       [ 0.83966759,  0.74749923,  0.40414777],
       [ 0.84167878,  0.75186613,  0.40827373],
       [ 0.84368988,  0.75624107,  0.41243879],
       [ 0.84570279,  0.76062339,  0.41664132],
       [ 0.84771231,  0.76501536,  0.42088394],
       [ 0.84971901,  0.76941684,  0.425166  ],
       [ 0.85173279,  0.7738239 ,  0.42948094],
       [ 0.85374382,  0.77824067,  0.43383447],
       [ 0.85575213,  0.78266724,  0.43822635],
       [ 0.85776852,  0.78709938,  0.44264912],
       [ 0.85978388,  0.79154089,  0.44710845],
       [ 0.861797  ,  0.79599232,  0.45160496],
       [ 0.86382001,  0.80044904,  0.45612997],
       [ 0.86584218,  0.80491539,  0.46069064],
       [ 0.86786381,  0.80939136,  0.4652866 ],
       [ 0.86989646,  0.81387259,  0.46990922],
       [ 0.87192761,  0.81836406,  0.47456738],
       [ 0.87396293,  0.82286371,  0.47925674],
       [ 0.87600625,  0.82737022,  0.48397417],
       [ 0.8780483 ,  0.83188721,  0.48872654],
       [ 0.88010134,  0.83641023,  0.49350428],
       [ 0.88215707,  0.8409425 ,  0.49831361],
       [ 0.88421574,  0.84548406,  0.50315424],
       [ 0.88628629,  0.85003175,  0.50801893],
       [ 0.88835597,  0.85459038,  0.51291775],
       [ 0.89043869,  0.85915502,  0.51783935],
       [ 0.89252446,  0.86372943,  0.52279173],
       [ 0.89461688,  0.86831244,  0.5277719 ],
       [ 0.89671975,  0.87290284,  0.53277656],
       [ 0.89882341,  0.8775042 ,  0.53781379],
       [ 0.90094432,  0.88211085,  0.54286955],
       [ 0.90306473,  0.88672916,  0.54795894],
       [ 0.9052006 ,  0.8913537 ,  0.55306818],
       [ 0.90734007,  0.89598875,  0.55820751],
       [ 0.90949092,  0.90063174,  0.56337011],
       [ 0.91165028,  0.90528381,  0.56855847],
       [ 0.91381756,  0.90994532,  0.57377313],
       [ 0.91599761,  0.91461475,  0.57900971],
       [ 0.91818271,  0.91929486,  0.58427518],
       [ 0.92038421,  0.92398199,  0.58955926],
       [ 0.92258852,  0.92868082,  0.59487435],
       [ 0.92481218,  0.93338602,  0.6002053 ],
       [ 0.92703705,  0.9381037 ,  0.60556887],
       [ 0.92928356,  0.94282735,  0.61094613],
       [ 0.93153032,  0.94756406,  0.6163571 ],
       [ 0.93380033,  0.95230654,  0.62178019],
       [ 0.93607027,  0.95706246,  0.6272375 ]]

test_cm = LinearSegmentedColormap.from_list(__file__, cm_data)


if __name__ == "__main__":
    import matplotlib.pyplot as plt
    import numpy as np

    try:
        from pycam02ucs.cm.viscm import viscm
        viscm(test_cm)
    except ImportError:
        print("pycam02ucs not found, falling back on simple display")
        plt.imshow(np.linspace(0, 100, 256)[None, :], aspect='auto',
                   cmap=test_cm)
    plt.show()
