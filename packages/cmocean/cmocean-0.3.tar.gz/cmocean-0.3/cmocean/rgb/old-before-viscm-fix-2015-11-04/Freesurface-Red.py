
from matplotlib.colors import LinearSegmentedColormap
from numpy import nan, inf

# Used to reconstruct the colormap in pycam02ucs.cm.viscm
parameters = {'xp': [27.721366497001299, 35.696626913667984, 42.532564413667984, 36.456175524779098, 16.328137330334641, 0.0],
              'yp': [9.5377604166666572, 15.614149305555543, 19.032118055555543, 33.083767361111086, 9.9175347222222285, 0.0],
              'min_Jp': 15,
              'max_Jp': 95}

cm_data = [[  2.53141322e-01,   7.84238930e-04,   4.34171662e-02],
       [  2.58065728e-01,   1.30097083e-03,   4.47186237e-02],
       [  2.62987881e-01,   1.81975863e-03,   4.60013338e-02],
       [  2.67908222e-01,   2.33971285e-03,   4.72651655e-02],
       [  2.72827166e-01,   2.85997019e-03,   4.85099587e-02],
       [  2.77745097e-01,   3.37969485e-03,   4.97355256e-02],
       [  2.82662376e-01,   3.89807996e-03,   5.09416520e-02],
       [  2.87579339e-01,   4.41434922e-03,   5.21280988e-02],
       [  2.92496296e-01,   4.92775877e-03,   5.32946030e-02],
       [  2.97413535e-01,   5.43759923e-03,   5.44408788e-02],
       [  3.02331707e-01,   5.94238461e-03,   5.55660418e-02],
       [  3.07250814e-01,   6.44195574e-03,   5.66701236e-02],
       [  3.12170985e-01,   6.93591307e-03,   5.77529168e-02],
       [  3.17092424e-01,   7.42369799e-03,   5.88140477e-02],
       [  3.22015316e-01,   7.90480003e-03,   5.98531238e-02],
       [  3.26939824e-01,   8.37876068e-03,   6.08697350e-02],
       [  3.31866310e-01,   8.84465389e-03,   6.18631142e-02],
       [  3.36795240e-01,   9.30127923e-03,   6.28322790e-02],
       [  3.41726217e-01,   9.74951109e-03,   6.37775279e-02],
       [  3.46659322e-01,   1.01891276e-02,   6.46983772e-02],
       [  3.51594614e-01,   1.06199839e-02,   6.55943283e-02],
       [  3.56532346e-01,   1.10414601e-02,   6.64645242e-02],
       [  3.61473191e-01,   1.14518171e-02,   6.73073633e-02],
       [  3.66416347e-01,   1.18531832e-02,   6.81235524e-02],
       [  3.71361778e-01,   1.22457751e-02,   6.89125288e-02],
       [  3.76309436e-01,   1.26298848e-02,   6.96736934e-02],
       [  3.81260617e-01,   1.30020897e-02,   7.04041340e-02],
       [  3.86213903e-01,   1.33664980e-02,   7.11053752e-02],
       [  3.91169140e-01,   1.37238455e-02,   7.17768000e-02],
       [  3.96126921e-01,   1.40727622e-02,   7.24164315e-02],
       [  4.01087300e-01,   1.44134060e-02,   7.30230896e-02],
       [  4.06049081e-01,   1.47497495e-02,   7.35977315e-02],
       [  4.11012699e-01,   1.50810260e-02,   7.41383559e-02],
       [  4.15978528e-01,   1.54066343e-02,   7.46429021e-02],
       [  4.20944832e-01,   1.57325909e-02,   7.51130877e-02],
       [  4.25912730e-01,   1.60561861e-02,   7.55452340e-02],
       [  4.30881197e-01,   1.63814859e-02,   7.59395039e-02],
       [  4.35849271e-01,   1.67125896e-02,   7.62958744e-02],
       [  4.40818173e-01,   1.70466302e-02,   7.66098250e-02],
       [  4.45784879e-01,   1.73948098e-02,   7.68851416e-02],
       [  4.50751900e-01,   1.77501922e-02,   7.71141276e-02],
       [  4.55715151e-01,   1.81281103e-02,   7.73025312e-02],
       [  4.60677202e-01,   1.85216412e-02,   7.74417434e-02],
       [  4.65634166e-01,   1.89461830e-02,   7.75368102e-02],
       [  4.70587141e-01,   1.94002526e-02,   7.75814282e-02],
       [  4.75533935e-01,   1.98941507e-02,   7.75762695e-02],
       [  4.80472527e-01,   2.04380685e-02,   7.75213427e-02],
       [  4.85403626e-01,   2.10328205e-02,   7.74092545e-02],
       [  4.90323554e-01,   2.16955204e-02,   7.72428195e-02],
       [  4.95230267e-01,   2.24380789e-02,   7.70201495e-02],
       [  5.00121508e-01,   2.32738892e-02,   7.67389191e-02],
       [  5.04994763e-01,   2.42181258e-02,   7.63962077e-02],
       [  5.09846693e-01,   2.52900328e-02,   7.59898830e-02],
       [  5.14672616e-01,   2.65151429e-02,   7.55202314e-02],
       [  5.19467531e-01,   2.79216883e-02,   7.49864745e-02],
       [  5.24226040e-01,   2.95412535e-02,   7.43859945e-02],
       [  5.28940235e-01,   3.14171657e-02,   7.37215203e-02],
       [  5.33600584e-01,   3.36016520e-02,   7.29979791e-02],
       [  5.38195923e-01,   3.61565098e-02,   7.22215518e-02],
       [  5.42713059e-01,   3.91555604e-02,   7.13992051e-02],
       [  5.47134095e-01,   4.26222548e-02,   7.05546592e-02],
       [  5.51439015e-01,   4.65037770e-02,   6.97164673e-02],
       [  5.55605047e-01,   5.08482489e-02,   6.89261958e-02],
       [  5.59608352e-01,   5.56801959e-02,   6.82475633e-02],
       [  5.63428709e-01,   6.09950184e-02,   6.77582661e-02],
       [  5.67054729e-01,   6.67479252e-02,   6.75423646e-02],
       [  5.70488325e-01,   7.28525983e-02,   6.76741394e-02],
       [  5.73744572e-01,   7.91977545e-02,   6.81999911e-02],
       [  5.76847678e-01,   8.56696434e-02,   6.91330717e-02],
       [  5.79824382e-01,   9.21734286e-02,   7.04569822e-02],
       [  5.82697239e-01,   9.86465834e-02,   7.21366449e-02],
       [  5.85489163e-01,   1.05038210e-01,   7.41328109e-02],
       [  5.88212985e-01,   1.11331846e-01,   7.64036726e-02],
       [  5.90881768e-01,   1.17512879e-01,   7.89123418e-02],
       [  5.93505298e-01,   1.23576093e-01,   8.16258524e-02],
       [  5.96090575e-01,   1.29522617e-01,   8.45159270e-02],
       [  5.98642361e-01,   1.35357561e-01,   8.75590007e-02],
       [  6.01163693e-01,   1.41088308e-01,   9.07358336e-02],
       [  6.03656329e-01,   1.46723329e-01,   9.40309421e-02],
       [  6.06126284e-01,   1.52262026e-01,   9.74279887e-02],
       [  6.08573273e-01,   1.57714774e-01,   1.00916799e-01],
       [  6.10998000e-01,   1.63088824e-01,   1.04488311e-01],
       [  6.13403984e-01,   1.68385827e-01,   1.08132281e-01],
       [  6.15790936e-01,   1.73613243e-01,   1.11842746e-01],
       [  6.18157123e-01,   1.78779866e-01,   1.15616202e-01],
       [  6.20510827e-01,   1.83878386e-01,   1.19440163e-01],
       [  6.22845519e-01,   1.88923972e-01,   1.23317110e-01],
       [  6.25162388e-01,   1.93919170e-01,   1.27242681e-01],
       [  6.27465164e-01,   1.98862707e-01,   1.31210172e-01],
       [  6.29754378e-01,   2.03757770e-01,   1.35216461e-01],
       [  6.32027903e-01,   2.08610777e-01,   1.39261652e-01],
       [  6.34286420e-01,   2.13423898e-01,   1.43343170e-01],
       [  6.36530522e-01,   2.18199215e-01,   1.47458740e-01],
       [  6.38760725e-01,   2.22938723e-01,   1.51606362e-01],
       [  6.40977479e-01,   2.27644324e-01,   1.55784269e-01],
       [  6.43181172e-01,   2.32317836e-01,   1.59990907e-01],
       [  6.45372143e-01,   2.36960986e-01,   1.64224907e-01],
       [  6.47550684e-01,   2.41575422e-01,   1.68485062e-01],
       [  6.49717050e-01,   2.46162704e-01,   1.72770310e-01],
       [  6.51871461e-01,   2.50724319e-01,   1.77079714e-01],
       [  6.54014108e-01,   2.55261674e-01,   1.81412447e-01],
       [  6.56145157e-01,   2.59776105e-01,   1.85767780e-01],
       [  6.58264753e-01,   2.64268878e-01,   1.90145070e-01],
       [  6.60373025e-01,   2.68741191e-01,   1.94543746e-01],
       [  6.62470085e-01,   2.73194180e-01,   1.98963302e-01],
       [  6.64556034e-01,   2.77628919e-01,   2.03403289e-01],
       [  6.66630965e-01,   2.82046424e-01,   2.07863304e-01],
       [  6.68694962e-01,   2.86447658e-01,   2.12342988e-01],
       [  6.70748105e-01,   2.90833529e-01,   2.16842018e-01],
       [  6.72792623e-01,   2.95202860e-01,   2.21357499e-01],
       [  6.74828907e-01,   2.99556259e-01,   2.25888772e-01],
       [  6.76854800e-01,   3.03896635e-01,   2.30438279e-01],
       [  6.78870357e-01,   3.08224735e-01,   2.35005820e-01],
       [  6.80875633e-01,   3.12541263e-01,   2.39591207e-01],
       [  6.82870686e-01,   3.16846886e-01,   2.44194265e-01],
       [  6.84861206e-01,   3.21137345e-01,   2.48808003e-01],
       [  6.86842097e-01,   3.25417851e-01,   2.53438520e-01],
       [  6.88813106e-01,   3.29689247e-01,   2.58086054e-01],
       [  6.90774296e-01,   3.33952073e-01,   2.62750475e-01],
       [  6.92729006e-01,   3.38204142e-01,   2.67427686e-01],
       [  6.94677677e-01,   3.42445738e-01,   2.72117118e-01],
       [  6.96616829e-01,   3.46680283e-01,   2.76822961e-01],
       [  6.98546536e-01,   3.50908212e-01,   2.81545101e-01],
       [  7.00471020e-01,   3.55126691e-01,   2.86278413e-01],
       [  7.02389645e-01,   3.59336785e-01,   2.91023660e-01],
       [  7.04299118e-01,   3.63541545e-01,   2.95784829e-01],
       [  7.06199535e-01,   3.67741320e-01,   3.00561800e-01],
       [  7.08098731e-01,   3.71930654e-01,   3.05345123e-01],
       [  7.09989365e-01,   3.76115564e-01,   3.10143680e-01],
       [  7.11871249e-01,   3.80296570e-01,   3.14957708e-01],
       [  7.13749686e-01,   3.84470201e-01,   3.19780845e-01],
       [  7.15622807e-01,   3.88638268e-01,   3.24615371e-01],
       [  7.17487498e-01,   3.92803387e-01,   3.29465060e-01],
       [  7.19347806e-01,   3.96963055e-01,   3.34325082e-01],
       [  7.21204700e-01,   4.01117003e-01,   3.39194320e-01],
       [  7.23053504e-01,   4.05268851e-01,   3.44078415e-01],
       [  7.24898149e-01,   4.09416229e-01,   3.48972703e-01],
       [  7.26740084e-01,   4.13558533e-01,   3.53875504e-01],
       [  7.28574296e-01,   4.17699482e-01,   3.58792850e-01],
       [  7.30405596e-01,   4.21836186e-01,   3.63719054e-01],
       [  7.32233843e-01,   4.25969093e-01,   3.68654344e-01],
       [  7.34054766e-01,   4.30101303e-01,   3.73603845e-01],
       [  7.35874903e-01,   4.34228895e-01,   3.78559861e-01],
       [  7.37690750e-01,   4.38354450e-01,   3.83526605e-01],
       [  7.39499710e-01,   4.42479884e-01,   3.88507198e-01],
       [  7.41310742e-01,   4.46599881e-01,   3.93491137e-01],
       [  7.43115508e-01,   4.50719945e-01,   3.98488314e-01],
       [  7.44916518e-01,   4.54838782e-01,   4.03495832e-01],
       [  7.46717739e-01,   4.58954269e-01,   4.08509110e-01],
       [  7.48512789e-01,   4.63070541e-01,   4.13535688e-01],
       [  7.50308128e-01,   4.67183989e-01,   4.18568082e-01],
       [  7.52100507e-01,   4.71296828e-01,   4.23610158e-01],
       [  7.53888372e-01,   4.75410214e-01,   4.28663787e-01],
       [  7.55678706e-01,   4.79520341e-01,   4.33720932e-01],
       [  7.57463674e-01,   4.83632008e-01,   4.38790755e-01],
       [  7.59249043e-01,   4.87742143e-01,   4.43866648e-01],
       [  7.61032850e-01,   4.91852124e-01,   4.48950959e-01],
       [  7.62813151e-01,   4.95963275e-01,   4.54045995e-01],
       [  7.64596412e-01,   5.00072233e-01,   4.59144396e-01],
       [  7.66375209e-01,   5.04183354e-01,   4.64254764e-01],
       [  7.68155964e-01,   5.08293337e-01,   4.69369812e-01],
       [  7.69935123e-01,   5.12404362e-01,   4.74493685e-01],
       [  7.71713091e-01,   5.16516426e-01,   4.79625988e-01],
       [  7.73493224e-01,   5.20627964e-01,   4.84762985e-01],
       [  7.75269900e-01,   5.24742185e-01,   4.89911128e-01],
       [  7.77051076e-01,   5.28855117e-01,   4.95061485e-01],
       [  7.78829668e-01,   5.32970695e-01,   5.00222141e-01],
       [  7.80610230e-01,   5.37086761e-01,   5.05388029e-01],
       [  7.82391354e-01,   5.41204265e-01,   5.10560815e-01],
       [  7.84172223e-01,   5.45323828e-01,   5.15741484e-01],
       [  7.85956498e-01,   5.49443810e-01,   5.20926017e-01],
       [  7.87738802e-01,   5.53567125e-01,   5.26120485e-01],
       [  7.89526628e-01,   5.57690237e-01,   5.31316624e-01],
       [  7.91313077e-01,   5.61816782e-01,   5.36522169e-01],
       [  7.93103266e-01,   5.65944439e-01,   5.41731520e-01],
       [  7.94894492e-01,   5.70074735e-01,   5.46947737e-01],
       [  7.96687931e-01,   5.74207299e-01,   5.52169592e-01],
       [  7.98484570e-01,   5.78341856e-01,   5.57396068e-01],
       [  8.00282139e-01,   5.82479691e-01,   5.62629721e-01],
       [  8.02084834e-01,   5.86619009e-01,   5.67866033e-01],
       [  8.03887670e-01,   5.90762358e-01,   5.73110499e-01],
       [  8.05696809e-01,   5.94907048e-01,   5.78356489e-01],
       [  8.07506786e-01,   5.99055819e-01,   5.83609990e-01],
       [  8.09322027e-01,   6.03206817e-01,   5.88866277e-01],
       [  8.11139815e-01,   6.07361485e-01,   5.94128340e-01],
       [  8.12962033e-01,   6.11519152e-01,   5.99394210e-01],
       [  8.14788313e-01,   6.15680180e-01,   6.04664340e-01],
       [  8.16618384e-01,   6.19844879e-01,   6.09939071e-01],
       [  8.18453852e-01,   6.24012722e-01,   6.15216749e-01],
       [  8.20292662e-01,   6.28184811e-01,   6.20499601e-01],
       [  8.22138029e-01,   6.32359915e-01,   6.25784280e-01],
       [  8.23986509e-01,   6.36539735e-01,   6.31074458e-01],
       [  8.25842470e-01,   6.40722552e-01,   6.36365597e-01],
       [  8.27702112e-01,   6.44910205e-01,   6.41661717e-01],
       [  8.29568841e-01,   6.49101411e-01,   6.46959306e-01],
       [  8.31440420e-01,   6.53297316e-01,   6.52260727e-01],
       [  8.33318854e-01,   6.57497252e-01,   6.57563944e-01],
       [  8.35203175e-01,   6.61701817e-01,   6.62869988e-01],
       [  8.37094279e-01,   6.65910819e-01,   6.68177975e-01],
       [  8.38992184e-01,   6.70124436e-01,   6.73487919e-01],
       [  8.40896958e-01,   6.74342828e-01,   6.78799779e-01],
       [  8.42809330e-01,   6.78565878e-01,   6.84112850e-01],
       [  8.44728817e-01,   6.82793971e-01,   6.89427646e-01],
       [  8.46656590e-01,   6.87026814e-01,   6.94743022e-01],
       [  8.48591887e-01,   6.91264903e-01,   7.00059768e-01],
       [  8.50536052e-01,   6.95507880e-01,   7.05376573e-01],
       [  8.52488361e-01,   6.99756224e-01,   7.10694189e-01],
       [  8.54449936e-01,   7.04009669e-01,   7.16011538e-01],
       [  8.56420458e-01,   7.08268531e-01,   7.21328970e-01],
       [  8.58400615e-01,   7.12532721e-01,   7.26645846e-01],
       [  8.60390540e-01,   7.16802374e-01,   7.31962082e-01],
       [  8.62390644e-01,   7.21077514e-01,   7.37277323e-01],
       [  8.64401261e-01,   7.25358196e-01,   7.42591301e-01],
       [  8.66422788e-01,   7.29644451e-01,   7.47903698e-01],
       [  8.68455502e-01,   7.33936357e-01,   7.53214315e-01],
       [  8.70500049e-01,   7.38233851e-01,   7.58522621e-01],
       [  8.72556394e-01,   7.42537129e-01,   7.63828739e-01],
       [  8.74625705e-01,   7.46845930e-01,   7.69131681e-01],
       [  8.76707360e-01,   7.51160673e-01,   7.74432146e-01],
       [  8.78803335e-01,   7.55480791e-01,   7.79728446e-01],
       [  8.80912141e-01,   7.59807028e-01,   7.85022108e-01],
       [  8.83036709e-01,   7.64138460e-01,   7.90310637e-01],
       [  8.85174825e-01,   7.68476096e-01,   7.95596253e-01],
       [  8.87329828e-01,   7.72818864e-01,   8.00876173e-01],
       [  8.89499869e-01,   7.77167629e-01,   8.06152333e-01],
       [  8.91687592e-01,   7.81521580e-01,   8.11422672e-01],
       [  8.93892112e-01,   7.85881215e-01,   8.16688324e-01],
       [  8.96115025e-01,   7.90246111e-01,   8.21948261e-01],
       [  8.98356767e-01,   7.94616273e-01,   8.27202536e-01],
       [  9.00617518e-01,   7.98991794e-01,   8.32451469e-01],
       [  9.02899403e-01,   8.03372054e-01,   8.37693748e-01],
       [  9.05200791e-01,   8.07757798e-01,   8.42931366e-01],
       [  9.07525885e-01,   8.12147648e-01,   8.48161359e-01],
       [  9.09870825e-01,   8.16543142e-01,   8.53387725e-01],
       [  9.12241600e-01,   8.20942257e-01,   8.58606138e-01],
       [  9.14633763e-01,   8.25346720e-01,   8.63821190e-01],
       [  9.17052677e-01,   8.29754738e-01,   8.69029251e-01],
       [  9.19495767e-01,   8.34167347e-01,   8.74233441e-01],
       [  9.21965726e-01,   8.38583703e-01,   8.79432524e-01],
       [  9.24462840e-01,   8.43003812e-01,   8.84627344e-01],
       [  9.26986592e-01,   8.47427956e-01,   8.89819470e-01],
       [  9.29540621e-01,   8.51854954e-01,   8.95007067e-01],
       [  9.32120644e-01,   8.56286391e-01,   9.00194944e-01],
       [  9.34733325e-01,   8.60720030e-01,   9.05378838e-01],
       [  9.37372539e-01,   8.65158077e-01,   9.10565183e-01],
       [  9.40044475e-01,   8.69598467e-01,   9.15750161e-01],
       [  9.42746001e-01,   8.74042352e-01,   9.20937764e-01],
       [  9.45478478e-01,   8.78489334e-01,   9.26128233e-01],
       [  9.48243614e-01,   8.82938905e-01,   9.31321487e-01],
       [  9.51037293e-01,   8.87392522e-01,   9.36522421e-01],
       [  9.53865665e-01,   8.91848188e-01,   9.41727068e-01],
       [  9.56721547e-01,   8.96308373e-01,   9.46942992e-01],
       [  9.59610781e-01,   9.00771205e-01,   9.52166337e-01],
       [  9.62530501e-01,   9.05237713e-01,   9.57400828e-01],
       [  9.65479535e-01,   9.09708354e-01,   9.62648691e-01],
       [  9.68462096e-01,   9.14181857e-01,   9.67907091e-01]]

test_cm = LinearSegmentedColormap.from_list(__file__, cm_data)


if __name__ == "__main__":
    import matplotlib.pyplot as plt
    import numpy as np

    try:
        from pycam02ucs.cm.viscm import viscm
        viscm(test_cm)
    except ImportError:
        print("pycam02ucs not found, falling back on simple display")
        plt.imshow(np.linspace(0, 100, 256)[None, :], aspect='auto',
                   cmap=test_cm)
    plt.show()
