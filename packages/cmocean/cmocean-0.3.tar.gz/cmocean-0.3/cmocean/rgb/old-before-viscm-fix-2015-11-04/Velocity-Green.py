
from matplotlib.colors import LinearSegmentedColormap
from numpy import nan, inf

# Used to reconstruct the colormap in pycam02ucs.cm.viscm
parameters = {'xp': [-9.21329491069011, -24.89506505028251, -30.264905310379675, -33.567972539269306, -0.16121776687575107, -1.7673117463177732, -2.6458062484333098],
              'yp': [13.043267365153298, 9.994493392070467, 19.494567326348488, 36.33443465491922, 43.080029368575595, 24.12812041116004, 13.495663663466786],
              'min_Jp': 15.0,
              'max_Jp': 98.6544342508}

cm_data = [[ 0.08929866,  0.13741248,  0.03452094],
       [ 0.09039346,  0.14107585,  0.03757233],
       [ 0.09145209,  0.14473231,  0.04073046],
       [ 0.09247218,  0.14838301,  0.04386432],
       [ 0.09344222,  0.15203124,  0.04696397],
       [ 0.0943747 ,  0.15567439,  0.05002795],
       [ 0.09526776,  0.15931335,  0.05305718],
       [ 0.09610902,  0.16295141,  0.05605343],
       [ 0.09691076,  0.16658603,  0.05901538],
       [ 0.09767216,  0.17021777,  0.06194338],
       [ 0.09838144,  0.17384959,  0.06483826],
       [ 0.09904643,  0.17747996,  0.06769928],
       [ 0.09966853,  0.18110886,  0.07052628],
       [ 0.10024335,  0.18473749,  0.07331924],
       [ 0.10076452,  0.18836738,  0.07607792],
       [ 0.10123995,  0.19199702,  0.07880181],
       [ 0.10166852,  0.19562683,  0.08149064],
       [ 0.1020456 ,  0.19925791,  0.08414393],
       [ 0.10236642,  0.20289134,  0.08676096],
       [ 0.10263733,  0.2065259 ,  0.08934145],
       [ 0.10285719,  0.21016194,  0.09188486],
       [ 0.10302487,  0.21379974,  0.09439061],
       [ 0.10313243,  0.21744088,  0.09685745],
       [ 0.10318357,  0.22108466,  0.09928495],
       [ 0.1031796 ,  0.22473085,  0.10167259],
       [ 0.10311948,  0.22837965,  0.10401961],
       [ 0.1030022 ,  0.23203125,  0.10632518],
       [ 0.10282674,  0.2356858 ,  0.10858844],
       [ 0.10258561,  0.23934458,  0.11080745],
       [ 0.1022851 ,  0.24300643,  0.11298227],
       [ 0.10192451,  0.2466714 ,  0.11511192],
       [ 0.10150322,  0.25033956,  0.11719541],
       [ 0.10102074,  0.2540109 ,  0.11923172],
       [ 0.10047669,  0.25768543,  0.12121978],
       [ 0.09987088,  0.26136308,  0.12315853],
       [ 0.09920329,  0.2650438 ,  0.12504685],
       [ 0.09847409,  0.26872747,  0.12688363],
       [ 0.09768249,  0.27241413,  0.12866747],
       [ 0.09682931,  0.27610358,  0.13039722],
       [ 0.09591702,  0.2797954 ,  0.13207209],
       [ 0.09494689,  0.28348935,  0.13369096],
       [ 0.09392056,  0.28718517,  0.13525269],
       [ 0.09284007,  0.29088256,  0.13675615],
       [ 0.09170791,  0.29458121,  0.13820024],
       [ 0.09052708,  0.29828076,  0.13958387],
       [ 0.08930113,  0.30198082,  0.14090596],
       [ 0.08803424,  0.30568097,  0.14216547],
       [ 0.08673125,  0.30938076,  0.1433614 ],
       [ 0.08539779,  0.31307972,  0.14449279],
       [ 0.08404029,  0.31677735,  0.1455587 ],
       [ 0.08266475,  0.32047326,  0.14655782],
       [ 0.0812798 ,  0.32416686,  0.1474894 ],
       [ 0.07989567,  0.32785746,  0.14835296],
       [ 0.07852292,  0.33154447,  0.1491478 ],
       [ 0.07717325,  0.33522725,  0.14987333],
       [ 0.07585964,  0.33890517,  0.15052899],
       [ 0.07459632,  0.34257755,  0.15111432],
       [ 0.07339878,  0.34624373,  0.15162894],
       [ 0.07228374,  0.34990303,  0.15207256],
       [ 0.07126906,  0.35355475,  0.15244498],
       [ 0.07037206,  0.35719833,  0.15274536],
       [ 0.06961261,  0.36083306,  0.15297371],
       [ 0.0690125 ,  0.36445806,  0.15313083],
       [ 0.06859209,  0.36807262,  0.15321694],
       [ 0.06837145,  0.37167606,  0.15323235],
       [ 0.06836991,  0.37526766,  0.15317747],
       [ 0.06860543,  0.37884676,  0.15305273],
       [ 0.06909273,  0.38241284,  0.15285758],
       [ 0.06984804,  0.38596504,  0.15259413],
       [ 0.07088277,  0.38950271,  0.15226321],
       [ 0.07220532,  0.39302524,  0.1518658 ],
       [ 0.07382096,  0.39653202,  0.15140296],
       [ 0.07573131,  0.40002255,  0.15087526],
       [ 0.07793571,  0.40349623,  0.1502843 ],
       [ 0.08043054,  0.40695251,  0.14963189],
       [ 0.08320917,  0.4103909 ,  0.14891948],
       [ 0.08626283,  0.41381096,  0.14814866],
       [ 0.08958087,  0.41721228,  0.14732085],
       [ 0.09315147,  0.42059446,  0.14643799],
       [ 0.09696175,  0.42395715,  0.14550216],
       [ 0.10099822,  0.42730005,  0.14451525],
       [ 0.10524711,  0.43062289,  0.14347926],
       [ 0.10969467,  0.43392543,  0.14239642],
       [ 0.11432733,  0.43720749,  0.14126897],
       [ 0.11913194,  0.44046892,  0.14009906],
       [ 0.12409587,  0.4437096 ,  0.13888896],
       [ 0.12920708,  0.44692946,  0.13764101],
       [ 0.13445392,  0.45012846,  0.13635819],
       [ 0.13982567,  0.45330661,  0.1350428 ],
       [ 0.14531234,  0.45646394,  0.1336971 ],
       [ 0.15090455,  0.45960051,  0.13232366],
       [ 0.15659352,  0.46271642,  0.13092511],
       [ 0.16237072,  0.46581182,  0.12950481],
       [ 0.16822847,  0.46888689,  0.1280656 ],
       [ 0.17416015,  0.47194178,  0.12660964],
       [ 0.18015925,  0.47497671,  0.1251398 ],
       [ 0.18621978,  0.47799191,  0.12365901],
       [ 0.19233618,  0.48098763,  0.12217026],
       [ 0.19850229,  0.48396427,  0.12067812],
       [ 0.2047142 ,  0.48692203,  0.11918449],
       [ 0.21096763,  0.48986122,  0.11769242],
       [ 0.21725854,  0.49278218,  0.11620524],
       [ 0.22358318,  0.49568523,  0.11472636],
       [ 0.22993809,  0.49857075,  0.11325929],
       [ 0.23631935,  0.50143919,  0.1118086 ],
       [ 0.24272418,  0.50429092,  0.11037775],
       [ 0.24915036,  0.50712625,  0.10896989],
       [ 0.25559537,  0.50994557,  0.10758896],
       [ 0.26205688,  0.5127493 ,  0.10623903],
       [ 0.26853272,  0.51553782,  0.10492432],
       [ 0.27502088,  0.51831156,  0.10364915],
       [ 0.28151947,  0.52107093,  0.10241799],
       [ 0.28802577,  0.52381651,  0.10123669],
       [ 0.29453925,  0.52654855,  0.10010856],
       [ 0.30105844,  0.52926747,  0.09903841],
       [ 0.30758197,  0.5319737 ,  0.09803112],
       [ 0.31410855,  0.53466765,  0.09709167],
       [ 0.320637  ,  0.53734975,  0.09622511],
       [ 0.32716622,  0.54002041,  0.09543652],
       [ 0.33369516,  0.54268007,  0.09473101],
       [ 0.34022286,  0.54532913,  0.0941137 ],
       [ 0.34674826,  0.54796807,  0.09358983],
       [ 0.35327016,  0.55059735,  0.09316476],
       [ 0.35978833,  0.55321731,  0.09284276],
       [ 0.36630199,  0.55582835,  0.09262858],
       [ 0.37281043,  0.5584309 ,  0.09252679],
       [ 0.37931296,  0.56102538,  0.09254174],
       [ 0.38580894,  0.56361221,  0.09267752],
       [ 0.39229773,  0.5661918 ,  0.09293791],
       [ 0.39877874,  0.56876459,  0.09332639],
       [ 0.40525137,  0.57133098,  0.09384605],
       [ 0.41171505,  0.57389141,  0.09449961],
       [ 0.41816925,  0.5764463 ,  0.09528941],
       [ 0.42461339,  0.57899607,  0.09621735],
       [ 0.43104696,  0.58154117,  0.09728493],
       [ 0.43746942,  0.58408201,  0.09849323],
       [ 0.44388002,  0.5866191 ,  0.09984306],
       [ 0.45027849,  0.5891528 ,  0.10133451],
       [ 0.45666427,  0.59168356,  0.10296752],
       [ 0.46303683,  0.59421184,  0.10474163],
       [ 0.46939562,  0.59673808,  0.1066561 ],
       [ 0.47574008,  0.59926275,  0.10870988],
       [ 0.48206964,  0.60178632,  0.11090168],
       [ 0.48838372,  0.60430925,  0.11322999],
       [ 0.49468173,  0.60683203,  0.11569311],
       [ 0.50096305,  0.60935514,  0.11828917],
       [ 0.50722706,  0.61187909,  0.12101622],
       [ 0.51347311,  0.61440438,  0.12387219],
       [ 0.51970054,  0.61693152,  0.12685496],
       [ 0.52590868,  0.61946103,  0.12996237],
       [ 0.5320968 ,  0.62199346,  0.13319226],
       [ 0.5382642 ,  0.62452934,  0.13654247],
       [ 0.54441013,  0.62706923,  0.14001084],
       [ 0.55053381,  0.6296137 ,  0.14359527],
       [ 0.55663446,  0.63216332,  0.14729372],
       [ 0.56271127,  0.63471868,  0.15110415],
       [ 0.56876342,  0.63728036,  0.15502465],
       [ 0.57479005,  0.639849  ,  0.15905332],
       [ 0.58079027,  0.64242519,  0.16318834],
       [ 0.5867632 ,  0.64500959,  0.16742796],
       [ 0.59270792,  0.64760282,  0.17177048],
       [ 0.5986235 ,  0.65020554,  0.17621427],
       [ 0.60450901,  0.65281842,  0.18075775],
       [ 0.61036348,  0.65544211,  0.18539937],
       [ 0.61618596,  0.6580773 ,  0.19013766],
       [ 0.62197547,  0.66072466,  0.19497116],
       [ 0.62773105,  0.6633849 ,  0.19989845],
       [ 0.63345171,  0.6660587 ,  0.20491811],
       [ 0.63913648,  0.66874675,  0.21002877],
       [ 0.64478441,  0.67144975,  0.21522904],
       [ 0.65039454,  0.67416841,  0.22051754],
       [ 0.65596593,  0.6769034 ,  0.2258929 ],
       [ 0.66149767,  0.67965543,  0.2313537 ],
       [ 0.66698887,  0.68242517,  0.23689854],
       [ 0.67243866,  0.6852133 ,  0.24252598],
       [ 0.67784623,  0.68802049,  0.24823454],
       [ 0.68321078,  0.69084737,  0.25402271],
       [ 0.68853151,  0.69369462,  0.25988887],
       [ 0.69380774,  0.69656284,  0.26583144],
       [ 0.69903887,  0.69945262,  0.27184884],
       [ 0.70422433,  0.70236454,  0.27793943],
       [ 0.70936359,  0.70529913,  0.28410149],
       [ 0.7144562 ,  0.70825693,  0.29033327],
       [ 0.71950179,  0.71123842,  0.296633  ],
       [ 0.72450003,  0.71424409,  0.30299885],
       [ 0.72945071,  0.71727435,  0.30942896],
       [ 0.73435365,  0.7203296 ,  0.31592144],
       [ 0.73920877,  0.72341023,  0.32247439],
       [ 0.74401607,  0.72651655,  0.32908587],
       [ 0.74877562,  0.72964887,  0.33575392],
       [ 0.75348757,  0.73280745,  0.34247659],
       [ 0.75815215,  0.73599251,  0.3492519 ],
       [ 0.76276965,  0.73920424,  0.35607789],
       [ 0.76734046,  0.74244281,  0.3629526 ],
       [ 0.77186501,  0.74570832,  0.36987408],
       [ 0.77634382,  0.74900087,  0.37684039],
       [ 0.78077747,  0.75232052,  0.38384964],
       [ 0.78516658,  0.75566728,  0.39089994],
       [ 0.78951187,  0.75904116,  0.39798944],
       [ 0.79381406,  0.76244212,  0.40511633],
       [ 0.79807396,  0.76587009,  0.41227884],
       [ 0.80229242,  0.76932499,  0.41947526],
       [ 0.8064703 ,  0.77280672,  0.4267039 ],
       [ 0.81060852,  0.77631517,  0.43396275],
       [ 0.81470799,  0.77985024,  0.44124968],
       [ 0.81876978,  0.78341168,  0.44856397],
       [ 0.82279489,  0.78699931,  0.45590415],
       [ 0.82678434,  0.79061292,  0.46326881],
       [ 0.83073919,  0.79425232,  0.4706566 ],
       [ 0.8346605 ,  0.79791726,  0.47806623],
       [ 0.83854934,  0.80160753,  0.48549646],
       [ 0.8424068 ,  0.80532287,  0.49294609],
       [ 0.84623396,  0.80906305,  0.50041398],
       [ 0.85003193,  0.8128278 ,  0.50789905],
       [ 0.85380179,  0.81661687,  0.51540025],
       [ 0.85754467,  0.82043001,  0.52291626],
       [ 0.86126181,  0.82426701,  0.53044447],
       [ 0.86495418,  0.82812751,  0.53798601],
       [ 0.86862288,  0.83201126,  0.54554005],
       [ 0.87226897,  0.83591799,  0.55310577],
       [ 0.87589356,  0.83984742,  0.56068241],
       [ 0.87949772,  0.8437993 ,  0.56826923],
       [ 0.88308253,  0.84777336,  0.57586551],
       [ 0.88664905,  0.85176934,  0.58347056],
       [ 0.89019862,  0.85578698,  0.59108197],
       [ 0.89373205,  0.859826  ,  0.59870106],
       [ 0.89725035,  0.86388615,  0.60632739],
       [ 0.90075458,  0.86796716,  0.61396042],
       [ 0.90424579,  0.87206878,  0.62159959],
       [ 0.90772503,  0.87619077,  0.6292444 ],
       [ 0.91119333,  0.88033286,  0.63689434],
       [ 0.91465184,  0.88449481,  0.64454839],
       [ 0.91810144,  0.88867638,  0.65220704],
       [ 0.92154313,  0.89287731,  0.65986999],
       [ 0.92497796,  0.89709736,  0.66753684],
       [ 0.92840696,  0.90133629,  0.67520719],
       [ 0.9318312 ,  0.90559385,  0.68288065],
       [ 0.93525171,  0.90986979,  0.69055692],
       [ 0.93866928,  0.91416389,  0.69823686],
       [ 0.94208511,  0.91847589,  0.70591957],
       [ 0.94550027,  0.92280554,  0.71360475],
       [ 0.94891587,  0.92715257,  0.72129212],
       [ 0.95233301,  0.93151674,  0.72898141],
       [ 0.95575284,  0.93589776,  0.7366724 ],
       [ 0.95917649,  0.94029537,  0.74436486],
       [ 0.96260442,  0.94470935,  0.75206147],
       [ 0.9660383 ,  0.94913935,  0.75976021],
       [ 0.96947946,  0.95358507,  0.76746058],
       [ 0.97292921,  0.95804618,  0.77516249],
       [ 0.97638886,  0.96252232,  0.78286584],
       [ 0.97985984,  0.96701315,  0.79057059],
       [ 0.98334361,  0.97151826,  0.79827674],
       [ 0.98684171,  0.97603722,  0.80598433],
       [ 0.99035581,  0.98056956,  0.81369343],
       [ 0.99388767,  0.98511479,  0.82140416],
       [ 0.99743922,  0.98967231,  0.82911667]]

test_cm = LinearSegmentedColormap.from_list(__file__, cm_data)


if __name__ == "__main__":
    import matplotlib.pyplot as plt
    import numpy as np

    try:
        from pycam02ucs.cm.viscm import viscm
        viscm(test_cm)
    except ImportError:
        print("pycam02ucs not found, falling back on simple display")
        plt.imshow(np.linspace(0, 100, 256)[None, :], aspect='auto',
                   cmap=test_cm)
    plt.show()
