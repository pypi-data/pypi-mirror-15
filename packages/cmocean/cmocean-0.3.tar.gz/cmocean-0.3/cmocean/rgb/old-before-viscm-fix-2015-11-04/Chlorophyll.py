
from matplotlib.colors import LinearSegmentedColormap
from numpy import nan, inf

# Used to reconstruct the colormap in pycam02ucs.cm.viscm
parameters = {'xp': [-8.571217627213656, -26.782317726321679, -32.852684426024354, -37.47772572103591, -16.954104974422108, -11.172803355657663],
              'yp': [5.7358771060455922, 4.8686818632309325, 22.790716881400755, 28.5720185001652, 18.16567558638917, 8.9155929963660583],
              'min_JK': 15.0,
              'max_JK': 95.0}

cm_data = [[ 0.08316696,  0.13577548,  0.08998468],
       [ 0.0846448 ,  0.13913968,  0.09281863],
       [ 0.08609771,  0.14249932,  0.09563262],
       [ 0.08751635,  0.14585712,  0.09842692],
       [ 0.0889066 ,  0.14921196,  0.10120176],
       [ 0.0902661 ,  0.15256474,  0.10395731],
       [ 0.09159339,  0.15591614,  0.10669367],
       [ 0.09289382,  0.15926516,  0.10941119],
       [ 0.09415783,  0.16261437,  0.11210959],
       [ 0.09539592,  0.16596151,  0.1147895 ],
       [ 0.09659969,  0.16930883,  0.11745055],
       [ 0.09777396,  0.17265543,  0.12009311],
       [ 0.09891872,  0.17600153,  0.1227173 ],
       [ 0.10002889,  0.17934852,  0.12532274],
       [ 0.10111241,  0.18269476,  0.12791018],
       [ 0.10216049,  0.18604245,  0.13047884],
       [ 0.10317941,  0.18939033,  0.13302936],
       [ 0.10416855,  0.19273873,  0.13556172],
       [ 0.10512261,  0.19608897,  0.13807531],
       [ 0.10604934,  0.19943948,  0.14057107],
       [ 0.10694182,  0.20279193,  0.14304812],
       [ 0.10780325,  0.20614575,  0.14550686],
       [ 0.10863686,  0.20950037,  0.14794774],
       [ 0.10943272,  0.21285804,  0.15036932],
       [ 0.11020063,  0.21621677,  0.15277298],
       [ 0.1109376 ,  0.2195773 ,  0.15515827],
       [ 0.11163953,  0.2229406 ,  0.1575245 ],
       [ 0.11231307,  0.22630537,  0.1598727 ],
       [ 0.11295339,  0.22967269,  0.16220204],
       [ 0.11356054,  0.23304263,  0.16451246],
       [ 0.11413891,  0.23641438,  0.16680471],
       [ 0.11468254,  0.23978922,  0.16907767],
       [ 0.11519409,  0.24316666,  0.17133175],
       [ 0.11567646,  0.2465462 ,  0.17356748],
       [ 0.1161233 ,  0.24992915,  0.17578358],
       [ 0.1165384 ,  0.25331481,  0.17798073],
       [ 0.11692394,  0.25670283,  0.18015933],
       [ 0.11727383,  0.2600944 ,  0.18231809],
       [ 0.11759161,  0.26348889,  0.18445769],
       [ 0.11787943,  0.26688594,  0.18657854],
       [ 0.11813212,  0.27028654,  0.18867948],
       [ 0.11835162,  0.27369037,  0.19076089],
       [ 0.11854075,  0.27709693,  0.19282336],
       [ 0.1186959 ,  0.28050691,  0.19486604],
       [ 0.11881606,  0.2839205 ,  0.19688864],
       [ 0.11890541,  0.28733698,  0.1988921 ],
       [ 0.11896255,  0.29075662,  0.20087608],
       [ 0.11898218,  0.29418032,  0.20283927],
       [ 0.11897051,  0.29760705,  0.20478312],
       [ 0.11892734,  0.30103685,  0.20670759],
       [ 0.11884678,  0.3044707 ,  0.20861119],
       [ 0.11873263,  0.30790796,  0.21049485],
       [ 0.11858643,  0.31134839,  0.21235893],
       [ 0.11840608,  0.31479234,  0.2142029 ],
       [ 0.11818779,  0.31824037,  0.21602579],
       [ 0.11793678,  0.32169167,  0.21782892],
       [ 0.11765285,  0.32514625,  0.21961223],
       [ 0.11733129,  0.32860483,  0.22137452],
       [ 0.11697341,  0.33206718,  0.22311613],
       [ 0.11658182,  0.33553289,  0.22483774],
       [ 0.11615627,  0.33900199,  0.22653932],
       [ 0.11569054,  0.34247534,  0.22821922],
       [ 0.11518875,  0.34595233,  0.22987857],
       [ 0.11465203,  0.34943276,  0.23151768],
       [ 0.11408011,  0.35291667,  0.23313652],
       [ 0.11346654,  0.35640487,  0.23473339],
       [ 0.11281556,  0.35989675,  0.23630946],
       [ 0.11212819,  0.36339215,  0.23786504],
       [ 0.11140408,  0.36689109,  0.23940011],
       [ 0.11063831,  0.37039413,  0.24091335],
       [ 0.10983172,  0.37390112,  0.24240506],
       [ 0.10898697,  0.37741168,  0.24387601],
       [ 0.10810361,  0.38092581,  0.24532615],
       [ 0.10718059,  0.3844436 ,  0.24675526],
       [ 0.10621066,  0.38796584,  0.24816142],
       [ 0.10520038,  0.39149168,  0.24954652],
       [ 0.10414923,  0.39502113,  0.25091047],
       [ 0.10305664,  0.3985542 ,  0.2522532 ],
       [ 0.10192078,  0.40209102,  0.25357432],
       [ 0.10073524,  0.4056322 ,  0.25487217],
       [ 0.09950607,  0.409177  ,  0.25614849],
       [ 0.09823257,  0.41272544,  0.2574032 ],
       [ 0.09691402,  0.4162775 ,  0.25863619],
       [ 0.09554966,  0.41983319,  0.25984737],
       [ 0.09413364,  0.42339298,  0.2610353 ],
       [ 0.09266659,  0.42695669,  0.26220028],
       [ 0.09115085,  0.43052402,  0.26334304],
       [ 0.0895855 ,  0.43409494,  0.26446347],
       [ 0.08796957,  0.43766946,  0.26556142],
       [ 0.08630203,  0.44124755,  0.26663676],
       [ 0.08458182,  0.4448292 ,  0.26768933],
       [ 0.0828007 ,  0.44841496,  0.2687172 ],
       [ 0.08096339,  0.45200432,  0.26972171],
       [ 0.07906969,  0.45559716,  0.27070293],
       [ 0.07711835,  0.45919345,  0.27166068],
       [ 0.07510809,  0.46279317,  0.27259478],
       [ 0.07303758,  0.46639628,  0.27350502],
       [ 0.07090546,  0.47000274,  0.27439118],
       [ 0.06871036,  0.4736125 ,  0.27525304],
       [ 0.06645088,  0.47722552,  0.27609036],
       [ 0.06412564,  0.48084172,  0.27690289],
       [ 0.06173327,  0.48446106,  0.27769038],
       [ 0.05927037,  0.48808358,  0.2784521 ],
       [ 0.05673661,  0.49170914,  0.27918796],
       [ 0.054133  ,  0.49533753,  0.27989813],
       [ 0.05145892,  0.49896865,  0.28058232],
       [ 0.04871412,  0.50260237,  0.28124026],
       [ 0.04589884,  0.50623857,  0.28187166],
       [ 0.04301401,  0.50987709,  0.28247623],
       [ 0.04005604,  0.51351777,  0.28305369],
       [ 0.03706495,  0.51716074,  0.28360236],
       [ 0.03415031,  0.52080558,  0.28412287],
       [ 0.03132466,  0.52445203,  0.28461492],
       [ 0.02860162,  0.52809985,  0.28507821],
       [ 0.02599618,  0.53174875,  0.28551248],
       [ 0.02352491,  0.53539838,  0.28591747],
       [ 0.02120614,  0.53904839,  0.28629299],
       [ 0.01906018,  0.54269834,  0.28663888],
       [ 0.01709801,  0.54634825,  0.28695255],
       [ 0.01533558,  0.54999795,  0.28723173],
       [ 0.013819  ,  0.5536461 ,  0.28748027],
       [ 0.01257985,  0.55729199,  0.28769837],
       [ 0.01163664,  0.56093555,  0.28788217],
       [ 0.01101714,  0.56457638,  0.28802862],
       [ 0.01079386,  0.56821233,  0.28814492],
       [ 0.01098861,  0.57184347,  0.28822369],
       [ 0.0116649 ,  0.57546826,  0.28826645],
       [ 0.01289565,  0.57908492,  0.28827552],
       [ 0.0147388 ,  0.58269252,  0.2882451 ],
       [ 0.01729611,  0.58628851,  0.28817937],
       [ 0.0206769 ,  0.58987028,  0.28808073],
       [ 0.02498407,  0.59343606,  0.28793927],
       [ 0.03039439,  0.59698116,  0.28776642],
       [ 0.03709185,  0.60050134,  0.28756306],
       [ 0.04507012,  0.60399107,  0.28733272],
       [ 0.05376698,  0.60744317,  0.28708333],
       [ 0.06319278,  0.6108484 ,  0.28682971],
       [ 0.07340147,  0.61419512,  0.28659386],
       [ 0.08446397,  0.61746866,  0.28640581],
       [ 0.09642151,  0.62065176,  0.28632889],
       [ 0.109266  ,  0.62372681,  0.28644435],
       [ 0.12286877,  0.62668097,  0.28685971],
       [ 0.13693828,  0.62951399,  0.28768619],
       [ 0.15107914,  0.6322417 ,  0.28899685],
       [ 0.16492818,  0.63489041,  0.29080102],
       [ 0.17824979,  0.6374873 ,  0.29305545],
       [ 0.19093522,  0.64005481,  0.295693  ],
       [ 0.20299986,  0.6426056 ,  0.29864534],
       [ 0.21447443,  0.64514961,  0.30185457],
       [ 0.22540008,  0.64769416,  0.30527246],
       [ 0.23585095,  0.65024099,  0.30886307],
       [ 0.24587276,  0.65279321,  0.3125967 ],
       [ 0.25551184,  0.65535241,  0.31645017],
       [ 0.26482105,  0.65791793,  0.3204074 ],
       [ 0.27384087,  0.66048954,  0.32445548],
       [ 0.28257262,  0.66307183,  0.32857622],
       [ 0.29108149,  0.66565932,  0.33276906],
       [ 0.29935576,  0.66825742,  0.33701739],
       [ 0.30744646,  0.67086129,  0.34132313],
       [ 0.31534757,  0.67347479,  0.345674  ],
       [ 0.32308606,  0.676096  ,  0.35006881],
       [ 0.33068   ,  0.67872408,  0.35450534],
       [ 0.33813063,  0.68136092,  0.35897652],
       [ 0.34544979,  0.68400633,  0.36347964],
       [ 0.35265383,  0.68665902,  0.36801483],
       [ 0.35975013,  0.68931916,  0.37257955],
       [ 0.36674554,  0.69198688,  0.37717164],
       [ 0.37364546,  0.69466248,  0.38178876],
       [ 0.38045195,  0.69734685,  0.38642743],
       [ 0.3871765 ,  0.7000388 ,  0.39108895],
       [ 0.39382398,  0.7027384 ,  0.39577205],
       [ 0.40039893,  0.7054457 ,  0.40047563],
       [ 0.40690555,  0.70816074,  0.40519871],
       [ 0.41334775,  0.71088356,  0.40994045],
       [ 0.41972918,  0.71361419,  0.4147001 ],
       [ 0.42605321,  0.71635265,  0.41947702],
       [ 0.432323  ,  0.71909898,  0.42427063],
       [ 0.43854149,  0.7218532 ,  0.42908044],
       [ 0.44471141,  0.72461534,  0.43390599],
       [ 0.45083532,  0.72738542,  0.4387469 ],
       [ 0.45691561,  0.73016349,  0.44360283],
       [ 0.46295449,  0.73294957,  0.44847348],
       [ 0.46895406,  0.7357437 ,  0.45335856],
       [ 0.47491554,  0.73854611,  0.45825738],
       [ 0.48083939,  0.74135722,  0.46316875],
       [ 0.4867294 ,  0.74417653,  0.46809386],
       [ 0.4925872 ,  0.74700408,  0.47303257],
       [ 0.4984143 ,  0.74983992,  0.47798473],
       [ 0.50421213,  0.75268411,  0.48295022],
       [ 0.50998202,  0.7555367 ,  0.48792894],
       [ 0.51572522,  0.75839776,  0.49292078],
       [ 0.52144281,  0.76126737,  0.49792558],
       [ 0.52713293,  0.7641465 ,  0.50294096],
       [ 0.53279988,  0.76703426,  0.50796931],
       [ 0.53844463,  0.76993073,  0.51301057],
       [ 0.54406809,  0.772836  ,  0.51806467],
       [ 0.54967114,  0.77575014,  0.52313157],
       [ 0.55525456,  0.77867326,  0.52821121],
       [ 0.56081655,  0.78160624,  0.53330138],
       [ 0.56636048,  0.78454838,  0.5384042 ],
       [ 0.57188722,  0.7874997 ,  0.54351982],
       [ 0.57739741,  0.79046031,  0.54864821],
       [ 0.58289162,  0.79343031,  0.55378932],
       [ 0.58836905,  0.79641027,  0.55894189],
       [ 0.59383097,  0.79940006,  0.56410652],
       [ 0.5992788 ,  0.80239949,  0.56928403],
       [ 0.60471301,  0.80540868,  0.5744744 ],
       [ 0.61013402,  0.80842776,  0.57967759],
       [ 0.61554112,  0.81145723,  0.58489252],
       [ 0.62093559,  0.81449691,  0.59012001],
       [ 0.62631832,  0.81754676,  0.59536055],
       [ 0.63168965,  0.8206069 ,  0.60061413],
       [ 0.63704985,  0.82367748,  0.60588071],
       [ 0.64239833,  0.82675895,  0.61115939],
       [ 0.6477366 ,  0.82985102,  0.61645139],
       [ 0.65306488,  0.83295384,  0.62175671],
       [ 0.6583834 ,  0.83606755,  0.62707534],
       [ 0.66369219,  0.83919237,  0.63240709],
       [ 0.66899167,  0.84232836,  0.63775219],
       [ 0.6742823 ,  0.84547559,  0.64311096],
       [ 0.6795642 ,  0.8486342 ,  0.6484834 ],
       [ 0.68483753,  0.85180437,  0.65386951],
       [ 0.69010274,  0.85498612,  0.65926969],
       [ 0.69535994,  0.85817963,  0.66468397],
       [ 0.70060922,  0.86138505,  0.67011237],
       [ 0.70585064,  0.86460257,  0.67555493],
       [ 0.71108464,  0.86783223,  0.68101208],
       [ 0.71631159,  0.87107404,  0.68648431],
       [ 0.72153116,  0.87432836,  0.69197123],
       [ 0.72674336,  0.87759535,  0.69747288],
       [ 0.7319482 ,  0.88087521,  0.70298934],
       [ 0.73714676,  0.88416768,  0.70852206],
       [ 0.74233847,  0.88747317,  0.71407047],
       [ 0.74752303,  0.89079197,  0.71963433],
       [ 0.75270041,  0.89412429,  0.72521377],
       [ 0.75787053,  0.89747032,  0.7308089 ],
       [ 0.76303498,  0.90082957,  0.73642216],
       [ 0.76819228,  0.9042028 ,  0.74205186],
       [ 0.77334225,  0.90759028,  0.74769805],
       [ 0.77848474,  0.91099223,  0.75336093],
       [ 0.7836196 ,  0.91440886,  0.75904067],
       [ 0.78874805,  0.91783978,  0.76473958],
       [ 0.79386911,  0.92128556,  0.77045685],
       [ 0.79898205,  0.92474667,  0.77619195],
       [ 0.8040866 ,  0.92822336,  0.78194514],
       [ 0.80918246,  0.93171591,  0.78771671],
       [ 0.81426929,  0.9352246 ,  0.79350695],
       [ 0.81934798,  0.9387491 ,  0.79931832],
       [ 0.82441738,  0.94229005,  0.80515007],
       [ 0.82947648,  0.94584802,  0.81100163],
       [ 0.83452472,  0.94942338,  0.81687334],
       [ 0.83956149,  0.95301648,  0.82276558],
       [ 0.84458609,  0.95662772,  0.82867872],
       [ 0.84959775,  0.96025752,  0.83461316],
       [ 0.85459561,  0.96390635,  0.84056928],
       [ 0.85957867,  0.96757469,  0.84654749]]

test_cm = LinearSegmentedColormap.from_list(__file__, cm_data)


if __name__ == "__main__":
    import matplotlib.pyplot as plt
    import numpy as np

    try:
        from pycam02ucs.cm.viscm import viscm
        viscm(test_cm)
    except ImportError:
        print("pycam02ucs not found, falling back on simple display")
        plt.imshow(np.linspace(0, 100, 256)[None, :], aspect='auto',
                   cmap=test_cm)
    plt.show()
