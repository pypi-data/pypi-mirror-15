
from matplotlib.colors import LinearSegmentedColormap
from numpy import nan, inf

# Used to reconstruct the colormap in pycam02ucs.cm.viscm
parameters = {'xp': [4.934764309764319, -1.749263468013453, -14.356589454756971, -33.95412457912457, -34.59001004812521, -1.3348243068987529],
              'yp': [-31.24999999999997, -40.9722222222222, -42.24476439790574, -0.2604166666666572, 42.5065445026178, 23.079196217494115],
              'min_JK': 18.8671875,
              'max_JK': 95.0}

cm_data = [[ 0.1700371 ,  0.07747645,  0.43856864],
       [ 0.17115617,  0.07959657,  0.44685059],
       [ 0.17216038,  0.08178969,  0.45511187],
       [ 0.17304062,  0.08406813,  0.46333885],
       [ 0.17378626,  0.08644398,  0.47151912],
       [ 0.17438636,  0.08893143,  0.47963524],
       [ 0.17482981,  0.09154609,  0.48766539],
       [ 0.17510407,  0.09430321,  0.49558795],
       [ 0.17519581,  0.09721837,  0.50337889],
       [ 0.17509015,  0.10030673,  0.5110135 ],
       [ 0.17477321,  0.10358405,  0.51846067],
       [ 0.17423075,  0.10706476,  0.52568777],
       [ 0.17344843,  0.1107614 ,  0.53266092],
       [ 0.17241267,  0.1146841 ,  0.53934473],
       [ 0.17111127,  0.11883972,  0.54570307],
       [ 0.16953413,  0.12323107,  0.55170028],
       [ 0.16767396,  0.12785617,  0.55730257],
       [ 0.16552703,  0.13270775,  0.56247959],
       [ 0.16309368,  0.13777306,  0.56720615],
       [ 0.1603787 ,  0.1430341 ,  0.5714636 ],
       [ 0.15739133,  0.14846824,  0.5752411 ],
       [ 0.15414505,  0.15404925,  0.57853616],
       [ 0.15065691,  0.15974861,  0.58135471],
       [ 0.1469467 ,  0.16553693,  0.58371048],
       [ 0.14303599,  0.1713853 ,  0.58562389],
       [ 0.13894707,  0.17726649,  0.58712056],
       [ 0.13470796,  0.18315354,  0.58823122],
       [ 0.13033859,  0.18902548,  0.58898756],
       [ 0.12585814,  0.19486446,  0.58942162],
       [ 0.12128494,  0.20065568,  0.58956508],
       [ 0.11664849,  0.20638287,  0.5894535 ],
       [ 0.11196111,  0.21203845,  0.58911509],
       [ 0.10722952,  0.21761854,  0.58857345],
       [ 0.10249535,  0.22310948,  0.5878663 ],
       [ 0.09774394,  0.22851759,  0.58700374],
       [ 0.09301545,  0.23383299,  0.58601961],
       [ 0.08829831,  0.23906275,  0.58492066],
       [ 0.08363727,  0.24419844,  0.58373961],
       [ 0.07901633,  0.24924959,  0.58247656],
       [ 0.07447284,  0.25421192,  0.58115662],
       [ 0.07001527,  0.25908958,  0.57978815],
       [ 0.06565108,  0.26388723,  0.57837685],
       [ 0.06141742,  0.26860332,  0.57694163],
       [ 0.05732978,  0.27324203,  0.57548808],
       [ 0.0534023 ,  0.27780807,  0.57401899],
       [ 0.04966193,  0.28230393,  0.57254161],
       [ 0.04614852,  0.28673031,  0.57106764],
       [ 0.042891  ,  0.29109051,  0.56960131],
       [ 0.0399065 ,  0.29538886,  0.56814284],
       [ 0.03727185,  0.29962791,  0.56669654],
       [ 0.03506713,  0.30381022,  0.56526618],
       [ 0.03328563,  0.30793828,  0.56385504],
       [ 0.03192032,  0.31201452,  0.56246596],
       [ 0.03096473,  0.31604118,  0.56110188],
       [ 0.0304147 ,  0.32001998,  0.55976707],
       [ 0.03025704,  0.32395412,  0.55845988],
       [ 0.03048429,  0.32784574,  0.55718184],
       [ 0.03108896,  0.33169688,  0.55593421],
       [ 0.03206354,  0.33550953,  0.55471806],
       [ 0.03340053,  0.33928557,  0.55353425],
       [ 0.03509246,  0.34302686,  0.55238346],
       [ 0.0371319 ,  0.34673513,  0.55126622],
       [ 0.03951151,  0.35041207,  0.55018295],
       [ 0.04217235,  0.3540593 ,  0.54913393],
       [ 0.04502665,  0.35767837,  0.54811932],
       [ 0.04805306,  0.36127076,  0.54713921],
       [ 0.05122517,  0.36483759,  0.54619519],
       [ 0.05451793,  0.36838032,  0.54528684],
       [ 0.05790905,  0.37190046,  0.54441296],
       [ 0.06137991,  0.37539929,  0.54357332],
       [ 0.06491442,  0.37887802,  0.54276765],
       [ 0.06849876,  0.38233781,  0.54199561],
       [ 0.07212108,  0.38577979,  0.54125686],
       [ 0.0757712 ,  0.38920503,  0.540551  ],
       [ 0.07944045,  0.39261457,  0.53987759],
       [ 0.08312139,  0.39600939,  0.53923619],
       [ 0.08680871,  0.39938992,  0.53862959],
       [ 0.09049603,  0.40275748,  0.53805503],
       [ 0.09417834,  0.40611312,  0.53751088],
       [ 0.09785164,  0.40945771,  0.53699656],
       [ 0.1015125 ,  0.41279207,  0.5365115 ],
       [ 0.10515798,  0.416117  ,  0.53605509],
       [ 0.10878574,  0.41943313,  0.53562768],
       [ 0.11239407,  0.42274082,  0.53523124],
       [ 0.11598026,  0.42604136,  0.53486136],
       [ 0.1195427 ,  0.42933543,  0.53451735],
       [ 0.12308001,  0.43262371,  0.53419853],
       [ 0.12659099,  0.43590685,  0.53390419],
       [ 0.13007511,  0.43918504,  0.53363676],
       [ 0.13353111,  0.44245917,  0.53339343],
       [ 0.13695806,  0.44573004,  0.5331721 ],
       [ 0.1403553 ,  0.44899819,  0.532972  ],
       [ 0.14372233,  0.45226418,  0.53279234],
       [ 0.14705916,  0.45552813,  0.53263544],
       [ 0.1503651 ,  0.45879086,  0.53249807],
       [ 0.15363972,  0.46205302,  0.53237836],
       [ 0.15688282,  0.46531508,  0.53227545],
       [ 0.16009437,  0.46857742,  0.53218909],
       [ 0.16327468,  0.47184018,  0.53212075],
       [ 0.16642324,  0.47510421,  0.5320662 ],
       [ 0.1695401 ,  0.47836994,  0.53202451],
       [ 0.17262537,  0.48163774,  0.53199472],
       [ 0.17567968,  0.48490767,  0.53197851],
       [ 0.17870288,  0.48818038,  0.53197256],
       [ 0.18169512,  0.49145629,  0.53197523],
       [ 0.18465675,  0.49473575,  0.53198551],
       [ 0.18758849,  0.49801884,  0.5320041 ],
       [ 0.19049062,  0.50130596,  0.53202897],
       [ 0.19336344,  0.50459756,  0.53205795],
       [ 0.19620751,  0.50789388,  0.53208996],
       [ 0.19902372,  0.51119501,  0.5321252 ],
       [ 0.20181265,  0.51450124,  0.532162  ],
       [ 0.20457482,  0.51781292,  0.53219817],
       [ 0.20731102,  0.52113025,  0.53223258],
       [ 0.21002237,  0.52445325,  0.53226514],
       [ 0.21270967,  0.52778217,  0.53229408],
       [ 0.21537372,  0.53111725,  0.53231747],
       [ 0.21801559,  0.53445861,  0.53233418],
       [ 0.2206366 ,  0.53780623,  0.53234383],
       [ 0.22323775,  0.54116031,  0.53234451],
       [ 0.22582021,  0.54452096,  0.53233465],
       [ 0.22838529,  0.54788822,  0.53231308],
       [ 0.2309345 ,  0.55126208,  0.53227911],
       [ 0.23346912,  0.55464262,  0.53223086],
       [ 0.23599063,  0.55802987,  0.53216705],
       [ 0.23850064,  0.56142378,  0.53208657],
       [ 0.24100075,  0.56482433,  0.53198816],
       [ 0.24349262,  0.5682315 ,  0.53187039],
       [ 0.24597802,  0.5716452 ,  0.53173216],
       [ 0.24845878,  0.57506535,  0.53157231],
       [ 0.25093663,  0.57849191,  0.53138907],
       [ 0.25341362,  0.58192472,  0.53118168],
       [ 0.25589177,  0.58536361,  0.53094913],
       [ 0.25837308,  0.58880847,  0.53069003],
       [ 0.26085945,  0.59225923,  0.53040244],
       [ 0.26335327,  0.59571558,  0.53008621],
       [ 0.26585678,  0.5991773 ,  0.52974037],
       [ 0.26837207,  0.60264426,  0.52936318],
       [ 0.27090129,  0.60611631,  0.52895286],
       [ 0.27344708,  0.60959305,  0.52850971],
       [ 0.27601183,  0.61307419,  0.52803286],
       [ 0.27859774,  0.61655959,  0.52752022],
       [ 0.28120715,  0.62004903,  0.52697018],
       [ 0.28384288,  0.623542  ,  0.5263835 ],
       [ 0.28650745,  0.62703816,  0.52575943],
       [ 0.28920319,  0.63053733,  0.5250958 ],
       [ 0.29193253,  0.63403926,  0.52439065],
       [ 0.29469841,  0.63754335,  0.52364549],
       [ 0.29750343,  0.64104919,  0.52285971],
       [ 0.30035009,  0.64455648,  0.52203168],
       [ 0.3032408 ,  0.64806508,  0.52115789],
       [ 0.30617857,  0.65157422,  0.5202412 ],
       [ 0.30916603,  0.65508345,  0.5192811 ],
       [ 0.31220581,  0.65859231,  0.51827714],
       [ 0.3153004 ,  0.66210074,  0.5172239 ],
       [ 0.3184527 ,  0.66560793,  0.5161247 ],
       [ 0.32166535,  0.6691133 ,  0.51497985],
       [ 0.32494099,  0.67261634,  0.51378902],
       [ 0.32828228,  0.67611664,  0.51255021],
       [ 0.33169208,  0.67961385,  0.51125992],
       [ 0.33517292,  0.68310707,  0.50992237],
       [ 0.33872738,  0.68659573,  0.50853737],
       [ 0.34235805,  0.69007923,  0.50710479],
       [ 0.34606774,  0.69355704,  0.50562256],
       [ 0.34985958,  0.69702866,  0.5040874 ],
       [ 0.35373562,  0.70049316,  0.50250414],
       [ 0.35769843,  0.70394986,  0.50087287],
       [ 0.36175054,  0.70739803,  0.49919373],
       [ 0.3658945 ,  0.71083696,  0.49746694],
       [ 0.37013392,  0.714266  ,  0.49568808],
       [ 0.37447108,  0.71768427,  0.49385955],
       [ 0.37890801,  0.72109087,  0.49198427],
       [ 0.38344721,  0.72448493,  0.49006284],
       [ 0.38809122,  0.72786558,  0.48809597],
       [ 0.39284255,  0.73123189,  0.48608449],
       [ 0.39770373,  0.7345829 ,  0.48402936],
       [ 0.40267878,  0.73791761,  0.4819276 ],
       [ 0.40776965,  0.74123493,  0.47978263],
       [ 0.41297811,  0.74453378,  0.47759812],
       [ 0.41830662,  0.74781303,  0.47537588],
       [ 0.42375765,  0.75107151,  0.47311795],
       [ 0.42933362,  0.75430801,  0.47082668],
       [ 0.43503694,  0.75752126,  0.46850472],
       [ 0.44086996,  0.76070996,  0.46615509],
       [ 0.44683496,  0.76387274,  0.46378123],
       [ 0.45293414,  0.76700819,  0.46138699],
       [ 0.45916959,  0.77011488,  0.45897677],
       [ 0.46554328,  0.77319131,  0.45655549],
       [ 0.47205695,  0.77623597,  0.45412872],
       [ 0.47871218,  0.7792473 ,  0.45170266],
       [ 0.48551022,  0.78222375,  0.4492843 ],
       [ 0.49245204,  0.78516376,  0.44688139],
       [ 0.49953818,  0.78806575,  0.44450253],
       [ 0.50676873,  0.79092823,  0.44215726],
       [ 0.51414324,  0.79374972,  0.43985602],
       [ 0.52166062,  0.79652884,  0.43761025],
       [ 0.52931907,  0.79926431,  0.43543235],
       [ 0.53711599,  0.80195502,  0.43333568],
       [ 0.54504792,  0.80460001,  0.43133454],
       [ 0.5531104 ,  0.80719856,  0.42944402],
       [ 0.56129799,  0.80975021,  0.42767994],
       [ 0.56960415,  0.8122548 ,  0.42605866],
       [ 0.57802125,  0.81471252,  0.42459687],
       [ 0.58654058,  0.81712391,  0.42331133],
       [ 0.59515273,  0.81948986,  0.42221834],
       [ 0.60384539,  0.82181208,  0.42133505],
       [ 0.61260671,  0.82409245,  0.42067657],
       [ 0.62142432,  0.82633323,  0.42025665],
       [ 0.63028538,  0.82853703,  0.42008739],
       [ 0.63917685,  0.83070684,  0.42017904],
       [ 0.64808571,  0.8328459 ,  0.42053968],
       [ 0.65699919,  0.83495769,  0.42117512],
       [ 0.66590505,  0.83704582,  0.42208882],
       [ 0.67479175,  0.83911398,  0.42328184],
       [ 0.68364868,  0.84116587,  0.42475301],
       [ 0.69246566,  0.84320528,  0.42649914],
       [ 0.70123448,  0.84523564,  0.42851492],
       [ 0.7099499 ,  0.84725965,  0.4307932 ],
       [ 0.7186057 ,  0.84928042,  0.43332601],
       [ 0.72719486,  0.85130144,  0.43610436],
       [ 0.73571539,  0.85332472,  0.43911811],
       [ 0.74416504,  0.85535239,  0.44235682],
       [ 0.75254261,  0.85738624,  0.44580986],
       [ 0.76084785,  0.85942778,  0.4494666 ],
       [ 0.76908129,  0.8614782 ,  0.4533166 ],
       [ 0.7772442 ,  0.86353844,  0.45734978],
       [ 0.78533839,  0.86560917,  0.46155652],
       [ 0.79336618,  0.86769085,  0.46592773],
       [ 0.80130503,  0.86979308,  0.47044677],
       [ 0.80917979,  0.87190813,  0.47511084],
       [ 0.81699452,  0.87403563,  0.47991274],
       [ 0.82475275,  0.87617534,  0.48484574],
       [ 0.83244191,  0.87833326,  0.48989622],
       [ 0.84006099,  0.88051103,  0.49505473],
       [ 0.84763255,  0.88270083,  0.50032444],
       [ 0.8551604 ,  0.88490201,  0.50570101],
       [ 0.86261113,  0.88712923,  0.51115842],
       [ 0.87001858,  0.88936968,  0.51670889],
       [ 0.87739195,  0.8916203 ,  0.52235271],
       [ 0.88469889,  0.89389565,  0.52806273],
       [ 0.89196612,  0.89618533,  0.53385051],
       [ 0.89920871,  0.89848351,  0.53972215],
       [ 0.90638184,  0.90081063,  0.54563909],
       [ 0.91353262,  0.90314678,  0.5516317 ],
       [ 0.92065044,  0.9054973 ,  0.55768771],
       [ 0.9277178 ,  0.90787088,  0.56378787],
       [ 0.93477489,  0.91024987,  0.56996208],
       [ 0.94177556,  0.9126562 ,  0.5761661 ],
       [ 0.94876273,  0.91507062,  0.58243418],
       [ 0.95571703,  0.91750278,  0.5887453 ],
       [ 0.96264207,  0.91995163,  0.59509914],
       [ 0.96955313,  0.92241038,  0.60150757],
       [ 0.97642351,  0.92489253,  0.60794078],
       [ 0.98329443,  0.92737849,  0.61443793],
       [ 0.9901173 ,  0.92989275,  0.62094568],
       [ 0.99695109,  0.93240648,  0.6275241 ]]

test_cm = LinearSegmentedColormap.from_list(__file__, cm_data)


if __name__ == "__main__":
    import matplotlib.pyplot as plt
    import numpy as np

    try:
        from pycam02ucs.cm.viscm import viscm
        viscm(test_cm)
    except ImportError:
        print("pycam02ucs not found, falling back on simple display")
        plt.imshow(np.linspace(0, 100, 256)[None, :], aspect='auto',
                   cmap=test_cm)
    plt.show()
