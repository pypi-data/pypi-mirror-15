
from matplotlib.colors import LinearSegmentedColormap
from numpy import nan, inf

# Used to reconstruct the colormap in pycam02ucs.cm.viscm
parameters = {'xp': [0.25660876533639865, -1.0019196816510982],
              'yp': [-0.029033616707334176, 0.083911243919748912],
              'min_Jp': 0.0267022696929,
              'max_Jp': 99.8931909212}

cm_data = [[  5.81579100e-06,   2.68055619e-07,   2.33531860e-06],
       [  2.89521132e-04,   2.42093548e-04,   2.57715743e-04],
       [  9.04276586e-04,   8.10812178e-04,   8.38839141e-04],
       [  1.80610163e-03,   1.66164864e-03,   1.70159797e-03],
       [  2.97422247e-03,   2.77460484e-03,   2.82587537e-03],
       [  4.39571176e-03,   4.13733351e-03,   4.19921367e-03],
       [  6.06158587e-03,   5.74128888e-03,   5.81297747e-03],
       [  7.96521461e-03,   7.58018425e-03,   7.66080643e-03],
       [  1.01015208e-02,   9.64922080e-03,   9.73783964e-03],
       [  1.24665232e-02,   1.19446487e-02,   1.20402738e-02],
       [  1.50570523e-02,   1.44634949e-02,   1.45650885e-02],
       [  1.78705627e-02,   1.72033828e-02,   1.73098655e-02],
       [  2.09050023e-02,   2.01624079e-02,   2.02726619e-02],
       [  2.41587187e-02,   2.33390481e-02,   2.34519206e-02],
       [  2.76303899e-02,   2.67320968e-02,   2.68464030e-02],
       [  3.13189710e-02,   3.03406124e-02,   3.04551373e-02],
       [  3.52236533e-02,   3.41638794e-02,   3.42773799e-02],
       [  3.93438321e-02,   3.82013765e-02,   3.83125833e-02],
       [  4.35538731e-02,   4.23913799e-02,   4.24941743e-02],
       [  4.77082493e-02,   4.65353149e-02,   4.66278724e-02],
       [  5.18202663e-02,   5.06374888e-02,   5.07197354e-02],
       [  5.58930889e-02,   5.47010253e-02,   5.47728905e-02],
       [  5.99295448e-02,   5.87287140e-02,   5.87901312e-02],
       [  6.39321737e-02,   6.27230598e-02,   6.27739661e-02],
       [  6.79032684e-02,   6.66863233e-02,   6.67266591e-02],
       [  7.18449079e-02,   7.06205536e-02,   7.06502631e-02],
       [  7.57589859e-02,   7.45276163e-02,   7.45466467e-02],
       [  7.96472334e-02,   7.84092160e-02,   7.84175181e-02],
       [  8.35112386e-02,   8.22669162e-02,   8.22644438e-02],
       [  8.73524635e-02,   8.61021552e-02,   8.60888654e-02],
       [  9.11722584e-02,   8.99162607e-02,   8.98921137e-02],
       [  9.49718739e-02,   9.37104615e-02,   9.36754206e-02],
       [  9.87524713e-02,   9.74858981e-02,   9.74399296e-02],
       [  1.02515132e-01,   1.01243631e-01,   1.01186705e-01],
       [  1.06260866e-01,   1.04984651e-01,   1.04916739e-01],
       [  1.09990618e-01,   1.08709881e-01,   1.08630959e-01],
       [  1.13705274e-01,   1.12420189e-01,   1.12330236e-01],
       [  1.17405667e-01,   1.16116386e-01,   1.16015384e-01],
       [  1.21092582e-01,   1.19799236e-01,   1.19687171e-01],
       [  1.24766760e-01,   1.23469459e-01,   1.23346319e-01],
       [  1.28428901e-01,   1.27127733e-01,   1.26993511e-01],
       [  1.32079672e-01,   1.30774697e-01,   1.30629390e-01],
       [  1.35719704e-01,   1.34410959e-01,   1.34254566e-01],
       [  1.39349602e-01,   1.38037090e-01,   1.37869615e-01],
       [  1.42969944e-01,   1.41653633e-01,   1.41475084e-01],
       [  1.46581286e-01,   1.45261101e-01,   1.45071490e-01],
       [  1.50184168e-01,   1.48859980e-01,   1.48659321e-01],
       [  1.53779120e-01,   1.52450726e-01,   1.52239036e-01],
       [  1.57366675e-01,   1.56033768e-01,   1.55811061e-01],
       [  1.60947396e-01,   1.59609496e-01,   1.59375783e-01],
       [  1.64521938e-01,   1.63178239e-01,   1.62933528e-01],
       [  1.68091226e-01,   1.66740198e-01,   1.66484593e-01],
       [  1.71656464e-01,   1.70295380e-01,   1.70029835e-01],
       [  1.75216532e-01,   1.73844587e-01,   1.73571140e-01],
       [  1.78769809e-01,   1.77389065e-01,   1.77107795e-01],
       [  1.82317144e-01,   1.80929039e-01,   1.80639302e-01],
       [  1.85859262e-01,   1.84464678e-01,   1.84165990e-01],
       [  1.89396641e-01,   1.87996223e-01,   1.87688242e-01],
       [  1.92929668e-01,   1.91523941e-01,   1.91206408e-01],
       [  1.96458685e-01,   1.95048103e-01,   1.94720809e-01],
       [  1.99984009e-01,   1.98568978e-01,   1.98231744e-01],
       [  2.03505937e-01,   2.02086828e-01,   2.01739500e-01],
       [  2.07024754e-01,   2.05601910e-01,   2.05244349e-01],
       [  2.10540732e-01,   2.09114475e-01,   2.08746553e-01],
       [  2.14054132e-01,   2.12624766e-01,   2.12246366e-01],
       [  2.17565205e-01,   2.16133020e-01,   2.15744032e-01],
       [  2.21074196e-01,   2.19639467e-01,   2.19239787e-01],
       [  2.24581340e-01,   2.23144332e-01,   2.22733861e-01],
       [  2.28086866e-01,   2.26647833e-01,   2.26226476e-01],
       [  2.31590994e-01,   2.30150182e-01,   2.29717848e-01],
       [  2.35093940e-01,   2.33651586e-01,   2.33208188e-01],
       [  2.38595914e-01,   2.37152248e-01,   2.36697700e-01],
       [  2.42097118e-01,   2.40652363e-01,   2.40186582e-01],
       [  2.45597752e-01,   2.44152125e-01,   2.43675031e-01],
       [  2.49098008e-01,   2.47651719e-01,   2.47163233e-01],
       [  2.52598074e-01,   2.51151331e-01,   2.50651376e-01],
       [  2.56098135e-01,   2.54651138e-01,   2.54139638e-01],
       [  2.59598371e-01,   2.58151315e-01,   2.57628196e-01],
       [  2.63098956e-01,   2.61652033e-01,   2.61117224e-01],
       [  2.66600064e-01,   2.65153461e-01,   2.64606888e-01],
       [  2.70101861e-01,   2.68655762e-01,   2.68097356e-01],
       [  2.73604512e-01,   2.72159096e-01,   2.71588787e-01],
       [  2.77108178e-01,   2.75663622e-01,   2.75081341e-01],
       [  2.80613018e-01,   2.79169494e-01,   2.78575173e-01],
       [  2.84119186e-01,   2.82676863e-01,   2.82070436e-01],
       [  2.87626834e-01,   2.86185879e-01,   2.85567280e-01],
       [  2.91136112e-01,   2.89696688e-01,   2.89065850e-01],
       [  2.94647166e-01,   2.93209433e-01,   2.92566292e-01],
       [  2.98160139e-01,   2.96724256e-01,   2.96068747e-01],
       [  3.01675175e-01,   3.00241295e-01,   2.99573355e-01],
       [  3.05192411e-01,   3.03760688e-01,   3.03080253e-01],
       [  3.08711985e-01,   3.07282569e-01,   3.06589576e-01],
       [  3.12234032e-01,   3.10807071e-01,   3.10101458e-01],
       [  3.15758685e-01,   3.14334324e-01,   3.13616029e-01],
       [  3.19286074e-01,   3.17864457e-01,   3.17133419e-01],
       [  3.22816330e-01,   3.21397597e-01,   3.20653754e-01],
       [  3.26349579e-01,   3.24933870e-01,   3.24177162e-01],
       [  3.29885946e-01,   3.28473399e-01,   3.27703765e-01],
       [  3.33425557e-01,   3.32016306e-01,   3.31233686e-01],
       [  3.36968533e-01,   3.35562711e-01,   3.34767046e-01],
       [  3.40514996e-01,   3.39112735e-01,   3.38303964e-01],
       [  3.44065064e-01,   3.42666494e-01,   3.41844558e-01],
       [  3.47618857e-01,   3.46224105e-01,   3.45388946e-01],
       [  3.51176490e-01,   3.49785684e-01,   3.48937243e-01],
       [  3.54738081e-01,   3.53351344e-01,   3.52489562e-01],
       [  3.58303742e-01,   3.56921198e-01,   3.56046017e-01],
       [  3.61873588e-01,   3.60495358e-01,   3.59606720e-01],
       [  3.65447731e-01,   3.64073935e-01,   3.63171782e-01],
       [  3.69026282e-01,   3.67657039e-01,   3.66741313e-01],
       [  3.72609351e-01,   3.71244777e-01,   3.70315422e-01],
       [  3.76197047e-01,   3.74837259e-01,   3.73894216e-01],
       [  3.79789479e-01,   3.78434591e-01,   3.77477802e-01],
       [  3.83386754e-01,   3.82036879e-01,   3.81066288e-01],
       [  3.86988979e-01,   3.85644228e-01,   3.84659779e-01],
       [  3.90596260e-01,   3.89256744e-01,   3.88258379e-01],
       [  3.94208702e-01,   3.92874530e-01,   3.91862192e-01],
       [  3.97826409e-01,   3.96497689e-01,   3.95471322e-01],
       [  4.01449485e-01,   4.00126324e-01,   3.99085871e-01],
       [  4.05078034e-01,   4.03760537e-01,   4.02705941e-01],
       [  4.08712158e-01,   4.07400429e-01,   4.06331634e-01],
       [  4.12351959e-01,   4.11046101e-01,   4.09963052e-01],
       [  4.15997538e-01,   4.14697653e-01,   4.13600293e-01],
       [  4.19648996e-01,   4.18355186e-01,   4.17243458e-01],
       [  4.23306434e-01,   4.22018798e-01,   4.20892647e-01],
       [  4.26969951e-01,   4.25688588e-01,   4.24547958e-01],
       [  4.30639648e-01,   4.29364656e-01,   4.28209490e-01],
       [  4.34315623e-01,   4.33047099e-01,   4.31877342e-01],
       [  4.37997975e-01,   4.36736015e-01,   4.35551611e-01],
       [  4.41686803e-01,   4.40431502e-01,   4.39232394e-01],
       [  4.45382205e-01,   4.44133656e-01,   4.42919789e-01],
       [  4.49084279e-01,   4.47842574e-01,   4.46613893e-01],
       [  4.52793122e-01,   4.51558354e-01,   4.50314803e-01],
       [  4.56508832e-01,   4.55281092e-01,   4.54022614e-01],
       [  4.60231505e-01,   4.59010884e-01,   4.57737423e-01],
       [  4.63961240e-01,   4.62747825e-01,   4.61459327e-01],
       [  4.67698131e-01,   4.66492013e-01,   4.65188420e-01],
       [  4.71442277e-01,   4.70243541e-01,   4.68924799e-01],
       [  4.75193773e-01,   4.74002507e-01,   4.72668560e-01],
       [  4.78952716e-01,   4.77769006e-01,   4.76419797e-01],
       [  4.82719202e-01,   4.81543132e-01,   4.80178606e-01],
       [  4.86493327e-01,   4.85324982e-01,   4.83945083e-01],
       [  4.90275187e-01,   4.89114650e-01,   4.87719322e-01],
       [  4.94064879e-01,   4.92912232e-01,   4.91501419e-01],
       [  4.97862497e-01,   4.96717823e-01,   4.95291469e-01],
       [  5.01668139e-01,   5.00531518e-01,   4.99089568e-01],
       [  5.05481901e-01,   5.04353413e-01,   5.02895809e-01],
       [  5.09303877e-01,   5.08183602e-01,   5.06710290e-01],
       [  5.13134166e-01,   5.12022182e-01,   5.10533104e-01],
       [  5.16972861e-01,   5.15869247e-01,   5.14364348e-01],
       [  5.20820061e-01,   5.19724894e-01,   5.18204117e-01],
       [  5.24675861e-01,   5.23589217e-01,   5.22052506e-01],
       [  5.28540357e-01,   5.27462312e-01,   5.25909611e-01],
       [  5.32413647e-01,   5.31344276e-01,   5.29775528e-01],
       [  5.36295827e-01,   5.35235204e-01,   5.33650353e-01],
       [  5.40186993e-01,   5.39135193e-01,   5.37534182e-01],
       [  5.44087244e-01,   5.43044339e-01,   5.41427111e-01],
       [  5.47996675e-01,   5.46962738e-01,   5.45329236e-01],
       [  5.51915385e-01,   5.50890487e-01,   5.49240655e-01],
       [  5.55843471e-01,   5.54827684e-01,   5.53161465e-01],
       [  5.59781032e-01,   5.58774425e-01,   5.57091762e-01],
       [  5.63728165e-01,   5.62730808e-01,   5.61031643e-01],
       [  5.67684968e-01,   5.66696931e-01,   5.64981207e-01],
       [  5.71651541e-01,   5.70672892e-01,   5.68940552e-01],
       [  5.75627982e-01,   5.74658789e-01,   5.72909776e-01],
       [  5.79614391e-01,   5.78654720e-01,   5.76888976e-01],
       [  5.83610867e-01,   5.82660786e-01,   5.80878253e-01],
       [  5.87617510e-01,   5.86677084e-01,   5.84877705e-01],
       [  5.91634420e-01,   5.90703716e-01,   5.88887433e-01],
       [  5.95661699e-01,   5.94740780e-01,   5.92907535e-01],
       [  5.99699447e-01,   5.98788377e-01,   5.96938112e-01],
       [  6.03747765e-01,   6.02846609e-01,   6.00979264e-01],
       [  6.07806755e-01,   6.06915575e-01,   6.05031094e-01],
       [  6.11876520e-01,   6.10995379e-01,   6.09093702e-01],
       [  6.15957162e-01,   6.15086121e-01,   6.13167190e-01],
       [  6.20048784e-01,   6.19187905e-01,   6.17251661e-01],
       [  6.24151490e-01,   6.23300833e-01,   6.21347217e-01],
       [  6.28265384e-01,   6.27425009e-01,   6.25453962e-01],
       [  6.32390570e-01,   6.31560536e-01,   6.29571999e-01],
       [  6.36527152e-01,   6.35707520e-01,   6.33701433e-01],
       [  6.40675238e-01,   6.39866064e-01,   6.37842369e-01],
       [  6.44834932e-01,   6.44036275e-01,   6.41994911e-01],
       [  6.49006341e-01,   6.48218258e-01,   6.46159165e-01],
       [  6.53189572e-01,   6.52412120e-01,   6.50335239e-01],
       [  6.57384733e-01,   6.56617968e-01,   6.54523238e-01],
       [  6.61591932e-01,   6.60835910e-01,   6.58723271e-01],
       [  6.65811277e-01,   6.65066053e-01,   6.62935444e-01],
       [  6.70042879e-01,   6.69308507e-01,   6.67159868e-01],
       [  6.74286847e-01,   6.73563381e-01,   6.71396651e-01],
       [  6.78543291e-01,   6.77830785e-01,   6.75645904e-01],
       [  6.82812324e-01,   6.82110830e-01,   6.79907736e-01],
       [  6.87094056e-01,   6.86403628e-01,   6.84182258e-01],
       [  6.91388601e-01,   6.90709289e-01,   6.88469584e-01],
       [  6.95696071e-01,   6.95027928e-01,   6.92769825e-01],
       [  7.00016581e-01,   6.99359657e-01,   6.97083094e-01],
       [  7.04350245e-01,   7.03704591e-01,   7.01409505e-01],
       [  7.08697179e-01,   7.08062844e-01,   7.05749174e-01],
       [  7.13057498e-01,   7.12434532e-01,   7.10102215e-01],
       [  7.17431320e-01,   7.16819771e-01,   7.14468744e-01],
       [  7.21818762e-01,   7.21218678e-01,   7.18848879e-01],
       [  7.26219942e-01,   7.25631372e-01,   7.23242737e-01],
       [  7.30634980e-01,   7.30057971e-01,   7.27650436e-01],
       [  7.35063996e-01,   7.34498593e-01,   7.32072096e-01],
       [  7.39507110e-01,   7.38953361e-01,   7.36507836e-01],
       [  7.43964444e-01,   7.43422394e-01,   7.40957778e-01],
       [  7.48436120e-01,   7.47905814e-01,   7.45422044e-01],
       [  7.52922262e-01,   7.52403745e-01,   7.49900755e-01],
       [  7.57422994e-01,   7.56916310e-01,   7.54394036e-01],
       [  7.61938441e-01,   7.61443634e-01,   7.58902010e-01],
       [  7.66468730e-01,   7.65985842e-01,   7.63424803e-01],
       [  7.71013986e-01,   7.70543061e-01,   7.67962541e-01],
       [  7.75574337e-01,   7.75115417e-01,   7.72515352e-01],
       [  7.80149914e-01,   7.79703039e-01,   7.77083362e-01],
       [  7.84740844e-01,   7.84306057e-01,   7.81666702e-01],
       [  7.89347260e-01,   7.88924601e-01,   7.86265501e-01],
       [  7.93969292e-01,   7.93558801e-01,   7.90879890e-01],
       [  7.98607074e-01,   7.98208791e-01,   7.95510001e-01],
       [  8.03260739e-01,   8.02874703e-01,   8.00155967e-01],
       [  8.07930423e-01,   8.07556672e-01,   8.04817922e-01],
       [  8.12616260e-01,   8.12254833e-01,   8.09496002e-01],
       [  8.17318389e-01,   8.16969322e-01,   8.14190342e-01],
       [  8.22036946e-01,   8.21700278e-01,   8.18901080e-01],
       [  8.26772072e-01,   8.26447838e-01,   8.23628354e-01],
       [  8.31523906e-01,   8.31212143e-01,   8.28372303e-01],
       [  8.36292590e-01,   8.35993334e-01,   8.33133069e-01],
       [  8.41078267e-01,   8.40791552e-01,   8.37910793e-01],
       [  8.45881080e-01,   8.45606941e-01,   8.42705617e-01],
       [  8.50701175e-01,   8.50439645e-01,   8.47517688e-01],
       [  8.55538697e-01,   8.55289811e-01,   8.52347148e-01],
       [  8.60393794e-01,   8.60157585e-01,   8.57194146e-01],
       [  8.65266615e-01,   8.65043115e-01,   8.62058830e-01],
       [  8.70157310e-01,   8.69946551e-01,   8.66941347e-01],
       [  8.75066030e-01,   8.74868043e-01,   8.71841849e-01],
       [  8.79992927e-01,   8.79807744e-01,   8.76760488e-01],
       [  8.84938156e-01,   8.84765807e-01,   8.81697416e-01],
       [  8.89901872e-01,   8.89742387e-01,   8.86652789e-01],
       [  8.94884232e-01,   8.94737639e-01,   8.91626761e-01],
       [  8.99885393e-01,   8.99751722e-01,   8.96619490e-01],
       [  9.04905514e-01,   9.04784795e-01,   9.01631134e-01],
       [  9.09944758e-01,   9.09837017e-01,   9.06661854e-01],
       [  9.15003286e-01,   9.14908550e-01,   9.11711812e-01],
       [  9.20081262e-01,   9.19999559e-01,   9.16781169e-01],
       [  9.25178851e-01,   9.25110207e-01,   9.21870090e-01],
       [  9.30296221e-01,   9.30240661e-01,   9.26978742e-01],
       [  9.35433539e-01,   9.35391088e-01,   9.32107291e-01],
       [  9.40590976e-01,   9.40561659e-01,   9.37255908e-01],
       [  9.45768702e-01,   9.45752544e-01,   9.42424761e-01],
       [  9.50966892e-01,   9.50963915e-01,   9.47614025e-01],
       [  9.56185720e-01,   9.56195948e-01,   9.52823871e-01],
       [  9.61425362e-01,   9.61448818e-01,   9.58054477e-01],
       [  9.66685997e-01,   9.66722702e-01,   9.63306019e-01],
       [  9.71967804e-01,   9.72017780e-01,   9.68578676e-01],
       [  9.77270966e-01,   9.77334232e-01,   9.73872629e-01],
       [  9.82595664e-01,   9.82672242e-01,   9.79188059e-01],
       [  9.87942085e-01,   9.88031995e-01,   9.84525152e-01],
       [  9.93310415e-01,   9.93413675e-01,   9.89884093e-01],
       [  9.98700843e-01,   9.98817473e-01,   9.95265069e-01]]

test_cm = LinearSegmentedColormap.from_list(__file__, cm_data)


if __name__ == "__main__":
    import matplotlib.pyplot as plt
    import numpy as np

    try:
        from pycam02ucs.cm.viscm import viscm
        viscm(test_cm)
    except ImportError:
        print("pycam02ucs not found, falling back on simple display")
        plt.imshow(np.linspace(0, 100, 256)[None, :], aspect='auto',
                   cmap=test_cm)
    plt.show()
