
from matplotlib.colors import LinearSegmentedColormap
from numpy import nan, inf

# Used to reconstruct the colormap in pycam02ucs.cm.viscm
parameters = {'xp': [18.910458754208776, 34.70906986531989, 44.43129208754209, 43.823653198653204, 32.278514309764319, -0.71960496217781156],
              'yp': [-15.451388888888857, -13.020833333333314, -6.3368055555555429, 16.753472222222229, 22.829861111111114, 15.377428998505223],
              'min_JK': 15.0,
              'max_JK': 95.0}

cm_data = [[ 0.20054623,  0.03825986,  0.23176441],
       [ 0.20540852,  0.03949321,  0.23518855],
       [ 0.21028196,  0.04070049,  0.23859182],
       [ 0.21516665,  0.04185585,  0.24197353],
       [ 0.22006265,  0.04296954,  0.24533293],
       [ 0.22497001,  0.04404228,  0.24866927],
       [ 0.22988877,  0.04507477,  0.25198178],
       [ 0.23481895,  0.0460677 ,  0.25526966],
       [ 0.23976058,  0.0470217 ,  0.25853209],
       [ 0.24471362,  0.04793744,  0.26176823],
       [ 0.24967807,  0.04881554,  0.26497721],
       [ 0.25465388,  0.04965666,  0.26815814],
       [ 0.25964114,  0.05046116,  0.27131013],
       [ 0.26463981,  0.05122967,  0.27443224],
       [ 0.26964965,  0.05196308,  0.2775235 ],
       [ 0.27467056,  0.0526621 ,  0.28058295],
       [ 0.27970241,  0.05332745,  0.2836096 ],
       [ 0.28474503,  0.05395991,  0.28660243],
       [ 0.28979827,  0.05456028,  0.28956042],
       [ 0.29486192,  0.0551294 ,  0.29248253],
       [ 0.29993578,  0.05566817,  0.2953677 ],
       [ 0.30501962,  0.05617755,  0.29821486],
       [ 0.31011317,  0.05665854,  0.30102294],
       [ 0.31521618,  0.05711222,  0.30379084],
       [ 0.32032834,  0.05753972,  0.30651747],
       [ 0.32544933,  0.05794227,  0.30920172],
       [ 0.33057966,  0.0583195 ,  0.3118423 ],
       [ 0.33571829,  0.05867409,  0.31443822],
       [ 0.34086472,  0.05900775,  0.31698841],
       [ 0.34601853,  0.05932204,  0.31949177],
       [ 0.35117932,  0.05961861,  0.32194722],
       [ 0.35634663,  0.0598992 ,  0.32435367],
       [ 0.36152001,  0.06016565,  0.32671007],
       [ 0.36669976,  0.06041823,  0.32901504],
       [ 0.37188497,  0.06065983,  0.33126768],
       [ 0.37707474,  0.06089341,  0.33346713],
       [ 0.38226854,  0.06112122,  0.33561244],
       [ 0.38746579,  0.06134563,  0.33770266],
       [ 0.39266608,  0.06156881,  0.33973682],
       [ 0.39786975,  0.06179128,  0.34171347],
       [ 0.4030751 ,  0.06201809,  0.34363238],
       [ 0.4082815 ,  0.06225201,  0.3454928 ],
       [ 0.41348833,  0.06249589,  0.347294  ],
       [ 0.4186954 ,  0.06275167,  0.34903496],
       [ 0.42390232,  0.06302176,  0.35071483],
       [ 0.42910766,  0.0633109 ,  0.35233359],
       [ 0.43431078,  0.06362221,  0.35389074],
       [ 0.43951115,  0.06395847,  0.35538572],
       [ 0.44470885,  0.06432118,  0.35681742],
       [ 0.44990222,  0.06471569,  0.35818641],
       [ 0.45509059,  0.06514518,  0.35949245],
       [ 0.46027352,  0.06561222,  0.36073513],
       [ 0.46545077,  0.06611896,  0.36191384],
       [ 0.4706209 ,  0.0666701 ,  0.36302936],
       [ 0.47578324,  0.06726859,  0.36408174],
       [ 0.48093762,  0.0679162 ,  0.36507051],
       [ 0.48608313,  0.06861617,  0.3659961 ],
       [ 0.4912188 ,  0.06937185,  0.36685921],
       [ 0.49634404,  0.07018548,  0.36766006],
       [ 0.5014587 ,  0.07105832,  0.36839838],
       [ 0.50656151,  0.07199386,  0.36907552],
       [ 0.51165185,  0.07299401,  0.36969204],
       [ 0.51672951,  0.0740596 ,  0.3702479 ],
       [ 0.52179354,  0.07519291,  0.3707443 ],
       [ 0.52684322,  0.07639551,  0.37118219],
       [ 0.53187819,  0.07766804,  0.37156199],
       [ 0.5368978 ,  0.07901156,  0.37188463],
       [ 0.5419013 ,  0.08042717,  0.3721514 ],
       [ 0.54688823,  0.08191515,  0.37236304],
       [ 0.5518581 ,  0.08347572,  0.37252042],
       [ 0.55681018,  0.08510941,  0.37262502],
       [ 0.56174398,  0.0868161 ,  0.37267783],
       [ 0.56665909,  0.08859543,  0.37267974],
       [ 0.57155481,  0.0904474 ,  0.37263234],
       [ 0.57643064,  0.09237152,  0.37253679],
       [ 0.58128619,  0.09436706,  0.37239406],
       [ 0.58612081,  0.09643359,  0.37220581],
       [ 0.59093402,  0.09857036,  0.37197331],
       [ 0.59572539,  0.10077641,  0.37169765],
       [ 0.60049434,  0.10305103,  0.37138049],
       [ 0.60524037,  0.10539328,  0.3710232 ],
       [ 0.60996305,  0.10780213,  0.37062699],
       [ 0.61466181,  0.11027667,  0.37019352],
       [ 0.61933615,  0.11281592,  0.36972423],
       [ 0.6239856 ,  0.11541882,  0.36922044],
       [ 0.62860961,  0.11808443,  0.36868382],
       [ 0.63320768,  0.12081175,  0.36811585],
       [ 0.63777929,  0.12359978,  0.36751798],
       [ 0.64232389,  0.1264476 ,  0.36689187],
       [ 0.64684096,  0.12935426,  0.36623907],
       [ 0.65132994,  0.13231886,  0.36556115],
       [ 0.65579027,  0.13534054,  0.36485976],
       [ 0.66022138,  0.13841845,  0.36413654],
       [ 0.6646227 ,  0.1415518 ,  0.36339316],
       [ 0.66899364,  0.14473979,  0.36263131],
       [ 0.6733336 ,  0.14798171,  0.36185269],
       [ 0.67764196,  0.15127683,  0.36105911],
       [ 0.6819181 ,  0.15462448,  0.3602523 ],
       [ 0.68616139,  0.15802403,  0.35943403],
       [ 0.69037117,  0.16147485,  0.3586063 ],
       [ 0.69454681,  0.16497635,  0.35777083],
       [ 0.69868764,  0.16852797,  0.35692951],
       [ 0.70279297,  0.17212914,  0.35608455],
       [ 0.70686214,  0.17577936,  0.35523767],
       [ 0.71089448,  0.17947812,  0.35439087],
       [ 0.71488927,  0.18322485,  0.35354658],
       [ 0.71884584,  0.18701911,  0.35270655],
       [ 0.7227635 ,  0.19086042,  0.35187286],
       [ 0.72664155,  0.19474818,  0.35104822],
       [ 0.73047933,  0.19868198,  0.35023437],
       [ 0.73427615,  0.20266134,  0.34943345],
       [ 0.73803136,  0.20668558,  0.34864844],
       [ 0.7417443 ,  0.21075427,  0.34788113],
       [ 0.74541431,  0.21486694,  0.34713367],
       [ 0.74904083,  0.21902277,  0.34640917],
       [ 0.75262325,  0.22322127,  0.34570967],
       [ 0.75616096,  0.22746195,  0.34503716],
       [ 0.75965349,  0.23174391,  0.34439471],
       [ 0.76310037,  0.2360664 ,  0.34378488],
       [ 0.76650102,  0.24042899,  0.34320932],
       [ 0.76985505,  0.24483084,  0.34267068],
       [ 0.7731623 ,  0.24927056,  0.34217261],
       [ 0.7764222 ,  0.25374798,  0.34171603],
       [ 0.77963442,  0.25826224,  0.34130324],
       [ 0.78279906,  0.26281172,  0.34093799],
       [ 0.78591581,  0.26739578,  0.34062184],
       [ 0.78898438,  0.27201381,  0.34035631],
       [ 0.79200466,  0.27666483,  0.34014354],
       [ 0.79497742,  0.28134638,  0.33998794],
       [ 0.79790205,  0.28605865,  0.33988929],
       [ 0.80077862,  0.29080061,  0.33984944],
       [ 0.80360728,  0.29557115,  0.3398702 ],
       [ 0.80638926,  0.30036754,  0.33995556],
       [ 0.80912407,  0.30518994,  0.34010513],
       [ 0.81181197,  0.31003735,  0.34032018],
       [ 0.81445334,  0.31490861,  0.3406021 ],
       [ 0.81704891,  0.31980215,  0.34095265],
       [ 0.81960008,  0.32471558,  0.34137435],
       [ 0.82210639,  0.32964923,  0.34186632],
       [ 0.82456843,  0.33460197,  0.34242947],
       [ 0.82698688,  0.33957263,  0.34306457],
       [ 0.82936241,  0.34456009,  0.34377227],
       [ 0.83169601,  0.34956294,  0.34455338],
       [ 0.83398947,  0.35457878,  0.34540946],
       [ 0.83624238,  0.35960816,  0.34633921],
       [ 0.83845555,  0.36465003,  0.34734279],
       [ 0.8406298 ,  0.36970342,  0.34842026],
       [ 0.842766  ,  0.37476737,  0.34957155],
       [ 0.84486499,  0.37984097,  0.35079649],
       [ 0.84692765,  0.38492332,  0.35209482],
       [ 0.84895486,  0.39001361,  0.35346618],
       [ 0.8509475 ,  0.39511102,  0.35491012],
       [ 0.85290643,  0.40021481,  0.35642611],
       [ 0.85483254,  0.40532428,  0.35801355],
       [ 0.85672667,  0.41043875,  0.35967177],
       [ 0.85858969,  0.41555761,  0.36140003],
       [ 0.86042241,  0.4206803 ,  0.36319753],
       [ 0.86222566,  0.42580627,  0.36506342],
       [ 0.86400022,  0.43093507,  0.36699683],
       [ 0.86574688,  0.43606624,  0.36899682],
       [ 0.86746636,  0.44119939,  0.37106242],
       [ 0.86915941,  0.44633418,  0.37319267],
       [ 0.87082669,  0.4514703 ,  0.37538654],
       [ 0.87246888,  0.45660748,  0.37764301],
       [ 0.87408661,  0.46174549,  0.37996106],
       [ 0.87568047,  0.46688414,  0.38233963],
       [ 0.87725104,  0.47202326,  0.3847777 ],
       [ 0.87879886,  0.47716275,  0.38727421],
       [ 0.88032442,  0.4823025 ,  0.38982813],
       [ 0.88182954,  0.48744136,  0.39243859],
       [ 0.88331667,  0.49257766,  0.39510468],
       [ 0.88478338,  0.49771382,  0.39782499],
       [ 0.88623008,  0.50284984,  0.40059853],
       [ 0.88765711,  0.50798578,  0.40342432],
       [ 0.88906481,  0.51312171,  0.40630139],
       [ 0.89045347,  0.51825771,  0.40922881],
       [ 0.89183048,  0.52338847,  0.41220557],
       [ 0.89318961,  0.52851917,  0.41523064],
       [ 0.89453101,  0.53365002,  0.41830314],
       [ 0.89585486,  0.53878119,  0.42142224],
       [ 0.89716208,  0.54391231,  0.42458706],
       [ 0.8984608 ,  0.54903783,  0.42779611],
       [ 0.89974298,  0.55416395,  0.43104908],
       [ 0.90100872,  0.5592909 ,  0.43434525],
       [ 0.90225809,  0.56441891,  0.43768391],
       [ 0.9035011 ,  0.56954132,  0.44106304],
       [ 0.90472979,  0.57466405,  0.44448283],
       [ 0.90594279,  0.57978832,  0.44794283],
       [ 0.90714147,  0.58491346,  0.4514422 ],
       [ 0.9083363 ,  0.5900328 ,  0.45497852],
       [ 0.90951595,  0.59515425,  0.45855298],
       [ 0.91068032,  0.60027809,  0.46216509],
       [ 0.91183886,  0.60539849,  0.46581244],
       [ 0.9129877 ,  0.6105183 ,  0.46949513],
       [ 0.91412155,  0.61564116,  0.47321373],
       [ 0.91524694,  0.62076321,  0.47696634],
       [ 0.91636709,  0.62588278,  0.48075165],
       [ 0.91747237,  0.63100611,  0.48457137],
       [ 0.9185689 ,  0.63612968,  0.48842364],
       [ 0.91966206,  0.64125058,  0.49230662],
       [ 0.92074034,  0.64637597,  0.49622275],
       [ 0.92181206,  0.65150116,  0.50016953],
       [ 0.92287953,  0.65662508,  0.50414587],
       [ 0.923932  ,  0.66175428,  0.50815435],
       [ 0.92498269,  0.66688133,  0.51219094],
       [ 0.92602545,  0.67201008,  0.51625701],
       [ 0.92705295,  0.67714488,  0.5203544 ],
       [ 0.92808616,  0.68227421,  0.52447663],
       [ 0.92910484,  0.68740967,  0.52862941],
       [ 0.93011635,  0.69254734,  0.53281031],
       [ 0.93112698,  0.69768408,  0.53701711],
       [ 0.93212194,  0.70282814,  0.54125422],
       [ 0.93312141,  0.70796888,  0.54551505],
       [ 0.93410892,  0.71311537,  0.54980465],
       [ 0.93509005,  0.71826484,  0.55412109],
       [ 0.93607073,  0.72341444,  0.55846224],
       [ 0.93703512,  0.72857259,  0.56283327],
       [ 0.9380092 ,  0.73372614,  0.56722529],
       [ 0.93896714,  0.73888855,  0.57164697],
       [ 0.93992609,  0.7440513 ,  0.57609238],
       [ 0.94087812,  0.74921861,  0.58056418],
       [ 0.94182314,  0.75439073,  0.58506238],
       [ 0.94276979,  0.75956359,  0.58958388],
       [ 0.94370212,  0.76474522,  0.5941344 ],
       [ 0.9446439 ,  0.76992426,  0.59870531],
       [ 0.94556827,  0.77511389,  0.60330647],
       [ 0.94650226,  0.78030136,  0.60792794],
       [ 0.94742214,  0.78549816,  0.61257858],
       [ 0.94834679,  0.79069557,  0.61725138],
       [ 0.94926278,  0.79590009,  0.6219515 ],
       [ 0.95017954,  0.80110752,  0.62667542],
       [ 0.95109233,  0.80632025,  0.63142505],
       [ 0.95200272,  0.81153775,  0.63619989],
       [ 0.9529131 ,  0.81675915,  0.64099911],
       [ 0.95381878,  0.82198674,  0.64582468],
       [ 0.95472765,  0.8272172 ,  0.65067356],
       [ 0.95563043,  0.83245484,  0.65554959],
       [ 0.95653884,  0.83769472,  0.66044816],
       [ 0.95744066,  0.84294235,  0.66537434],
       [ 0.95834983,  0.84819193,  0.67032252],
       [ 0.95925283,  0.85344945,  0.67529836],
       [ 0.96016411,  0.85870897,  0.68029595],
       [ 0.9610706 ,  0.86397624,  0.68532081],
       [ 0.96198556,  0.86924591,  0.69036741],
       [ 0.96289801,  0.87452276,  0.69544042],
       [ 0.96381835,  0.87980273,  0.70053539],
       [ 0.96473941,  0.885089  ,  0.70565538],
       [ 0.96566702,  0.89037943,  0.71079781],
       [ 0.96659945,  0.89567495,  0.71596332],
       [ 0.96753633,  0.90097597,  0.72115196],
       [ 0.96848301,  0.90628062,  0.72636119],
       [ 0.96943123,  0.91159241,  0.73159444],
       [ 0.97039506,  0.9169061 ,  0.7368452 ],
       [ 0.97135672,  0.92222887,  0.74212111],
       [ 0.97234058,  0.92755161,  0.74741087],
       [ 0.97331776,  0.93288565,  0.75272708]]

test_cm = LinearSegmentedColormap.from_list(__file__, cm_data)


if __name__ == "__main__":
    import matplotlib.pyplot as plt
    import numpy as np

    try:
        from pycam02ucs.cm.viscm import viscm
        viscm(test_cm)
    except ImportError:
        print("pycam02ucs not found, falling back on simple display")
        plt.imshow(np.linspace(0, 100, 256)[None, :], aspect='auto',
                   cmap=test_cm)
    plt.show()
