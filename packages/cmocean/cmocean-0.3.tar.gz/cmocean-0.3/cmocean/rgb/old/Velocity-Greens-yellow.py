
from matplotlib.colors import LinearSegmentedColormap
from numpy import nan, inf

# Used to reconstruct the colormap in pycam02ucs.cm.viscm
parameters = {'xp': [-9.21329491069011, -24.89506505028251, -30.264905310379675, -33.567972539269306, -0.16121776687575107, -1.7673117463177732, -4.81920109866169],
              'yp': [13.043267365153298, 9.994493392070467, 19.494567326348488, 36.33443465491922, 43.080029368575595, 24.12812041116004, 19.182724335414132],
              'min_Jp': 15.0,
              'max_Jp': 98.6953062848}

cm_data = [[ 0.08929866,  0.13741248,  0.03452094],
       [ 0.09054617,  0.1410393 ,  0.03754366],
       [ 0.09176466,  0.14465839,  0.04067537],
       [ 0.09294486,  0.14827261,  0.04378867],
       [ 0.09408728,  0.15188231,  0.04687085],
       [ 0.09519998,  0.15548602,  0.04992144],
       [ 0.09626651,  0.15908813,  0.05294338],
       [ 0.09730179,  0.16268548,  0.05593501],
       [ 0.09830162,  0.16627946,  0.05889728],
       [ 0.0992583 ,  0.16987223,  0.06183111],
       [ 0.10018314,  0.1734615 ,  0.06473556],
       [ 0.10106792,  0.17704949,  0.06761138],
       [ 0.10191164,  0.18063669,  0.0704585 ],
       [ 0.10272178,  0.18422173,  0.0732765 ],
       [ 0.10348948,  0.18780681,  0.07606561],
       [ 0.10421552,  0.19139199,  0.07882551],
       [ 0.10490603,  0.19497617,  0.08155594],
       [ 0.10555423,  0.19856102,  0.08425669],
       [ 0.10615741,  0.20214728,  0.08692733],
       [ 0.10672299,  0.20573355,  0.0895677 ],
       [ 0.10724914,  0.20932042,  0.09217748],
       [ 0.10772411,  0.2129104 ,  0.09475564],
       [ 0.10815944,  0.21650127,  0.09730234],
       [ 0.10855436,  0.22009333,  0.09981718],
       [ 0.10890281,  0.22368788,  0.10229922],
       [ 0.10920287,  0.22728538,  0.1047477 ],
       [ 0.10946065,  0.23088473,  0.10716269],
       [ 0.10967548,  0.23448614,  0.10954363],
       [ 0.10984259,  0.23809059,  0.11188938],
       [ 0.10995931,  0.24169861,  0.1141989 ],
       [ 0.11003171,  0.24530912,  0.11647235],
       [ 0.11005932,  0.24892228,  0.11870907],
       [ 0.11004173,  0.25253821,  0.12090834],
       [ 0.10997235,  0.25615809,  0.12306827],
       [ 0.10985514,  0.25978124,  0.12518872],
       [ 0.10969253,  0.26340729,  0.12726934],
       [ 0.10948453,  0.26703625,  0.12930933],
       [ 0.10923128,  0.27066815,  0.13130784],
       [ 0.10893305,  0.27430298,  0.13326404],
       [ 0.10858415,  0.27794168,  0.13517562],
       [ 0.10819151,  0.28158316,  0.13704308],
       [ 0.10775624,  0.28522728,  0.1388656 ],
       [ 0.10727939,  0.28887395,  0.1406423 ],
       [ 0.10676222,  0.29252303,  0.14237229],
       [ 0.10620626,  0.29617436,  0.14405467],
       [ 0.10561332,  0.29982778,  0.14568856],
       [ 0.10498551,  0.30348308,  0.14727308],
       [ 0.10432407,  0.30714019,  0.14880698],
       [ 0.1036313 ,  0.31079893,  0.15028923],
       [ 0.10291254,  0.31445872,  0.15171962],
       [ 0.10217137,  0.31811925,  0.15309732],
       [ 0.10141182,  0.32178021,  0.15442156],
       [ 0.10063841,  0.32544125,  0.15569156],
       [ 0.09985615,  0.32910201,  0.15690661],
       [ 0.09907055,  0.3327621 ,  0.158066  ],
       [ 0.09828771,  0.33642112,  0.1591691 ],
       [ 0.09751426,  0.34007863,  0.16021528],
       [ 0.09675744,  0.34373419,  0.16120401],
       [ 0.09602508,  0.34738734,  0.16213476],
       [ 0.09532558,  0.3510376 ,  0.16300709],
       [ 0.09466796,  0.35468447,  0.16382061],
       [ 0.09406177,  0.35832746,  0.16457499],
       [ 0.09351712,  0.36196603,  0.16526997],
       [ 0.09304457,  0.36559967,  0.16590535],
       [ 0.09265511,  0.36922783,  0.16648102],
       [ 0.09236005,  0.37284997,  0.16699693],
       [ 0.09217091,  0.37646555,  0.1674531 ],
       [ 0.0920993 ,  0.38007401,  0.16784965],
       [ 0.09215678,  0.38367481,  0.16818676],
       [ 0.09235471,  0.38726739,  0.16846469],
       [ 0.09270407,  0.3908512 ,  0.16868381],
       [ 0.09321449,  0.39442579,  0.16884397],
       [ 0.09389659,  0.39799053,  0.16894628],
       [ 0.0947592 ,  0.40154488,  0.16899137],
       [ 0.09581009,  0.40508832,  0.16897995],
       [ 0.09705585,  0.40862036,  0.1689128 ],
       [ 0.09850181,  0.41214049,  0.1687908 ],
       [ 0.10015192,  0.41564825,  0.1686149 ],
       [ 0.10200879,  0.41914318,  0.16838614],
       [ 0.10407361,  0.42262485,  0.16810564],
       [ 0.10634625,  0.42609283,  0.16777459],
       [ 0.10882531,  0.42954674,  0.16739428],
       [ 0.11150814,  0.43298622,  0.16696588],
       [ 0.11439113,  0.4364109 ,  0.16649095],
       [ 0.11746971,  0.43982046,  0.16597113],
       [ 0.12073846,  0.44321461,  0.16540798],
       [ 0.12419127,  0.44659309,  0.16480312],
       [ 0.1278215 ,  0.44995565,  0.16415826],
       [ 0.13162213,  0.45330209,  0.16347513],
       [ 0.13558584,  0.45663223,  0.16275555],
       [ 0.13970515,  0.45994591,  0.16200135],
       [ 0.1439725 ,  0.46324301,  0.16121447],
       [ 0.14838026,  0.46652343,  0.16039711],
       [ 0.15292096,  0.46978711,  0.15955114],
       [ 0.15758725,  0.473034  ,  0.15867856],
       [ 0.16237195,  0.47626411,  0.15778143],
       [ 0.1672681 ,  0.47947743,  0.15686186],
       [ 0.17226899,  0.48267401,  0.15592199],
       [ 0.17736816,  0.48585391,  0.154964  ],
       [ 0.18255942,  0.48901722,  0.15399008],
       [ 0.18783688,  0.49216403,  0.15300246],
       [ 0.19319491,  0.49529449,  0.1520034 ],
       [ 0.19862816,  0.49840874,  0.15099521],
       [ 0.20413118,  0.50150699,  0.14998083],
       [ 0.20969955,  0.50458939,  0.14896196],
       [ 0.21532876,  0.50765614,  0.14794096],
       [ 0.22101455,  0.51070747,  0.14692019],
       [ 0.22675291,  0.51374361,  0.14590206],
       [ 0.23254008,  0.5167648 ,  0.14488898],
       [ 0.2383725 ,  0.51977129,  0.1438834 ],
       [ 0.24424686,  0.52276337,  0.14288778],
       [ 0.25016001,  0.5257413 ,  0.14190463],
       [ 0.25610904,  0.52870536,  0.14093644],
       [ 0.26209121,  0.53165586,  0.13998578],
       [ 0.26810392,  0.5345931 ,  0.1390552 ],
       [ 0.27414479,  0.53751738,  0.1381473 ],
       [ 0.28021155,  0.54042901,  0.13726468],
       [ 0.2863021 ,  0.54332831,  0.13640999],
       [ 0.29241447,  0.54621559,  0.13558588],
       [ 0.29854681,  0.54909119,  0.13479504],
       [ 0.3046974 ,  0.55195542,  0.13404015],
       [ 0.31086463,  0.55480861,  0.13332394],
       [ 0.31704699,  0.55765109,  0.13264913],
       [ 0.32324298,  0.56048321,  0.13201858],
       [ 0.32945137,  0.56330527,  0.13143492],
       [ 0.33567097,  0.5661176 ,  0.13090086],
       [ 0.34190065,  0.56892052,  0.13041912],
       [ 0.34813931,  0.57171438,  0.12999245],
       [ 0.35438596,  0.57449948,  0.12962357],
       [ 0.36063965,  0.57727616,  0.12931517],
       [ 0.3668995 ,  0.58004474,  0.12906991],
       [ 0.37316468,  0.58280554,  0.12889044],
       [ 0.3794344 ,  0.5855589 ,  0.12877934],
       [ 0.38570794,  0.58830513,  0.12873913],
       [ 0.3919846 ,  0.59104454,  0.1287723 ],
       [ 0.39826373,  0.59377747,  0.12888124],
       [ 0.40454465,  0.59650424,  0.12906832],
       [ 0.4108268 ,  0.59922517,  0.12933578],
       [ 0.41710965,  0.60194056,  0.12968569],
       [ 0.42339268,  0.60465074,  0.13012011],
       [ 0.4296754 ,  0.60735601,  0.13064095],
       [ 0.4359573 ,  0.61005669,  0.13125003],
       [ 0.44223793,  0.6127531 ,  0.13194904],
       [ 0.44851684,  0.61544555,  0.13273953],
       [ 0.4547936 ,  0.61813435,  0.13362296],
       [ 0.46106776,  0.62081983,  0.13460064],
       [ 0.46733893,  0.6235023 ,  0.13567373],
       [ 0.47360668,  0.62618207,  0.13684328],
       [ 0.47987063,  0.62885948,  0.13811022],
       [ 0.48613036,  0.63153483,  0.13947532],
       [ 0.49238548,  0.63420845,  0.14093926],
       [ 0.4986356 ,  0.63688068,  0.14250257],
       [ 0.50488031,  0.63955183,  0.14416568],
       [ 0.51111921,  0.64222224,  0.14592892],
       [ 0.5173519 ,  0.64489224,  0.1477925 ],
       [ 0.52357796,  0.64756218,  0.14975654],
       [ 0.52979697,  0.6502324 ,  0.15182107],
       [ 0.53600851,  0.65290325,  0.15398606],
       [ 0.54221213,  0.65557508,  0.15625138],
       [ 0.54840739,  0.65824825,  0.15861687],
       [ 0.55459382,  0.66092312,  0.16108227],
       [ 0.56077094,  0.66360008,  0.16364732],
       [ 0.56693827,  0.66627949,  0.1663117 ],
       [ 0.57309528,  0.66896175,  0.16907505],
       [ 0.57924146,  0.67164724,  0.17193702],
       [ 0.58537625,  0.67433637,  0.17489721],
       [ 0.59149909,  0.67702956,  0.17795522],
       [ 0.59760938,  0.67972723,  0.18111065],
       [ 0.60370651,  0.68242979,  0.18436309],
       [ 0.60978984,  0.68513771,  0.18771216],
       [ 0.61585871,  0.68785143,  0.19115747],
       [ 0.62191242,  0.69057142,  0.19469863],
       [ 0.62795027,  0.69329814,  0.19833528],
       [ 0.6339715 ,  0.69603211,  0.20206708],
       [ 0.63997533,  0.6987738 ,  0.20589371],
       [ 0.64596096,  0.70152375,  0.20981485],
       [ 0.65192755,  0.70428248,  0.2138302 ],
       [ 0.65787423,  0.70705054,  0.2179395 ],
       [ 0.6638001 ,  0.70982849,  0.22214249],
       [ 0.66970422,  0.7126169 ,  0.22643892],
       [ 0.67558562,  0.71541636,  0.23082856],
       [ 0.68144331,  0.71822749,  0.23531118],
       [ 0.68727624,  0.72105089,  0.23988656],
       [ 0.69308336,  0.72388722,  0.24455449],
       [ 0.69886357,  0.72673711,  0.24931473],
       [ 0.70461573,  0.72960125,  0.25416705],
       [ 0.7103387 ,  0.73248032,  0.2591112 ],
       [ 0.71603129,  0.73537501,  0.26414692],
       [ 0.72169229,  0.73828603,  0.2692739 ],
       [ 0.72732048,  0.74121412,  0.27449181],
       [ 0.7329146 ,  0.74416001,  0.27980029],
       [ 0.73847338,  0.74712444,  0.28519891],
       [ 0.74399556,  0.75010818,  0.29068719],
       [ 0.74947984,  0.75311199,  0.29626462],
       [ 0.75492494,  0.75613665,  0.30193058],
       [ 0.76032957,  0.75918292,  0.30768439],
       [ 0.76569244,  0.76225159,  0.31352531],
       [ 0.77101229,  0.76534344,  0.31945247],
       [ 0.77628788,  0.76845923,  0.32546495],
       [ 0.78151797,  0.77159975,  0.33156171],
       [ 0.78670138,  0.77476574,  0.33774162],
       [ 0.79183695,  0.77795795,  0.34400341],
       [ 0.79692362,  0.78117711,  0.35034586],
       [ 0.80196041,  0.78442388,  0.35676769],
       [ 0.80694617,  0.78769904,  0.36326699],
       [ 0.81187998,  0.79100326,  0.36984208],
       [ 0.81676099,  0.79433717,  0.37649115],
       [ 0.82158842,  0.7977014 ,  0.38321229],
       [ 0.82636158,  0.80109653,  0.3900035 ],
       [ 0.83107987,  0.80452309,  0.39686267],
       [ 0.83574279,  0.8079816 ,  0.40378761],
       [ 0.84034992,  0.81147253,  0.41077603],
       [ 0.84490094,  0.8149963 ,  0.41782557],
       [ 0.84939565,  0.8185533 ,  0.42493381],
       [ 0.85383394,  0.82214386,  0.43209832],
       [ 0.85821579,  0.8257683 ,  0.43931653],
       [ 0.8625413 ,  0.82942685,  0.4465858 ],
       [ 0.86681065,  0.83311975,  0.45390354],
       [ 0.87102414,  0.83684715,  0.46126715],
       [ 0.87518214,  0.84060917,  0.468674  ],
       [ 0.87928513,  0.8444059 ,  0.47612149],
       [ 0.88333366,  0.84823739,  0.48360702],
       [ 0.88732835,  0.85210364,  0.49112801],
       [ 0.8912699 ,  0.85600463,  0.4986819 ],
       [ 0.89515909,  0.85994031,  0.50626618],
       [ 0.89899674,  0.86391058,  0.51387842],
       [ 0.90278371,  0.86791534,  0.52151625],
       [ 0.90652092,  0.87195445,  0.5291773 ],
       [ 0.91020933,  0.87602775,  0.53685925],
       [ 0.91384992,  0.88013509,  0.54455987],
       [ 0.91744369,  0.88427628,  0.55227697],
       [ 0.92099167,  0.88845112,  0.56000842],
       [ 0.92449489,  0.89265942,  0.56775214],
       [ 0.92795438,  0.89690097,  0.5755061 ],
       [ 0.93137118,  0.90117557,  0.58326831],
       [ 0.93474624,  0.90548302,  0.5910372 ],
       [ 0.93808035,  0.90982317,  0.59881166],
       [ 0.94137464,  0.91419581,  0.60658906],
       [ 0.94463004,  0.91860078,  0.61436757],
       [ 0.94784746,  0.92303793,  0.62214535],
       [ 0.95102776,  0.92750713,  0.62992054],
       [ 0.95417175,  0.93200827,  0.63769122],
       [ 0.95728022,  0.93654126,  0.64545539],
       [ 0.96035276,  0.9411063 ,  0.65321434],
       [ 0.96339016,  0.94570334,  0.660965  ],
       [ 0.96639343,  0.95033236,  0.66870356],
       [ 0.96936303,  0.95499346,  0.67642735],
       [ 0.97229942,  0.95968679,  0.6841333 ],
       [ 0.97519962,  0.96441329,  0.69182588],
       [ 0.97806459,  0.96917317,  0.69949847],
       [ 0.98089584,  0.97396654,  0.70714263],
       [ 0.98369078,  0.97879456,  0.71475795],
       [ 0.98644378,  0.98365931,  0.72234757],
       [ 0.98916124,  0.98856015,  0.72988738],
       [ 0.99182806,  0.99350201,  0.73739211],
       [ 0.99445425,  0.99848393,  0.74482314]]

test_cm = LinearSegmentedColormap.from_list(__file__, cm_data)


if __name__ == "__main__":
    import matplotlib.pyplot as plt
    import numpy as np

    try:
        from pycam02ucs.cm.viscm import viscm
        viscm(test_cm)
    except ImportError:
        print("pycam02ucs not found, falling back on simple display")
        plt.imshow(np.linspace(0, 100, 256)[None, :], aspect='auto',
                   cmap=test_cm)
    plt.show()
