
from matplotlib.colors import LinearSegmentedColormap
from numpy import nan, inf

# Used to reconstruct the colormap in pycam02ucs.cm.viscm
parameters = {'xp': [0.82688650450793943, -1.2822732751063768],
              'yp': [-0.69731404958676535, 0.20661157024792942],
              'min_Jp': 0.0378071833648,
              'max_Jp': 99.9747952111}

cm_data = [[             nan,              nan,              nan],
       [  3.58418139e-04,   2.21420896e-04,   3.80042345e-04],
       [  1.02846288e-03,   7.72250383e-04,   1.05619412e-03],
       [  1.98746953e-03,   1.60340966e-03,   2.01845060e-03],
       [  3.21451678e-03,   2.69548027e-03,   3.24590504e-03],
       [  4.69645118e-03,   4.03645653e-03,   4.72552768e-03],
       [  6.42408742e-03,   5.61802435e-03,   6.44824400e-03],
       [  8.39062496e-03,   7.43406723e-03,   8.40734532e-03],
       [  1.05908427e-02,   9.47991833e-03,   1.05976866e-02],
       [  1.30206366e-02,   1.17519343e-02,   1.30152273e-02],
       [  1.56767308e-02,   1.42472302e-02,   1.56567453e-02],
       [  1.85564867e-02,   1.69635050e-02,   1.85196474e-02],
       [  2.16577697e-02,   1.98989192e-02,   2.16018380e-02],
       [  2.49788537e-02,   2.30520080e-02,   2.49016241e-02],
       [  2.85183496e-02,   2.64216162e-02,   2.84176453e-02],
       [  3.22751520e-02,   3.00068485e-02,   3.21488202e-02],
       [  3.62483963e-02,   3.38070316e-02,   3.60943049e-02],
       [  4.04374260e-02,   3.78216835e-02,   4.02534604e-02],
       [  4.46385825e-02,   4.20057960e-02,   4.44383759e-02],
       [  4.87933792e-02,   4.61514994e-02,   4.85744609e-02],
       [  5.29055699e-02,   5.02556702e-02,   5.26682538e-02],
       [  5.69783284e-02,   5.43214178e-02,   5.67229017e-02],
       [  6.10144910e-02,   5.83515193e-02,   6.07412167e-02],
       [  6.50166055e-02,   6.23484682e-02,   6.47257257e-02],
       [  6.89869725e-02,   6.63145149e-02,   6.86787097e-02],
       [  7.29276785e-02,   7.02516996e-02,   7.26022379e-02],
       [  7.68406234e-02,   7.41618795e-02,   7.64981945e-02],
       [  8.07275445e-02,   7.80467520e-02,   8.03683019e-02],
       [  8.45900355e-02,   8.19078739e-02,   8.42141404e-02],
       [  8.84295633e-02,   8.57466778e-02,   8.80371648e-02],
       [  9.22474826e-02,   8.95644860e-02,   9.18387178e-02],
       [  9.60450476e-02,   9.33625227e-02,   9.56200431e-02],
       [  9.98234229e-02,   9.71419241e-02,   9.93822949e-02],
       [  1.03583692e-01,   1.00903748e-01,   1.03126548e-01],
       [  1.07326868e-01,   1.04648980e-01,   1.06853804e-01],
       [  1.11053894e-01,   1.08378542e-01,   1.10565001e-01],
       [  1.14765659e-01,   1.12093299e-01,   1.14261017e-01],
       [  1.18462994e-01,   1.15794062e-01,   1.17942677e-01],
       [  1.22146681e-01,   1.19481593e-01,   1.21610755e-01],
       [  1.25817460e-01,   1.23156611e-01,   1.25265984e-01],
       [  1.29476027e-01,   1.26819794e-01,   1.28909053e-01],
       [  1.33123041e-01,   1.30471784e-01,   1.32540615e-01],
       [  1.36759126e-01,   1.34113189e-01,   1.36161287e-01],
       [  1.40384874e-01,   1.37744584e-01,   1.39771656e-01],
       [  1.44000847e-01,   1.41366515e-01,   1.43372279e-01],
       [  1.47607582e-01,   1.44979505e-01,   1.46963684e-01],
       [  1.51205587e-01,   1.48584047e-01,   1.50546376e-01],
       [  1.54795350e-01,   1.52180614e-01,   1.54120836e-01],
       [  1.58377333e-01,   1.55769657e-01,   1.57687524e-01],
       [  1.61951982e-01,   1.59351607e-01,   1.61246877e-01],
       [  1.65519721e-01,   1.62926877e-01,   1.64799317e-01],
       [  1.69080958e-01,   1.66495861e-01,   1.68345246e-01],
       [  1.72636084e-01,   1.70058938e-01,   1.71885049e-01],
       [  1.76185473e-01,   1.73616471e-01,   1.75419098e-01],
       [  1.79729487e-01,   1.77168811e-01,   1.78947749e-01],
       [  1.83268472e-01,   1.80716292e-01,   1.82471345e-01],
       [  1.86802764e-01,   1.84259239e-01,   1.85990215e-01],
       [  1.90332684e-01,   1.87797963e-01,   1.89504678e-01],
       [  1.93858544e-01,   1.91332764e-01,   1.93015042e-01],
       [  1.97380644e-01,   1.94863933e-01,   1.96521601e-01],
       [  2.00899274e-01,   1.98391750e-01,   2.00024644e-01],
       [  2.04414716e-01,   2.01916486e-01,   2.03524446e-01],
       [  2.07927241e-01,   2.05438402e-01,   2.07021278e-01],
       [  2.11437114e-01,   2.08957753e-01,   2.10515397e-01],
       [  2.14944588e-01,   2.12474784e-01,   2.14007057e-01],
       [  2.18449914e-01,   2.15989735e-01,   2.17496502e-01],
       [  2.21953331e-01,   2.19502835e-01,   2.20983971e-01],
       [  2.25455073e-01,   2.23014311e-01,   2.24469693e-01],
       [  2.28955369e-01,   2.26524381e-01,   2.27953894e-01],
       [  2.32454439e-01,   2.30033256e-01,   2.31436793e-01],
       [  2.35952500e-01,   2.33541144e-01,   2.34918602e-01],
       [  2.39449761e-01,   2.37048246e-01,   2.38399529e-01],
       [  2.42946426e-01,   2.40554758e-01,   2.41879778e-01],
       [  2.46442697e-01,   2.44060870e-01,   2.45359546e-01],
       [  2.49938767e-01,   2.47566770e-01,   2.48839026e-01],
       [  2.53434828e-01,   2.51072640e-01,   2.52318407e-01],
       [  2.56931064e-01,   2.54578657e-01,   2.55797876e-01],
       [  2.60427659e-01,   2.58084994e-01,   2.59277611e-01],
       [  2.63924788e-01,   2.61591823e-01,   2.62757793e-01],
       [  2.67422627e-01,   2.65099309e-01,   2.66238593e-01],
       [  2.70921345e-01,   2.68607615e-01,   2.69720184e-01],
       [  2.74421109e-01,   2.72116901e-01,   2.73202732e-01],
       [  2.77922082e-01,   2.75627322e-01,   2.76686402e-01],
       [  2.81424423e-01,   2.79139033e-01,   2.80171357e-01],
       [  2.84928288e-01,   2.82652184e-01,   2.83657756e-01],
       [  2.88433831e-01,   2.86166922e-01,   2.87145755e-01],
       [  2.91941202e-01,   2.89683394e-01,   2.90635509e-01],
       [  2.95450547e-01,   2.93201741e-01,   2.94127170e-01],
       [  2.98962012e-01,   2.96722105e-01,   2.97620888e-01],
       [  3.02475736e-01,   3.00244624e-01,   3.01116812e-01],
       [  3.05991859e-01,   3.03769434e-01,   3.04615087e-01],
       [  3.09510516e-01,   3.07296670e-01,   3.08115858e-01],
       [  3.13031840e-01,   3.10826464e-01,   3.11619267e-01],
       [  3.16555960e-01,   3.14358948e-01,   3.15125454e-01],
       [  3.20083004e-01,   3.17894250e-01,   3.18634560e-01],
       [  3.23613098e-01,   3.21432500e-01,   3.22146722e-01],
       [  3.27146362e-01,   3.24973822e-01,   3.25662075e-01],
       [  3.30682916e-01,   3.28518343e-01,   3.29180754e-01],
       [  3.34222878e-01,   3.32066187e-01,   3.32702891e-01],
       [  3.37766361e-01,   3.35617476e-01,   3.36228618e-01],
       [  3.41313476e-01,   3.39172332e-01,   3.39758065e-01],
       [  3.44864335e-01,   3.42730877e-01,   3.43291359e-01],
       [  3.48419042e-01,   3.46293231e-01,   3.46828627e-01],
       [  3.51977704e-01,   3.49859513e-01,   3.50369993e-01],
       [  3.55540422e-01,   3.53429842e-01,   3.53915580e-01],
       [  3.59107296e-01,   3.57004335e-01,   3.57465508e-01],
       [  3.62678424e-01,   3.60583110e-01,   3.61019898e-01],
       [  3.66253904e-01,   3.64166284e-01,   3.64578865e-01],
       [  3.69833828e-01,   3.67753973e-01,   3.68142525e-01],
       [  3.73418291e-01,   3.71346291e-01,   3.71710991e-01],
       [  3.77007383e-01,   3.74943355e-01,   3.75284372e-01],
       [  3.80601195e-01,   3.78545278e-01,   3.78862778e-01],
       [  3.84199816e-01,   3.82152173e-01,   3.82446315e-01],
       [  3.87803334e-01,   3.85764155e-01,   3.86035087e-01],
       [  3.91411837e-01,   3.89381335e-01,   3.89629196e-01],
       [  3.95025412e-01,   3.93003824e-01,   3.93228741e-01],
       [  3.98644147e-01,   3.96631734e-01,   3.96833819e-01],
       [  4.02268128e-01,   4.00265176e-01,   4.00444528e-01],
       [  4.05897443e-01,   4.03904257e-01,   4.04060959e-01],
       [  4.09532180e-01,   4.07549087e-01,   4.07683206e-01],
       [  4.13172425e-01,   4.11199774e-01,   4.11311358e-01],
       [  4.16818269e-01,   4.14856424e-01,   4.14945504e-01],
       [  4.20469800e-01,   4.18519143e-01,   4.18585732e-01],
       [  4.24127108e-01,   4.22188037e-01,   4.22232128e-01],
       [  4.27790284e-01,   4.25863209e-01,   4.25884777e-01],
       [  4.31459421e-01,   4.29544763e-01,   4.29543764e-01],
       [  4.35134610e-01,   4.33232802e-01,   4.33209174e-01],
       [  4.38815945e-01,   4.36927426e-01,   4.36881089e-01],
       [  4.42503520e-01,   4.40628737e-01,   4.40559593e-01],
       [  4.46197432e-01,   4.44336835e-01,   4.44244769e-01],
       [  4.49897775e-01,   4.48051819e-01,   4.47936701e-01],
       [  4.53604648e-01,   4.51773787e-01,   4.51635472e-01],
       [  4.57318146e-01,   4.55502838e-01,   4.55341164e-01],
       [  4.61038368e-01,   4.59239069e-01,   4.59053863e-01],
       [  4.64765414e-01,   4.62982577e-01,   4.62773652e-01],
       [  4.68499381e-01,   4.66733458e-01,   4.66500617e-01],
       [  4.72240370e-01,   4.70491808e-01,   4.70234841e-01],
       [  4.75988480e-01,   4.74257723e-01,   4.73976411e-01],
       [  4.79743812e-01,   4.78031297e-01,   4.77725413e-01],
       [  4.83506466e-01,   4.81812626e-01,   4.81481935e-01],
       [  4.87276543e-01,   4.85601804e-01,   4.85246062e-01],
       [  4.91054143e-01,   4.89398926e-01,   4.89017885e-01],
       [  4.94839368e-01,   4.93204085e-01,   4.92797491e-01],
       [  4.98632318e-01,   4.97017376e-01,   4.96584969e-01],
       [  5.02433095e-01,   5.00838894e-01,   5.00380410e-01],
       [  5.06241801e-01,   5.04668731e-01,   5.04183903e-01],
       [  5.10058535e-01,   5.08506983e-01,   5.07995541e-01],
       [  5.13883400e-01,   5.12353742e-01,   5.11815414e-01],
       [  5.17716496e-01,   5.16209104e-01,   5.15643614e-01],
       [  5.21557926e-01,   5.20073161e-01,   5.19480235e-01],
       [  5.25407789e-01,   5.23946009e-01,   5.23325369e-01],
       [  5.29266188e-01,   5.27827742e-01,   5.27179110e-01],
       [  5.33133224e-01,   5.31718454e-01,   5.31041553e-01],
       [  5.37008998e-01,   5.35618241e-01,   5.34912790e-01],
       [  5.40893611e-01,   5.39527196e-01,   5.38792919e-01],
       [  5.44787165e-01,   5.43445415e-01,   5.42682033e-01],
       [  5.48689761e-01,   5.47372993e-01,   5.46580230e-01],
       [  5.52601501e-01,   5.51310026e-01,   5.50487604e-01],
       [  5.56522486e-01,   5.55256610e-01,   5.54404254e-01],
       [  5.60452818e-01,   5.59212841e-01,   5.58330276e-01],
       [  5.64392598e-01,   5.63178814e-01,   5.62265768e-01],
       [  5.68341929e-01,   5.67154628e-01,   5.66210827e-01],
       [  5.72300913e-01,   5.71140379e-01,   5.70165553e-01],
       [  5.76269651e-01,   5.75136164e-01,   5.74130044e-01],
       [  5.80248247e-01,   5.79142081e-01,   5.78104398e-01],
       [  5.84236802e-01,   5.83158228e-01,   5.82088717e-01],
       [  5.88235420e-01,   5.87184704e-01,   5.86083099e-01],
       [  5.92244203e-01,   5.91221607e-01,   5.90087646e-01],
       [  5.96263255e-01,   5.95269037e-01,   5.94102457e-01],
       [  6.00292680e-01,   5.99327094e-01,   5.98127635e-01],
       [  6.04332580e-01,   6.03395877e-01,   6.02163282e-01],
       [  6.08383061e-01,   6.07475488e-01,   6.06209498e-01],
       [  6.12444227e-01,   6.11566027e-01,   6.10266387e-01],
       [  6.16516182e-01,   6.15667596e-01,   6.14334053e-01],
       [  6.20599032e-01,   6.19780296e-01,   6.18412598e-01],
       [  6.24692882e-01,   6.23904231e-01,   6.22502126e-01],
       [  6.28797838e-01,   6.28039503e-01,   6.26602743e-01],
       [  6.32914006e-01,   6.32186215e-01,   6.30714552e-01],
       [  6.37041494e-01,   6.36344472e-01,   6.34837660e-01],
       [  6.41180408e-01,   6.40514379e-01,   6.38972172e-01],
       [  6.45330855e-01,   6.44696040e-01,   6.43118196e-01],
       [  6.49492945e-01,   6.48889560e-01,   6.47275837e-01],
       [  6.53666785e-01,   6.53095048e-01,   6.51445204e-01],
       [  6.57852485e-01,   6.57312608e-01,   6.55626404e-01],
       [  6.62050154e-01,   6.61542349e-01,   6.59819547e-01],
       [  6.66259902e-01,   6.65784378e-01,   6.64024742e-01],
       [  6.70481841e-01,   6.70038805e-01,   6.68242098e-01],
       [  6.74716081e-01,   6.74305739e-01,   6.72471727e-01],
       [  6.78962734e-01,   6.78585289e-01,   6.76713738e-01],
       [  6.83221913e-01,   6.82877566e-01,   6.80968244e-01],
       [  6.87493730e-01,   6.87182682e-01,   6.85235358e-01],
       [  6.91778300e-01,   6.91500748e-01,   6.89515191e-01],
       [  6.96075737e-01,   6.95831877e-01,   6.93807859e-01],
       [  7.00386155e-01,   7.00176184e-01,   6.98113475e-01],
       [  7.04709671e-01,   7.04533780e-01,   7.02432154e-01],
       [  7.09046400e-01,   7.08904783e-01,   7.06764012e-01],
       [  7.13396460e-01,   7.13289306e-01,   7.11109165e-01],
       [  7.17759969e-01,   7.17687468e-01,   7.15467731e-01],
       [  7.22137044e-01,   7.22099384e-01,   7.19839828e-01],
       [  7.26527807e-01,   7.26525173e-01,   7.24225574e-01],
       [  7.30932375e-01,   7.30964953e-01,   7.28625089e-01],
       [  7.35350871e-01,   7.35418845e-01,   7.33038493e-01],
       [  7.39783415e-01,   7.39886968e-01,   7.37465907e-01],
       [  7.44230131e-01,   7.44369444e-01,   7.41907453e-01],
       [  7.48691141e-01,   7.48866395e-01,   7.46363254e-01],
       [  7.53166570e-01,   7.53377943e-01,   7.50833434e-01],
       [  7.57656542e-01,   7.57904214e-01,   7.55318116e-01],
       [  7.62161184e-01,   7.62445332e-01,   7.59817426e-01],
       [  7.66680622e-01,   7.67001421e-01,   7.64331490e-01],
       [  7.71214983e-01,   7.71572610e-01,   7.68860436e-01],
       [  7.75764397e-01,   7.76159026e-01,   7.73404391e-01],
       [  7.80328993e-01,   7.80760797e-01,   7.77963485e-01],
       [  7.84908901e-01,   7.85378052e-01,   7.82537846e-01],
       [  7.89504252e-01,   7.90010923e-01,   7.87127607e-01],
       [  7.94115180e-01,   7.94659541e-01,   7.91732899e-01],
       [  7.98741817e-01,   7.99324039e-01,   7.96353855e-01],
       [  8.03384298e-01,   8.04004549e-01,   8.00990609e-01],
       [  8.08042759e-01,   8.08701208e-01,   8.05643296e-01],
       [  8.12717335e-01,   8.13414150e-01,   8.10312051e-01],
       [  8.17408165e-01,   8.18143512e-01,   8.14997012e-01],
       [  8.22115387e-01,   8.22889433e-01,   8.19698317e-01],
       [  8.26839141e-01,   8.27652052e-01,   8.24416105e-01],
       [  8.31579568e-01,   8.32431508e-01,   8.29150517e-01],
       [  8.36336810e-01,   8.37227943e-01,   8.33901693e-01],
       [  8.41111010e-01,   8.42041500e-01,   8.38669777e-01],
       [  8.45902313e-01,   8.46872322e-01,   8.43454913e-01],
       [  8.50710864e-01,   8.51720555e-01,   8.48257245e-01],
       [  8.55536811e-01,   8.56586344e-01,   8.53076919e-01],
       [  8.60380300e-01,   8.61469838e-01,   8.57914084e-01],
       [  8.65241481e-01,   8.66371184e-01,   8.62768888e-01],
       [  8.70120506e-01,   8.71290533e-01,   8.67641480e-01],
       [  8.75017525e-01,   8.76228036e-01,   8.72532012e-01],
       [  8.79932692e-01,   8.81183846e-01,   8.77440637e-01],
       [  8.84866162e-01,   8.86158116e-01,   8.82367508e-01],
       [  8.89818091e-01,   8.91151002e-01,   8.87312781e-01],
       [  8.94788634e-01,   8.96162661e-01,   8.92276611e-01],
       [  8.99777952e-01,   9.01193251e-01,   8.97259158e-01],
       [  9.04786205e-01,   9.06242932e-01,   9.02260581e-01],
       [  9.09813553e-01,   9.11311863e-01,   9.07281039e-01],
       [  9.14860159e-01,   9.16400209e-01,   9.12320696e-01],
       [  9.19926189e-01,   9.21508132e-01,   9.17379716e-01],
       [  9.25011807e-01,   9.26635798e-01,   9.22458263e-01],
       [  9.30117182e-01,   9.31783375e-01,   9.27556504e-01],
       [  9.35242483e-01,   9.36951030e-01,   9.32674607e-01],
       [  9.40387879e-01,   9.42138934e-01,   9.37812742e-01],
       [  9.45553543e-01,   9.47347259e-01,   9.42971081e-01],
       [  9.50739650e-01,   9.52576177e-01,   9.48149797e-01],
       [  9.55946373e-01,   9.57825865e-01,   9.53349064e-01],
       [  9.61173890e-01,   9.63096498e-01,   9.58569058e-01],
       [  9.66422381e-01,   9.68388254e-01,   9.63809958e-01],
       [  9.71692024e-01,   9.73701315e-01,   9.69071942e-01],
       [  9.76983003e-01,   9.79035861e-01,   9.74355193e-01],
       [  9.82295502e-01,   9.84392077e-01,   9.79659894e-01],
       [  9.87629706e-01,   9.89770147e-01,   9.84986229e-01],
       [  9.92985803e-01,   9.95170259e-01,   9.90334385e-01],
       [             nan,              nan,              nan]]

test_cm = LinearSegmentedColormap.from_list(__file__, cm_data)


if __name__ == "__main__":
    import matplotlib.pyplot as plt
    import numpy as np

    try:
        from pycam02ucs.cm.viscm import viscm
        viscm(test_cm)
    except ImportError:
        print("pycam02ucs not found, falling back on simple display")
        plt.imshow(np.linspace(0, 100, 256)[None, :], aspect='auto',
                   cmap=test_cm)
    plt.show()
