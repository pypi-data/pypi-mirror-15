
from matplotlib.colors import ListedColormap
from numpy import nan, inf

# Used to reconstruct the colormap in pycam02ucs.cm.viscm
parameters = {'xp': [-6.0435618997350389, -26.66343894891537, -19.790146599188603, -31.444859713942691, -16.204081025418105, -9.9284662713197349],
              'yp': [-0.82821038251364598, -0.23053278688522028, 4.5508879781421001, 20.090505464480884, 17.699795081967238, 10.527663934426243],
              'min_Jp': 15.0,
              'max_Jp': 95.0554675119}

cm_data = [[ 0.08759482, 0.13383834, 0.12641276],
           [ 0.08915165, 0.13721209, 0.12937995],
           [ 0.09068815, 0.14057927, 0.13233703],
           [ 0.09218939, 0.1439442 , 0.13528437],
           [ 0.09365604, 0.14730701, 0.13822223],
           [ 0.09510173, 0.15066454, 0.14115081],
           [ 0.09649893, 0.15402412, 0.14407037],
           [ 0.09787798, 0.15737831, 0.14698111],
           [ 0.09921684, 0.16073294, 0.1498832 ],
           [ 0.10052737, 0.16408531, 0.15277684],
           [ 0.10180945, 0.16743569, 0.1556622 ],
           [ 0.10305159, 0.17078712, 0.15853935],
           [ 0.10427613, 0.17413441, 0.16140862],
           [ 0.1054499 , 0.17748571, 0.16426981],
           [ 0.10660808, 0.18083284, 0.16712341],
           [ 0.10772128, 0.18418292, 0.16996915],
           [ 0.10881166, 0.18753093, 0.17280744],
           [ 0.10986445, 0.19088046, 0.17563812],
           [ 0.11088691, 0.19422999, 0.17846138],
           [ 0.11187787, 0.19757994, 0.18127726],
           [ 0.11283226, 0.20093157, 0.18408569],
           [ 0.1137598 , 0.20428286, 0.18688692],
           [ 0.11464595, 0.20763711, 0.18968064],
           [ 0.11550832, 0.2109906 , 0.1924673 ],
           [ 0.11632602, 0.21434795, 0.19524634],
           [ 0.11712133, 0.21770447, 0.19801838],
           [ 0.11787036, 0.22106533, 0.20078271],
           [ 0.11859657, 0.22442567, 0.20354001],
           [ 0.11927673, 0.22779041, 0.20628949],
           [ 0.11993168, 0.23115531, 0.20903181],
           [ 0.12054278, 0.23452424, 0.21176625],
           [ 0.1211242 , 0.2378944 , 0.21449326],
           [ 0.12166608, 0.24126781, 0.21721239],
           [ 0.12217161, 0.24464388, 0.21992367],
           [ 0.12264417, 0.24802199, 0.22262714],
           [ 0.12307136, 0.25140457, 0.22532214],
           [ 0.12347454, 0.25478758, 0.22800953],
           [ 0.1238209 , 0.25817723, 0.23068761],
           [ 0.12414623, 0.26156684, 0.233358  ],
           [ 0.12441771, 0.26496251, 0.23601885],
           [ 0.12465785, 0.2683601 , 0.23867118],
           [ 0.12485937, 0.27176097, 0.24131443],
           [ 0.12501173, 0.27516697, 0.24394778],
           [ 0.12513821, 0.27857401, 0.2465724 ],
           [ 0.12520563, 0.28198787, 0.24918607],
           [ 0.12523986, 0.28540403, 0.25179013],
           [ 0.12523748, 0.2888231 , 0.25438416],
           [ 0.12517701, 0.29224866, 0.25696643],
           [ 0.12508551, 0.29567617, 0.25953852],
           [ 0.12494801, 0.29910809, 0.2620991 ],
           [ 0.1247576 , 0.30254546, 0.26464734],
           [ 0.12453297, 0.30598528, 0.26718432],
           [ 0.12426022, 0.30942971, 0.26970865],
           [ 0.12393285, 0.3128797 , 0.27221943],
           [ 0.12356817, 0.31633254, 0.27471769],
           [ 0.12316105, 0.31978899, 0.27720266],
           [ 0.12269043, 0.32325212, 0.27967211],
           [ 0.12217971, 0.3267184 , 0.28212762],
           [ 0.12162766, 0.330188  , 0.2845687 ],
           [ 0.12102133, 0.3336627 , 0.28699369],
           [ 0.12035995, 0.33714254, 0.289402  ],
           [ 0.1196551 , 0.34062582, 0.29179426],
           [ 0.11890582, 0.34411267, 0.29416989],
           [ 0.11810636, 0.34760381, 0.29652778],
           [ 0.11724681, 0.35110045, 0.29886633],
           [ 0.11634181, 0.3546006 , 0.30118648],
           [ 0.11539081, 0.35810431, 0.3034876 ],
           [ 0.1143934 , 0.3616116 , 0.30576906],
           [ 0.11334934, 0.36512246, 0.3080302 ],
           [ 0.11224698, 0.36863824, 0.31026903],
           [ 0.11109769, 0.37215751, 0.31248616],
           [ 0.10990348, 0.37568001, 0.31468115],
           [ 0.10866488, 0.37920567, 0.31685337],
           [ 0.10738267, 0.3827344 , 0.31900218],
           [ 0.10605791, 0.38626609, 0.32112697],
           [ 0.10469191, 0.38980059, 0.32322714],
           [ 0.10328633, 0.39333776, 0.32530212],
           [ 0.10184311, 0.39687744, 0.32735134],
           [ 0.10036235, 0.40041966, 0.32937399],
           [ 0.09884798, 0.40396408, 0.33136971],
           [ 0.09730486, 0.40751033, 0.33333831],
           [ 0.09573636, 0.41105819, 0.33527934],
           [ 0.09414626, 0.41460745, 0.33719243],
           [ 0.09253876, 0.41815789, 0.33907721],
           [ 0.0909185 , 0.42170927, 0.34093338],
           [ 0.08929059, 0.42526137, 0.34276068],
           [ 0.08766062, 0.42881396, 0.34455888],
           [ 0.08603464, 0.4323668 , 0.34632783],
           [ 0.0844192 , 0.43591966, 0.3480674 ],
           [ 0.08282135, 0.43947231, 0.34977752],
           [ 0.08124616, 0.44302473, 0.35145775],
           [ 0.079704  , 0.44657651, 0.3531085 ],
           [ 0.07820345, 0.45012743, 0.35472983],
           [ 0.07675348, 0.4536773 , 0.35632188],
           [ 0.07536347, 0.45722592, 0.35788478],
           [ 0.07404317, 0.46077312, 0.35941875],
           [ 0.0728026 , 0.46431873, 0.360924  ],
           [ 0.071652  , 0.4678626 , 0.3624008 ],
           [ 0.07060175, 0.47140458, 0.36384944],
           [ 0.06966221, 0.47494455, 0.36527025],
           [ 0.06884366, 0.47848239, 0.36666355],
           [ 0.06815409, 0.48201813, 0.36802931],
           [ 0.0676048 , 0.48555156, 0.36936821],
           [ 0.06720546, 0.48908256, 0.37068078],
           [ 0.06696439, 0.49261107, 0.37196742],
           [ 0.0668891 , 0.49613701, 0.37322855],
           [ 0.06698604, 0.49966035, 0.37446457],
           [ 0.06726059, 0.50318103, 0.37567592],
           [ 0.06771638, 0.50669906, 0.37686288],
           [ 0.06835572, 0.51021445, 0.3780257 ],
           [ 0.06918161, 0.51372708, 0.37916514],
           [ 0.07019445, 0.51723693, 0.3802816 ],
           [ 0.0713934 , 0.52074399, 0.38137552],
           [ 0.07277657, 0.52424824, 0.38244729],
           [ 0.07434102, 0.52774966, 0.38349733],
           [ 0.07608176, 0.53124834, 0.3845256 ],
           [ 0.07799535, 0.53474417, 0.38553285],
           [ 0.08007688, 0.53823713, 0.38651952],
           [ 0.08232079, 0.5417272 , 0.387486  ],
           [ 0.08472121, 0.54521435, 0.38843267],
           [ 0.08727208, 0.54869855, 0.38935988],
           [ 0.08996613, 0.5521799 , 0.39026735],
           [ 0.0927986 , 0.55565822, 0.39115605],
           [ 0.09576359, 0.55913348, 0.39202635],
           [ 0.09885537, 0.56260563, 0.39287862],
           [ 0.10206848, 0.56607459, 0.39371321],
           [ 0.10539687, 0.56954039, 0.39452977],
           [ 0.10883635, 0.5730029 , 0.39532906],
           [ 0.11238274, 0.57646197, 0.39611169],
           [ 0.11603189, 0.5799175 , 0.39687805],
           [ 0.11978001, 0.58336936, 0.39762855],
           [ 0.12362274, 0.58681758, 0.39836224],
           [ 0.12755805, 0.59026186, 0.39908071],
           [ 0.13158325, 0.59370203, 0.39978447],
           [ 0.13569596, 0.5971379 , 0.40047401],
           [ 0.13989367, 0.60056938, 0.40114856],
           [ 0.144175  , 0.6039962 , 0.40180912],
           [ 0.14853876, 0.60741805, 0.40245689],
           [ 0.15298376, 0.61083467, 0.4030925 ],
           [ 0.15750895, 0.61424592, 0.40371461],
           [ 0.16211403, 0.61765137, 0.40432524],
           [ 0.16679863, 0.62105065, 0.4049257 ],
           [ 0.17156266, 0.62444346, 0.40551579],
           [ 0.17640652, 0.62782943, 0.40609527],
           [ 0.18133025, 0.63120805, 0.40666719],
           [ 0.18633445, 0.63457888, 0.40723186],
           [ 0.1914206 , 0.63794151, 0.40778825],
           [ 0.19658866, 0.64129529, 0.40834059],
           [ 0.20184022, 0.64463971, 0.40888869],
           [ 0.20717705, 0.64797417, 0.40943307],
           [ 0.21259903, 0.651298  , 0.40997819],
           [ 0.21810978, 0.65461051, 0.41052209],
           [ 0.22370902, 0.65791098, 0.41106983],
           [ 0.22939904, 0.66119864, 0.41162253],
           [ 0.23518194, 0.66447266, 0.41218206],
           [ 0.2410578 , 0.66773225, 0.41275305],
           [ 0.24703049, 0.67097643, 0.4133358 ],
           [ 0.25309839, 0.67420444, 0.41393699],
           [ 0.25926587, 0.67741518, 0.41455706],
           [ 0.26553061, 0.68060791, 0.41520324],
           [ 0.27189566, 0.68378154, 0.41587773],
           [ 0.27835925, 0.68693528, 0.41658704],
           [ 0.28492111, 0.69006826, 0.41733623],
           [ 0.2915811 , 0.69317959, 0.41813025],
           [ 0.29833456, 0.6962688 , 0.41897708],
           [ 0.30518187, 0.69933499, 0.41988093],
           [ 0.31211628, 0.70237801, 0.42085033],
           [ 0.31913329, 0.70539759, 0.42189177],
           [ 0.3262281 , 0.70839353, 0.42301144],
           [ 0.33339199, 0.71136622, 0.42421695],
           [ 0.3406177 , 0.71431603, 0.42551436],
           [ 0.34789591, 0.7172437 , 0.42690986],
           [ 0.35521746, 0.72015014, 0.42840869],
           [ 0.36257226, 0.72303654, 0.43001555],
           [ 0.36994911, 0.72590443, 0.43173455],
           [ 0.37734026, 0.72875502, 0.43356776],
           [ 0.38473292, 0.73159045, 0.43551794],
           [ 0.39211963, 0.73441222, 0.43758541],
           [ 0.39949306, 0.73722191, 0.43976991],
           [ 0.40684081, 0.74002213, 0.4420715 ],
           [ 0.41416379, 0.7428133 , 0.44448712],
           [ 0.42144543, 0.74559904, 0.44701624],
           [ 0.4286933 , 0.74837868, 0.44965433],
           [ 0.43589005, 0.75115625, 0.45239977],
           [ 0.44304523, 0.75393073, 0.45524791],
           [ 0.45014624, 0.75670539, 0.45819585],
           [ 0.45719777, 0.75948016, 0.46123951],
           [ 0.46419885, 0.76225604, 0.46437526],
           [ 0.47114143, 0.76503558, 0.46759923],
           [ 0.47803448, 0.76781771, 0.47090796],
           [ 0.484876  , 0.77060365, 0.47429793],
           [ 0.49165923, 0.77339573, 0.47776509],
           [ 0.49839317, 0.77619272, 0.48130679],
           [ 0.50507823, 0.77899528, 0.48492   ],
           [ 0.51171358, 0.78180433, 0.48860155],
           [ 0.51829587, 0.78462142, 0.49234781],
           [ 0.52483215, 0.78744557, 0.49615703],
           [ 0.53132339, 0.7902772 , 0.50002675],
           [ 0.53777063, 0.7931167 , 0.5039546 ],
           [ 0.54417499, 0.79596443, 0.50793836],
           [ 0.55053762, 0.7988207 , 0.51197595],
           [ 0.5568572 , 0.80168646, 0.51606466],
           [ 0.56313734, 0.80456135, 0.52020328],
           [ 0.56937989, 0.80744543, 0.5243903 ],
           [ 0.57558603, 0.81033891, 0.52862415],
           [ 0.58175695, 0.81324198, 0.53290335],
           [ 0.58789381, 0.81615483, 0.53722653],
           [ 0.59399775, 0.81907762, 0.54159242],
           [ 0.60006989, 0.82201049, 0.54599982],
           [ 0.60611132, 0.8249536 , 0.55044764],
           [ 0.61212311, 0.82790707, 0.55493486],
           [ 0.61810628, 0.83087102, 0.55946052],
           [ 0.62406181, 0.83384559, 0.56402375],
           [ 0.62999067, 0.83683088, 0.56862373],
           [ 0.63589377, 0.83982701, 0.57325972],
           [ 0.64177199, 0.84283409, 0.57793102],
           [ 0.64762616, 0.84585222, 0.58263697],
           [ 0.65345709, 0.84888151, 0.587377  ],
           [ 0.65926555, 0.85192208, 0.59215054],
           [ 0.66505163, 0.85497424, 0.59695669],
           [ 0.67081585, 0.85803815, 0.60179483],
           [ 0.67655969, 0.86111366, 0.60666506],
           [ 0.68228379, 0.86420088, 0.61156698],
           [ 0.68798874, 0.86729991, 0.61650024],
           [ 0.6936751 , 0.87041087, 0.62146452],
           [ 0.69934338, 0.87353388, 0.62645952],
           [ 0.70499408, 0.87666905, 0.63148497],
           [ 0.71062765, 0.87981652, 0.63654061],
           [ 0.71624449, 0.88297641, 0.64162623],
           [ 0.72184378, 0.88614931, 0.64674057],
           [ 0.72742723, 0.88933486, 0.65188455],
           [ 0.73299522, 0.89253318, 0.65705806],
           [ 0.73854805, 0.89574443, 0.66226095],
           [ 0.74408599, 0.89896875, 0.66749311],
           [ 0.74960928, 0.90220629, 0.67275444],
           [ 0.75511813, 0.90545723, 0.67804483],
           [ 0.76061219, 0.90872192, 0.68336369],
           [ 0.76609217, 0.91200033, 0.68871146],
           [ 0.77155841, 0.91529257, 0.69408833],
           [ 0.777011  , 0.9185988 , 0.69949428],
           [ 0.78245003, 0.92191922, 0.70492929],
           [ 0.78787554, 0.92525402, 0.71039337],
           [ 0.79328752, 0.92860342, 0.7158865 ],
           [ 0.798686  , 0.9319676 , 0.72140875],
           [ 0.80407115, 0.9353467 , 0.72696042],
           [ 0.80944292, 0.93874093, 0.73254157],
           [ 0.81480119, 0.94215053, 0.7381523 ],
           [ 0.82014586, 0.94557573, 0.74379267],
           [ 0.82547677, 0.94901678, 0.7494628 ],
           [ 0.83079405, 0.95247379, 0.75516328],
           [ 0.83609743, 0.95594705, 0.76089415],
           [ 0.84138656, 0.95943687, 0.76665546],
           [ 0.84666114, 0.96294354, 0.77244736],
           [ 0.85192084, 0.96646736, 0.77827001],
           [ 0.8571653 , 0.97000864, 0.7841236 ],
           [ 0.86239409, 0.9735677 , 0.79000832]]

test_cm = ListedColormap(cm_data, name=__file__)


if __name__ == "__main__":
    import matplotlib.pyplot as plt
    import numpy as np

    try:
        from viscm import viscm
        viscm(test_cm)
    except ImportError:
        print("viscm not found, falling back on simple display")
        plt.imshow(np.linspace(0, 100, 256)[None, :], aspect='auto',
                   cmap=test_cm)
    plt.show()
