
from matplotlib.colors import LinearSegmentedColormap
from numpy import nan, inf

# Used to reconstruct the colormap in pycam02ucs.cm.viscm
parameters = {'xp': [1.5140484142500839, 0.23692942457759614, -21.066596747040251, -32.24727278711276, -14.166955169979303, -4.4447329477571031],
              'yp': [-25.134408602150529, -61.24605055292258, -24.193548387096769, -11.828593996840425, -8.8261648745519494, -2.2401433691756267],
              'min_Jp': 24.915874177,
              'max_Jp': 98.3613752743}

cm_data = [[ 0.18888854,  0.19163908,  0.39592704],
       [ 0.19095964,  0.19375028,  0.40211781],
       [ 0.19302354,  0.19585959,  0.40831049],
       [ 0.1950756 ,  0.19796016,  0.41454552],
       [ 0.19711245,  0.20004724,  0.42085059],
       [ 0.19914176,  0.20213337,  0.42715515],
       [ 0.20115246,  0.20420191,  0.43355411],
       [ 0.20315294,  0.20626656,  0.4399709 ],
       [ 0.2051403 ,  0.2083235 ,  0.44642799],
       [ 0.20711027,  0.21036698,  0.45295805],
       [ 0.20907177,  0.21241139,  0.45948241],
       [ 0.2110097 ,  0.21443474,  0.4661231 ],
       [ 0.2129382 ,  0.21645933,  0.47275863],
       [ 0.21484655,  0.21847013,  0.47947231],
       [ 0.21673975,  0.2204757 ,  0.48621859],
       [ 0.21861541,  0.22247368,  0.49301157],
       [ 0.22047069,  0.22446129,  0.49986741],
       [ 0.22231004,  0.22644627,  0.50674613],
       [ 0.2241244 ,  0.22841732,  0.51370943],
       [ 0.22592323,  0.23038925,  0.52068031],
       [ 0.22769326,  0.23234557,  0.52774783],
       [ 0.22944667,  0.23430462,  0.53481709],
       [ 0.23116847,  0.23624852,  0.54198431],
       [ 0.23287072,  0.2381952 ,  0.54915764],
       [ 0.23453985,  0.24012961,  0.55641848],
       [ 0.23618429,  0.24206491,  0.56370076],
       [ 0.23779566,  0.24399349,  0.57104731],
       [ 0.23937452,  0.24591906,  0.5784421 ],
       [ 0.24092234,  0.24784633,  0.58586433],
       [ 0.24242655,  0.2497647 ,  0.5933734 ],
       [ 0.24390023,  0.25169207,  0.60088041],
       [ 0.24532317,  0.25361107,  0.60848134],
       [ 0.24670515,  0.25553624,  0.61610569],
       [ 0.24804452,  0.25747008,  0.62374645],
       [ 0.24932126,  0.25939909,  0.63148228],
       [ 0.25054922,  0.26134145,  0.63922471],
       [ 0.25172338,  0.26329791,  0.64697807],
       [ 0.25282036,  0.26525617,  0.65481947],
       [ 0.25385293,  0.26723347,  0.662667  ],
       [ 0.25481476,  0.26923193,  0.67052117],
       [ 0.25569726,  0.27125322,  0.67838713],
       [ 0.25648119,  0.27329428,  0.68630048],
       [ 0.25717203,  0.27536809,  0.69420603],
       [ 0.25776064,  0.27747932,  0.70209816],
       [ 0.25823709,  0.27963348,  0.70996898],
       [ 0.25859065,  0.28183702,  0.7178078 ],
       [ 0.25880989,  0.28409747,  0.72560069],
       [ 0.25888282,  0.28642345,  0.73333   ],
       [ 0.25879716,  0.28882467,  0.74097399],
       [ 0.25854063,  0.29131186,  0.74850658],
       [ 0.25810142,  0.29389655,  0.75589732],
       [ 0.25746877,  0.29659074,  0.76311173],
       [ 0.2566336 ,  0.29940643,  0.77011195],
       [ 0.25558927,  0.30235498,  0.77685791],
       [ 0.25432466,  0.30544671,  0.78331636],
       [ 0.25284142,  0.30869023,  0.78944342],
       [ 0.25115373,  0.31209003,  0.79519399],
       [ 0.24927141,  0.31564713,  0.80053886],
       [ 0.24720603,  0.31935921,  0.80545751],
       [ 0.24498853,  0.32321737,  0.80993185],
       [ 0.24264269,  0.3272104 ,  0.81396078],
       [ 0.24019821,  0.33132335,  0.81755203],
       [ 0.23768025,  0.33554056,  0.82072313],
       [ 0.23511751,  0.33984451,  0.82349767],
       [ 0.23253806,  0.34421741,  0.82590459],
       [ 0.22995572,  0.34864567,  0.82797419],
       [ 0.22738862,  0.35311532,  0.82973704],
       [ 0.22486678,  0.35760946,  0.83122725],
       [ 0.22239047,  0.36212116,  0.83247115],
       [ 0.21997083,  0.36664127,  0.83349531],
       [ 0.21761776,  0.37116191,  0.83432439],
       [ 0.21534062,  0.37567623,  0.83498127],
       [ 0.21315373,  0.3801765 ,  0.83548997],
       [ 0.21105391,  0.38466134,  0.83586459],
       [ 0.20904631,  0.38912728,  0.8361213 ],
       [ 0.20713537,  0.39357156,  0.8362745 ],
       [ 0.20532491,  0.39799204,  0.83633706],
       [ 0.20361818,  0.40238711,  0.83632039],
       [ 0.20201798,  0.40675558,  0.83623467],
       [ 0.20052672,  0.41109664,  0.8360889 ],
       [ 0.19914644,  0.41540975,  0.83589113],
       [ 0.19787887,  0.41969465,  0.83564848],
       [ 0.19672548,  0.42395125,  0.8353673 ],
       [ 0.19568746,  0.42817964,  0.83505327],
       [ 0.19476579,  0.43238002,  0.83471144],
       [ 0.19396119,  0.43655273,  0.83434632],
       [ 0.1932742 ,  0.44069814,  0.83396197],
       [ 0.19270515,  0.44481673,  0.833562  ],
       [ 0.19225416,  0.44890902,  0.83314968],
       [ 0.19192116,  0.45297554,  0.83272793],
       [ 0.1917059 ,  0.45701687,  0.8322994 ],
       [ 0.19160795,  0.46103363,  0.83186645],
       [ 0.19162668,  0.4650264 ,  0.83143125],
       [ 0.19176133,  0.46899582,  0.83099573],
       [ 0.19201134,  0.47294235,  0.83056212],
       [ 0.19237638,  0.47686634,  0.83013295],
       [ 0.19285372,  0.48076891,  0.82970803],
       [ 0.19344194,  0.48465067,  0.82928864],
       [ 0.19413952,  0.48851223,  0.82887595],
       [ 0.19494481,  0.49235419,  0.82847099],
       [ 0.19585603,  0.49617711,  0.82807473],
       [ 0.19687134,  0.49998158,  0.82768803],
       [ 0.19798879,  0.50376815,  0.82731165],
       [ 0.19920658,  0.50753727,  0.82694665],
       [ 0.2005228 ,  0.51128941,  0.82659394],
       [ 0.20193469,  0.51502533,  0.82625312],
       [ 0.20344012,  0.51874553,  0.8259247 ],
       [ 0.2050369 ,  0.52245049,  0.82560914],
       [ 0.20672286,  0.52614069,  0.82530683],
       [ 0.20849582,  0.52981658,  0.82501812],
       [ 0.21035358,  0.53347861,  0.82474331],
       [ 0.21229399,  0.5371272 ,  0.8244827 ],
       [ 0.21431479,  0.54076282,  0.82423623],
       [ 0.21641386,  0.54438589,  0.82400404],
       [ 0.21858913,  0.54799679,  0.82378628],
       [ 0.22083862,  0.55159589,  0.82358308],
       [ 0.22316036,  0.55518356,  0.82339453],
       [ 0.22555247,  0.55876013,  0.82322071],
       [ 0.2280131 ,  0.56232593,  0.82306164],
       [ 0.23054025,  0.56588147,  0.82291647],
       [ 0.2331324 ,  0.56942691,  0.82278572],
       [ 0.235788  ,  0.57296255,  0.82266947],
       [ 0.2385055 ,  0.57648866,  0.82256765],
       [ 0.24128347,  0.58000549,  0.82248021],
       [ 0.24412052,  0.5835133 ,  0.82240704],
       [ 0.24701538,  0.58701233,  0.82234803],
       [ 0.24996684,  0.5905028 ,  0.82230305],
       [ 0.25297366,  0.59398506,  0.82227115],
       [ 0.25603487,  0.59745929,  0.82225215],
       [ 0.25914962,  0.60092557,  0.82224657],
       [ 0.26231706,  0.60438406,  0.82225422],
       [ 0.26553642,  0.60783493,  0.8222749 ],
       [ 0.26880701,  0.61127831,  0.8223084 ],
       [ 0.27212824,  0.61471433,  0.8223545 ],
       [ 0.27549959,  0.6181431 ,  0.82241295],
       [ 0.27892064,  0.62156473,  0.82248351],
       [ 0.28239104,  0.62497929,  0.82256592],
       [ 0.28591053,  0.62838686,  0.82265991],
       [ 0.28947895,  0.6317875 ,  0.82276514],
       [ 0.2930963 ,  0.63518137,  0.82288028],
       [ 0.2967625 ,  0.63856834,  0.82300624],
       [ 0.30047763,  0.64194841,  0.82314274],
       [ 0.30424182,  0.64532157,  0.82328953],
       [ 0.30805531,  0.64868779,  0.82344632],
       [ 0.31191841,  0.65204701,  0.82361286],
       [ 0.31583149,  0.65539917,  0.82378888],
       [ 0.319795  ,  0.65874417,  0.82397413],
       [ 0.32380948,  0.66208191,  0.82416836],
       [ 0.32787553,  0.66541226,  0.82437134],
       [ 0.33199382,  0.66873507,  0.82458284],
       [ 0.33616507,  0.67205017,  0.82480267],
       [ 0.3403901 ,  0.67535736,  0.82503065],
       [ 0.34466975,  0.67865645,  0.82526661],
       [ 0.34900494,  0.68194718,  0.82551042],
       [ 0.35339663,  0.6852293 ,  0.825762  ],
       [ 0.35784583,  0.68850253,  0.82602126],
       [ 0.36235411,  0.69176663,  0.82628701],
       [ 0.36692245,  0.69502124,  0.8265596 ],
       [ 0.37155173,  0.69826598,  0.82683973],
       [ 0.37624308,  0.70150048,  0.82712752],
       [ 0.38099763,  0.70472435,  0.82742317],
       [ 0.38581652,  0.70793718,  0.82772691],
       [ 0.39070086,  0.71113856,  0.82803907],
       [ 0.39565171,  0.71432804,  0.82836004],
       [ 0.40067061,  0.71750517,  0.82868949],
       [ 0.40575992,  0.72066946,  0.82902588],
       [ 0.41091888,  0.72382043,  0.82937268],
       [ 0.41614825,  0.72695761,  0.82973064],
       [ 0.42144868,  0.73008054,  0.8301006 ],
       [ 0.4268211 ,  0.73318872,  0.83048297],
       [ 0.43226829,  0.73628157,  0.83087573],
       [ 0.43778772,  0.73935877,  0.83128375],
       [ 0.44337929,  0.74241992,  0.83170831],
       [ 0.44904318,  0.74546462,  0.83215023],
       [ 0.45478146,  0.74849231,  0.83260811],
       [ 0.46059021,  0.75150293,  0.83308718],
       [ 0.4664683 ,  0.75449627,  0.83358904],
       [ 0.47241654,  0.75747193,  0.83411317],
       [ 0.47843186,  0.76042994,  0.83466284],
       [ 0.48451112,  0.76337042,  0.83524098],
       [ 0.49065339,  0.76629325,  0.83584809],
       [ 0.49685547,  0.76919866,  0.83648661],
       [ 0.50311319,  0.77208706,  0.83715949],
       [ 0.50942425,  0.77495866,  0.83786774],
       [ 0.51578453,  0.777814  ,  0.83861371],
       [ 0.52218974,  0.78065371,  0.83939956],
       [ 0.52863623,  0.78347838,  0.84022671],
       [ 0.53511954,  0.78628881,  0.841097  ],
       [ 0.54163566,  0.78908577,  0.84201168],
       [ 0.54817948,  0.79187029,  0.84297266],
       [ 0.5547475 ,  0.79464319,  0.84398049],
       [ 0.56133598,  0.79740538,  0.84503579],
       [ 0.5679386 ,  0.80015829,  0.84614085],
       [ 0.57455371,  0.80290257,  0.84729463],
       [ 0.5811778 ,  0.80563923,  0.84849736],
       [ 0.58780423,  0.80836992,  0.84975124],
       [ 0.59443274,  0.81109514,  0.85105426],
       [ 0.60106045,  0.81381587,  0.85240618],
       [ 0.60768175,  0.8165337 ,  0.85380842],
       [ 0.61429594,  0.81924926,  0.85525937],
       [ 0.62090164,  0.82196332,  0.85675791],
       [ 0.62749592,  0.82467696,  0.85830392],
       [ 0.63407476,  0.82739158,  0.85989787],
       [ 0.64063949,  0.83010737,  0.86153724],
       [ 0.64718865,  0.83282516,  0.86322119],
       [ 0.65372021,  0.83554588,  0.86494925],
       [ 0.6602311 ,  0.83827077,  0.86672155],
       [ 0.66672317,  0.84099987,  0.86853559],
       [ 0.67319562,  0.84373387,  0.87039043],
       [ 0.67964778,  0.8464734 ,  0.8722851 ],
       [ 0.68607778,  0.84921939,  0.87421929],
       [ 0.69248517,  0.85197243,  0.87619204],
       [ 0.69887113,  0.85473269,  0.87820157],
       [ 0.7052354 ,  0.85750069,  0.88024694],
       [ 0.71157782,  0.86027691,  0.88232719],
       [ 0.71789829,  0.86306183,  0.8844414 ],
       [ 0.72419585,  0.86585611,  0.88658909],
       [ 0.73047077,  0.86866013,  0.88876925],
       [ 0.736724  ,  0.87147404,  0.89098056],
       [ 0.74295568,  0.87429822,  0.89322213],
       [ 0.74916595,  0.87713303,  0.89549315],
       [ 0.75535499,  0.87997881,  0.89779278],
       [ 0.76152302,  0.88283589,  0.90012023],
       [ 0.76767027,  0.88570458,  0.90247471],
       [ 0.77379664,  0.88858529,  0.90485563],
       [ 0.7799024 ,  0.8914783 ,  0.90726224],
       [ 0.7859883 ,  0.89438376,  0.9096936 ],
       [ 0.79205463,  0.89730195,  0.912149  ],
       [ 0.79810166,  0.90023312,  0.91462777],
       [ 0.80412968,  0.90317755,  0.91712924],
       [ 0.81013897,  0.90613547,  0.91965277],
       [ 0.8161298 ,  0.90910715,  0.92219774],
       [ 0.82210245,  0.91209282,  0.92476352],
       [ 0.82805718,  0.91509273,  0.92734953],
       [ 0.83399426,  0.91810711,  0.92995517],
       [ 0.83991393,  0.92113621,  0.93257989],
       [ 0.84581641,  0.92418026,  0.93522313],
       [ 0.85170202,  0.92723948,  0.93788429],
       [ 0.85757096,  0.93031411,  0.94056285],
       [ 0.86342342,  0.93340439,  0.94325828],
       [ 0.86925954,  0.93651056,  0.94597008],
       [ 0.87507947,  0.93963288,  0.94869775],
       [ 0.88088333,  0.9427716 ,  0.95144078],
       [ 0.8866712 ,  0.94592699,  0.95419871],
       [ 0.89244313,  0.94909933,  0.95697105],
       [ 0.89819914,  0.95228888,  0.95975735],
       [ 0.90393922,  0.95549595,  0.96255715],
       [ 0.90966337,  0.95872082,  0.96536996],
       [ 0.91537207,  0.96196364,  0.96819504],
       [ 0.92106463,  0.96522489,  0.97103224],
       [ 0.92674084,  0.96850494,  0.97388113],
       [ 0.93240042,  0.97180417,  0.97674131],
       [ 0.93804303,  0.97512298,  0.97961239],
       [ 0.94366821,  0.97846181,  0.982494  ],
       [ 0.94927542,  0.98182114,  0.98538577],
       [ 0.95486402,  0.98520148,  0.98828737]]

test_cm = LinearSegmentedColormap.from_list(__file__, cm_data)


if __name__ == "__main__":
    import matplotlib.pyplot as plt
    import numpy as np

    try:
        from pycam02ucs.cm.viscm import viscm
        viscm(test_cm)
    except ImportError:
        print("pycam02ucs not found, falling back on simple display")
        plt.imshow(np.linspace(0, 100, 256)[None, :], aspect='auto',
                   cmap=test_cm)
    plt.show()
