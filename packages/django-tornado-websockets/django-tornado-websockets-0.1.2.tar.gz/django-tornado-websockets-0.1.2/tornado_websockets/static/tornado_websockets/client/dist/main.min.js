"function"!=typeof Object.assign&&!function(){Object.assign=function(t){"use strict";if(void 0===t||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(t),o=1;o<arguments.length;o++){var e=arguments[o];if(void 0!==e&&null!==e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n}}();var TornadoWebSocket,tws;"function"!=typeof tws&&(tws=function(t,n){return new TornadoWebSocket(t,n)}),TornadoWebSocket=function(){function t(n,o){if(!(this instanceof t))return new t(n,o);if(void 0===n)throw new ReferenceError("You must pass 'path' parameter during 'TornadoWebSocket' instantiation.");this.websocket=null,this.options=Object.assign({},{host:"localhost",port:8e3,secure:!1},o),this.path=n.trim(),this.path="/"===this.path[0]?this.path:"/"+this.path,this.url=this.buildUrl(),this.events={},this.connect()}return t.prototype.connect=function(){this.websocket=new WebSocket(this.url),this.websocket.onopen=function(t){return function(t){return console.info("New connection",t)}}(this),this.websocket.onclose=function(t){return function(t){return console.info("Connection closed",t)}}(this),this.websocket.onerror=function(t){return function(t){return console.info("Error",t)}}(this),this.websocket.onmessage=function(t){return function(n){var o,e,r,s,i,c;try{e=JSON.parse(n.data)}catch(s){return r=s,void console.warn("Can not parse invalid JSON: ",n.data)}return c=e.event,i=e.data,void 0===c||"string"!=typeof c?void console.warn("Can not get passed event from JSON data."):void 0===i||"object"!=typeof i?void console.warn("Can not get passed data from JSON data."):(o=t.events[c],void 0===o||"function"!=typeof o?void console.warn("Passed event « "+c+" » is not binded."):o(i))}}(this)},t.prototype.on=function(t,n){if("function"!=typeof n)throw new TypeError("You must pass a function for 'callback' parameter.");"open"===t||"close"===t||"error"===t?this.websocket["on"+t]=n:this.events[t]=n},t.prototype.emit=function(t,n){return null==n&&(n={}),"object"!=typeof n&&(n={message:n}),n=JSON.stringify({event:t,data:n}),this.websocket.send(n)},t.prototype.buildUrl=function(){var t;return t=this.options.secure?"wss":"ws",t+"://"+this.options.host+":"+this.options.port+"/ws"+this.path},t}();