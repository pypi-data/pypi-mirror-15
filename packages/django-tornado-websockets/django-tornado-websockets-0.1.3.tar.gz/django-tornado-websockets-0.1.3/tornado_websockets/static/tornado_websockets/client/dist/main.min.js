"function"!=typeof Object.assign&&!function(){Object.assign=function(t){"use strict";if(void 0===t||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var o=Object(t),e=1;e<arguments.length;e++){var n=arguments[e];if(void 0!==n&&null!==n)for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(o[r]=n[r])}return o}}();var TornadoWebSocket;TornadoWebSocket=function(){function t(o,e){if(!(this instanceof t))return new t(o,e);if(void 0===o)throw new ReferenceError("You must pass 'path' parameter during 'TornadoWebSocket' instantiation.");this.websocket=null,this.options=Object.assign({},{host:location.hostname||"localhost",port:8e3,secure:!1},e),this.path=o.trim(),this.path="/"===this.path[0]?this.path:"/"+this.path,this.url=this.buildUrl(),this.events={},this.connect()}return t.prototype.connect=function(){this.websocket=new WebSocket(this.url),this.websocket.onopen=function(t){return function(t){return console.info("New connection",t)}}(this),this.websocket.onclose=function(t){return function(t){return console.info("Connection closed",t)}}(this),this.websocket.onerror=function(t){return function(t){return console.info("Error",t)}}(this),this.websocket.onmessage=function(t){return function(o){var e,n,r,i,s,c;try{n=JSON.parse(o.data)}catch(i){return r=i,void console.warn("Can not parse invalid JSON: ",o.data)}return c=n.event,s=n.data,void 0===c||"string"!=typeof c?void console.warn("Can not get passed event from JSON data."):void 0===s||"object"!=typeof s?void console.warn("Can not get passed data from JSON data."):(e=t.events[c],void 0===e||"function"!=typeof e?void console.warn("Passed event « "+c+" » is not binded."):e(s))}}(this)},t.prototype.on=function(t,o){if("function"!=typeof o)throw new TypeError("You must pass a function for 'callback' parameter.");"open"===t||"close"===t||"error"===t?this.websocket["on"+t]=o:this.events[t]=o},t.prototype.emit=function(t,o){return null==o&&(o={}),"object"!=typeof o&&(o={message:o}),o=JSON.stringify({event:t,data:o}),this.websocket.send(o)},t.prototype.buildUrl=function(){var t;return t=this.options.secure?"wss":"ws",t+"://"+this.options.host+":"+this.options.port+"/ws"+this.path},t}();var TornadoWebSocketModule;TornadoWebSocketModule=function(){function t(t,o){if(null==o&&(o=""),!(t instanceof TornadoWebSocket))throw new TypeError("Parameter `websocket` should be an instance of TornadoWebSocket, got "+typeof t+" instead.");this.websocket=t,this.prefix=""+o}return t.prototype.on=function(t,o){return this.websocket.on(this.prefix+t,o)},t.prototype.emit=function(t,o){return null==o&&(o={}),this.websocket.emit(this.prefix+t,o)},t}();