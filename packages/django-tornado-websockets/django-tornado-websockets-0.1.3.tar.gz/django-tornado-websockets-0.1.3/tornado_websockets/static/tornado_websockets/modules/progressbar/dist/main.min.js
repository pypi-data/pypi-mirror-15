!function(e,t){"function"==typeof define&&define.amd?define(t):"object"==typeof exports?module.exports=t():e.deepmerge=t()}(this,function(){return function e(t,s){var r=Array.isArray(s),o=r&&[]||{};return r?(t=t||[],o=o.concat(t),s.forEach(function(s,r){"undefined"==typeof o[r]?o[r]=s:"object"==typeof s?o[r]=e(t[r],s):-1===t.indexOf(s)&&o.push(s)})):(t&&"object"==typeof t&&Object.keys(t).forEach(function(e){o[e]=t[e]}),Object.keys(s).forEach(function(r){o[r]="object"==typeof s[r]&&s[r]&&t[r]?e(t[r],s[r]):s[r]})),o}});var ProgressBarModuleEngine;ProgressBarModuleEngine=function(){function e(e,t){if(void 0===e||!(e instanceof HTMLElement))throw new TypeError("Parameter `$container` should be an instance of HTMLElement, got "+typeof e+" instead.");if(!(t instanceof Object))throw new TypeError("Parameter `options` should be an Object, got "+typeof t+" instead.");this.$container=e,this.options=deepmerge(this.defaults,t)}return e.prototype.defaults={},e.prototype.render=function(){throw new Error("`render` method should be overridden.")},e.prototype.onInit=function(e){throw new Error("`onInit` method should be overridden.")},e.prototype.onUpdate=function(e){throw new Error("`onUpdate` method should be overridden.")},e.prototype.updateLabel=function(e){throw new Error("`updateLabel` method should be overridden.")},e.prototype.updateProgression=function(e){throw new Error("`updateProgression` method should be overridden.")},e}();var ProgressBarModuleEngineBootstrap,extend=function(e,t){function s(){this.constructor=e}for(var r in t)hasProp.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},hasProp={}.hasOwnProperty;ProgressBarModuleEngineBootstrap=function(e){function t(e,s){t.__super__.constructor.call(this,e,s),this._settings={}}return extend(t,e),t.prototype.defaults={label:{visible:!0,classes:["progressbar-label"],position:"top"},progressbar:{context:"info",striped:!1,animated:!1},progression:{visible:!0,format:"{{percent}}%"}},t.prototype.render=function(){this._createElements(),this._renderElements()},t.prototype.onInit=function(e){var t,s,r,o;r=[0,100,100],s=r[0],t=r[1],o=r[2],e.indeterminate===!1&&(s=e.min,t=e.max,o=e.value),this._config("indeterminate",e.indeterminate),this._config("min",s),this._config("max",t),this._config("value",o),this.onUpdate({value:o})},t.prototype.onUpdate=function(e){this._config("value",e.value),this._config("progression",(this._settings.value/this._settings.max*100).toFixed()),this.$progressbar.style.width=this._settings.progression+"%",void 0!==e.label&&this.updateLabel(e.label),this.updateProgression(this._settings.progression)},t.prototype.updateLabel=function(e){this.$label.textContent=e},t.prototype.updateProgression=function(e){this.$progression.textContent=this.options.progression.format.replace(/\{\{ *percent *\}\}/g,e)},t.prototype._createElements=function(){var e,t,s,r,o;for(this.$progress=document.createElement("div"),this.$progress.classList.add("progress"),this.$progressbar=document.createElement("div"),this.$progressbar.classList.add("progress-bar"),this.$progressbar.setAttribute("role","progressbar"),("info"===(r=this.options.progressbar.context)||"success"===r||"warning"===r||"danger"===r)&&this.$progressbar.classList.add("progress-bar-"+this.options.progressbar.context),this.options.progressbar.striped===!0&&(this.$progressbar.classList.add("progress-bar-striped"),this.options.progressbar.animated===!0&&this.$progressbar.classList.add("active")),this.$progression=document.createElement("span"),this.options.progression.visible===!1&&this.$progression.classList.add("sr-only"),this.$label=document.createElement("span"),o=this.options.label.classes,t=0,s=o.length;s>t;t++)e=o[t],this.$label.classList.add(e);this.options.label.visible===!1&&(this.$label.style.display="none")},t.prototype._renderElements=function(){this.$progressbar.appendChild(this.$progression),this.$progress.appendChild(this.$progressbar),this.$container.appendChild(this.$progress),"top"===this.options.label.position?this.$container.insertBefore(this.$label,this.$progress):this.$container.appendChild(this.$label)},t.prototype._config=function(e,t){switch(this._settings[e]=t,e){case"min":case"max":case"value":"value"===e&&(e="now"),this.$progressbar.setAttribute("aria-value"+e,t);break;case"indeterminate":t===!0&&(this.$progressbar.classList.add("progress-bar-striped"),this.$progressbar.classList.add("active"),this.$progressbar.style.width="100%")}},t}(ProgressBarModuleEngine);var ProgressBarModuleEngineHtml5,extend=function(e,t){function s(){this.constructor=e}for(var r in t)hasProp.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},hasProp={}.hasOwnProperty;ProgressBarModuleEngineHtml5=function(e){function t(e,s){t.__super__.constructor.call(this,e,s),this._settings={}}return extend(t,e),t.prototype.defaults={label:{visible:!0,classes:["progressbar-label"],position:"top"},progression:{visible:!0,format:"{{percent}}%",position:"right"}},t.prototype.render=function(){this._createElements(),this._renderElements()},t.prototype.onInit=function(e){var t,s,r;return e.indeterminate?this._config("indeterminate",!0):(s=e.min,t=e.max,r=e.value,this._config("min",s),this._config("max",t),this._config("value",r),this.onUpdate({value:r}))},t.prototype.onUpdate=function(e){this._config("value",e.value),this._config("progression",(this._settings.value/this._settings.max*100).toFixed()),void 0!==e.label&&this.updateLabel(e.label),this.updateProgression(this._settings.progression)},t.prototype.updateLabel=function(e){this.$label.textContent=e},t.prototype.updateProgression=function(e){this.$progression.textContent=this.options.progression.format.replace(/\{\{ *percent *\}\}/g,e)},t.prototype._createElements=function(){var e,t,s,r;for(this.$progress=document.createElement("div"),this.$progress.classList.add("progress"),this.$progressbar=document.createElement("progress"),this.$progressbar.classList.add("progress-bar"),this.$progression=document.createElement("span"),this.options.progression.visible===!1&&(this.$progression.style.display="none"),this.$label=document.createElement("span"),r=this.options.label.classes,t=0,s=r.length;s>t;t++)e=r[t],this.$label.classList.add(e);this.options.label.visible===!1&&(this.$label.style.display="none")},t.prototype._renderElements=function(){this.$progress.appendChild(this.$progressbar),this.$container.appendChild(this.$progress),"top"===this.options.label.position?this.$container.insertBefore(this.$label,this.$progress):this.$container.appendChild(this.$label),"left"===this.options.progression.position?this.$progressbar.parentNode.insertBefore(this.$progression,this.$progressbar):this.$progressbar.parentNode.insertBefore(this.$progression,this.$progressbar.nextSibling)},t.prototype._config=function(e,t){switch(this._settings[e]=t,e){case"min":case"max":case"value":this.$progressbar.setAttribute(e,t);break;case"indeterminate":t===!0&&(this.$progressbar.removeAttribute("min"),this.$progressbar.removeAttribute("max"),this.$progressbar.removeAttribute("value"))}},t}(ProgressBarModuleEngine);var ProgressBarModule,extend=function(e,t){function s(){this.constructor=e}for(var r in t)hasProp.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},hasProp={}.hasOwnProperty;ProgressBarModule=function(e){function t(e,s,r){if(null==r&&(r="module_progressbar_"),!(this instanceof t))return new t(e,s);if(!(e instanceof TornadoWebSocket))throw new TypeError("Parameter `websocket` should be an instance of TornadoWebSocket, got "+typeof e+" instead.");if(!(s instanceof ProgressBarModuleEngine))throw new TypeError("Parameter `engine` should be an instance of ProgressBarModuleEngine, got "+typeof s+" instead.");t.__super__.constructor.call(this,e,r),this.engine=s,this.init()}return extend(t,e),t.prototype.init=function(){this.on("init",function(e){return function(t){return e.engine.onInit.apply(e.engine,[t])}}(this)),this.on("update",function(e){return function(t){return e.engine.onUpdate.apply(e.engine,[t])}}(this)),this.engine.render()},t}(TornadoWebSocketModule);