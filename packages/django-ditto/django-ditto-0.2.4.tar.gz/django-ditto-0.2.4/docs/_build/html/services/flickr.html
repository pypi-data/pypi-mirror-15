

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Flickr &mdash; Django Ditto 0.2.4 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Django Ditto 0.2.4 documentation" href="../index.html"/>
        <link rel="next" title="Pinboard" href="pinboard.html"/>
        <link rel="prev" title="Installation" href="../installation.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Django Ditto
          

          
          </a>

          
            
            
              <div class="version">
                0.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
</ul>
<p class="caption"><span class="caption-text">Services supported</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Flickr</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#set-up">Set-up</a></li>
<li class="toctree-l2"><a class="reference internal" href="#photo-data">Photo data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#photo-files">Photo files</a></li>
<li class="toctree-l2"><a class="reference internal" href="#photosets">Photosets</a></li>
<li class="toctree-l2"><a class="reference internal" href="#users">Users</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="pinboard.html">Pinboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="twitter.html">Twitter</a></li>
</ul>
<p class="caption"><span class="caption-text">For Developers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../development.html">Development</a></li>
</ul>
<p class="caption"><span class="caption-text">Elsewhere</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/philgyford/django-ditto">Django Ditto on GitHub</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Django Ditto</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
    <li>Flickr</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/services/flickr.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="flickr">
<h1>Flickr<a class="headerlink" href="#flickr" title="Permalink to this headline">¶</a></h1>
<p>You can fetch, store and display data about all your Photos and Photosets (Albums) for one or more <a class="reference external" href="https://flickr.com/">Flickr</a> accounts. By default the included models and templates will link to the photo files on flickr.com, but you can also download the original files to store locally. These can then be used to generate images in all other sizes, to be served locally.</p>
<div class="section" id="set-up">
<h2>Set-up<a class="headerlink" href="#set-up" title="Permalink to this headline">¶</a></h2>
<p>In the Django admin, create a new Account in the Flickr app, and add your Flickr API key and secret from <a class="reference external" href="https://www.flickr.com/services/apps/create/apply/">https://www.flickr.com/services/apps/create/apply/</a></p>
<p>By default this will only allow the fetching of fully public photos. To fetch
all photos your Flickr account can access, you&#8217;ll need to do this:</p>
<ol class="arabic">
<li><p class="first">Enter your API key and secret in the indicated place in the file
<code class="docutils literal"><span class="pre">ditto/scripts/flickr_authorize.py</span></code>. (If you&#8217;ve installed Ditto using pip,
it might be easier to <a class="reference external" href="https://github.com/philgyford/django-ditto/blob/master/ditto/scripts/flickr_authorize.py">download this script from GitHub</a>.)</p>
</li>
<li><p class="first">Run the script on the command line:</p>
<blockquote>
<div><div class="highlight-shell"><div class="highlight"><pre><span></span>$ python ditto/scripts/flickr_authorize.py
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Follow the instructions. A new browser window should open for you to
authorize your Flickr account. You&#8217;ll then get a code to paste into your
Terminal.</p>
</li>
</ol>
<p>Finally, for each of those Accounts, note its ID from the Django admin, and do this to fetch information about its associated Flickr user (replacing <code class="docutils literal"><span class="pre">1</span></code> with your ID, if different):</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>$ ./manage.py fetch_flickr_account_user --id<span class="o">=</span>1
</pre></div>
</div>
</div>
<div class="section" id="photo-data">
<h2>Photo data<a class="headerlink" href="#photo-data" title="Permalink to this headline">¶</a></h2>
<p>Now you can fetch data about your Photos (including videos). This will fetch data for ALL Photos for ALL Accounts (for me it took about 75 minutes for 3,000 photos):</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>$ ./manage.py fetch_flickr_photos --days<span class="o">=</span>all
</pre></div>
</div>
<p>This will only fetch Photos uploaded in the past 3 days:</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>$ ./manage.py fetch_flickr_photos --days<span class="o">=</span>3
</pre></div>
</div>
<p>Both options can be restricted to only fetch for a single Account by adding the NSID of the Account&#8217;s Flickr User, eg:</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>$ ./manage.py fetch_flickr_photos --account<span class="o">=</span>35034346050@N01 --days<span class="o">=</span>3
</pre></div>
</div>
</div>
<div class="section" id="photo-files">
<h2>Photo files<a class="headerlink" href="#photo-files" title="Permalink to this headline">¶</a></h2>
<p>The above only fetches data <em>about</em> the photos (title, locations, EXIF, tags, etc). To download the original photo and video files themselves, use the <code class="docutils literal"><span class="pre">fetch_flickr_originals</span></code> command, <em>after</em> fetching the photos&#8217; data:</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>$ ./manage.py fetch_flickr_originals
</pre></div>
</div>
<p>This took over 90 minutes for about 3,000 photos (and very few videos) for me. By default this command will fetch all the original files that haven&#8217;t yet been downloaded (so the first time, it will fetch all of them). To force it to download <em>all</em> the files again (if you&#8217;ve deleted them locally, but they&#8217;re still on Flickr) then:</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>$ ./manage.py fetch_flickr_originals --all
</pre></div>
</div>
<p>Both variants can be restricted to fetching files for a single account:</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>$ ./manage.py fetch_flickr_originals --account<span class="o">=</span>35034346050@N01
</pre></div>
</div>
<p>Files will be saved within your project&#8217;s <code class="docutils literal"><span class="pre">MEDIA_ROOT</span></code> directory, as defined in <code class="docutils literal"><span class="pre">settings.py</span></code>. There are two optional settings to customise the directories in which the files are saved. Their default values are as shown here:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">DITTO_FLICKR_DIR_BASE</span> <span class="o">=</span> <span class="s1">&#39;flickr&#39;</span>
<span class="n">DITTO_FLICKR_DIR_PHOTOS_FORMAT</span> <span class="o">=</span> <span class="s1">&#39;%Y/%m/</span><span class="si">%d</span><span class="s1">&#39;</span>
</pre></div>
</div>
<p>These values are used if you don&#8217;t specify your own settings.</p>
<p>If your <code class="docutils literal"><span class="pre">MEDIA_ROOT</span></code> was set to <code class="docutils literal"><span class="pre">/var/www/example.com/media/</span></code> then the above settings would save the Flickr photo <code class="docutils literal"><span class="pre">1234567_987654_o.jpg</span></code> to something like this, depending on the Flickr user&#8217;s NSID and the date the photo was taken (not uploaded):</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>/var/www/example.com/media/flickr/35034346050N01/photos/2016/08/31/1234567_987654_o.jpg
</pre></div>
</div>
<p>Note that videos will have <em>two</em> &#8220;original&#8221; files downloaded: the video itself and a JPG image that Flickr created for it.</p>
<p>Once you&#8217;ve downloaded the original image files, you can use these to generate all the different sizes of image required for your site, instead of linking direct to the image files on flickr.com. To do this, ensure <code class="docutils literal"><span class="pre">imagekit</span></code> is in your <code class="docutils literal"><span class="pre">INSTALLED_APPS</span></code> setting:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">(</span>
    <span class="c1"># ...</span>
    <span class="s1">&#39;imagekit&#39;</span><span class="p">,</span>
    <span class="c1"># ...</span>
<span class="p">)</span>
</pre></div>
</div>
<p>And add this to your <cite>settings.py</cite> (its default value is <code class="docutils literal"><span class="pre">False</span></code>):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">DITTO_FLICKR_USE_LOCAL_MEDIA</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
<p>Any requests in your templates for the URLs of photo files of any size will now use resized versions of your downloaded original files, generated by Imagekit.  The first time you load a page (especially if it lists many Flickr images) it will be slow, but the images are cached (in a <code class="docutils literal"><span class="pre">CACHE</span></code> directory in your media folder).</p>
<p>For example, before changing this setting, the URL of small image (<code class="docutils literal"><span class="pre">Photo.small_url</span></code>) would be something like this:</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>https://farm8.static.flickr.com/7442/27289611500_d0debff24e_m.jpg
</pre></div>
</div>
<p>After choosing to use local photos, it would be something like this:</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>/media/CACHE/images/flickr/35034346050N01/photos/2016/06/09/27289611500_d21f6f47a0_o/0ee894a3438233848e6e9d85e1985260.jpg
</pre></div>
</div>
<p>If you change your mind you can switch back to using the images hosted on flickr.com by removing the <code class="docutils literal"><span class="pre">DITTO_FLICKR_USE_LOCAL_MEDIA</span></code> setting or changing it to <code class="docutils literal"><span class="pre">False</span></code>.</p>
<p>Note that Ditto currently can&#8217;t do the same for videos, even if the original video file has been downloaded. No matter what the  value of <code class="docutils literal"><span class="pre">DITTO_FLICKR_USE_LOCAL_MEDIA</span></code> the flickr.com URL for videos is always used.</p>
</div>
<div class="section" id="photosets">
<h2>Photosets<a class="headerlink" href="#photosets" title="Permalink to this headline">¶</a></h2>
<p>You can fetch data about your Photosets (also known as Albums) any time, but this won&#8217;t fetch detailed data about Photos within them.</p>
<p>So, for best results, ensure all Photos are downloaded before fetching Photoset data.</p>
<p>To fetch Photosets for all Accounts:</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>$ ./manage.py fetch_flickr_photosets
</pre></div>
</div>
<p>Or fetch for only one Account:</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>$ ./manage.py fetch_flickr_photosets --account<span class="o">=</span>35034346050@N01
</pre></div>
</div>
</div>
<div class="section" id="users">
<h2>Users<a class="headerlink" href="#users" title="Permalink to this headline">¶</a></h2>
<p>Profile photos of Flickr Users are downloaded and stored in your project&#8217;s <code class="docutils literal"><span class="pre">MEDIA_ROOT</span></code> directory. You can optionally set the <code class="docutils literal"><span class="pre">DITTO_FLICKR_DIR_BASE</span></code> setting to change the location. The default is:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">DITTO_FLICKR_DIR_BASE</span> <span class="o">=</span> <span class="s1">&#39;flickr&#39;</span>
</pre></div>
</div>
<p>If your <code class="docutils literal"><span class="pre">MEDIA_ROOT</span></code> was set to <code class="docutils literal"><span class="pre">/var/www/example.com/media/</span></code> then the above setting would save the profile image for the user with NSID <code class="docutils literal"><span class="pre">35034346050&#64;N01</span></code> to something like this:</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>/var/www/example.com/media/flickr/46/05/35034346050N01/avatars/35034346050N01.jpg
</pre></div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="pinboard.html" class="btn btn-neutral float-right" title="Pinboard" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../installation.html" class="btn btn-neutral" title="Installation" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Phil Gyford.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.2.4',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>