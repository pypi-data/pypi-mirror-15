<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Instruments &mdash; Workload Automation 2.4.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.4.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="Workload Automation 2.4.0 documentation" href="../index.html" />
    <link rel="next" title="Result_processors" href="result_processors.html" />
    <link rel="prev" title="Workloads" href="workloads.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="result_processors.html" title="Result_processors"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="workloads.html" title="Workloads"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Workload Automation 2.4.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="instruments">
<span id="id1"></span><h1>Instruments<a class="headerlink" href="#instruments" title="Permalink to this headline">¶</a></h1>
<div class="section" id="apk-version">
<h2>apk_version<a class="headerlink" href="#apk-version" title="Permalink to this headline">¶</a></h2>
<p>Extracts APK versions for workloads that have them.</p>
<div class="section" id="parameters">
<h3>parameters<a class="headerlink" href="#parameters" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>modules <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd>Lists the modules to be loaded by this extension. A module is a plug-in that
further extends functionality of an extension.</dd>
</dl>
</div>
</div>
<div class="section" id="cci-pmu-logger">
<h2>cci_pmu_logger<a class="headerlink" href="#cci-pmu-logger" title="Permalink to this headline">¶</a></h2>
<p>This instrument allows collecting CCI counter data.</p>
<p>It relies on the pmu_logger.ko kernel driver, the source for which is
included with Workload Automation (see inside <code class="docutils literal"><span class="pre">wlauto/external</span></code> directory).
You will need to build this against your specific kernel. Once compiled, it needs
to be placed in the dependencies directory (usually <code class="docutils literal"><span class="pre">~/.workload_uatomation/dependencies</span></code>).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When compling pmu_logger.ko for a new hardware platform, you may need to
modify CCI_BASE inside pmu_logger.c to contain the base address of where
CCI is mapped in memory on your device.</p>
</div>
<p>This instrument relies on <code class="docutils literal"><span class="pre">trace-cmd</span></code> instrument to also be enabled. You should enable
at least <code class="docutils literal"><span class="pre">'bprint'</span></code> trace event.</p>
<div class="section" id="id2">
<h3>parameters<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>modules <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd>Lists the modules to be loaded by this extension. A module is a plug-in that
further extends functionality of an extension.</dd>
<dt>events <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd><p class="first">A list of strings, each representing an event to be counted. The length
of the list cannot exceed the number of PMU counters available (4 in CCI-400).
If this is not specified, shareable read transactions and snoop hits on both
clusters will be counted by default.  E.g. <code class="docutils literal"><span class="pre">['0x63',</span> <span class="pre">'0x83']</span></code>.</p>
<p class="last">default: <code class="docutils literal"><span class="pre">['0x63',</span> <span class="pre">'0x6A',</span> <span class="pre">'0x83',</span> <span class="pre">'0x8A']</span></code></p>
</dd>
<dt>event_labels <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd>A list of labels to be used when reporting PMU counts. If specified,
this must be of the same length as <code class="docutils literal"><span class="pre">cci_pmu_events</span></code>. If not specified,
events will be labeled &#8220;event_&lt;event_number&gt;&#8221;.</dd>
<dt>period <span class="classifier-delimiter">:</span> <span class="classifier">integer</span></dt>
<dd><p class="first">The period (in jiffies) between counter reads.</p>
<p class="last">default: <code class="docutils literal"><span class="pre">10</span></code></p>
</dd>
<dt>install_module <span class="classifier-delimiter">:</span> <span class="classifier">boolean</span></dt>
<dd><p class="first">Specifies whether pmu_logger has been compiled as a .ko module that needs
to be installed by the instrument. (.ko binary must be in /home.local/setrofim/.workload_automation/dependencies). If this is set
to <code class="docutils literal"><span class="pre">False</span></code>, it will be assumed that pmu_logger has been compiled into the kernel,
or that it has been installed prior to the invocation of WA.</p>
<p class="last">default: <code class="docutils literal"><span class="pre">True</span></code></p>
</dd>
</dl>
</div>
</div>
<div class="section" id="coreutil">
<h2>coreutil<a class="headerlink" href="#coreutil" title="Permalink to this headline">¶</a></h2>
<p>Measures CPU core activity during workload execution in terms of the percentage of time a number
of cores were utilized above the specfied threshold.</p>
<p>This workload generates <code class="docutils literal"><span class="pre">coreutil.csv</span></code> report in the workload&#8217;s output directory. The report is
formatted as follows:</p>
<div class="highlight-python"><div class="highlight"><pre>&lt;threshold,1core,2core,3core,4core
18.098132,38.650248000000005,10.736180000000001,3.6809760000000002,28.834312000000001
</pre></div>
</div>
<p>Interpretation of the result:</p>
<blockquote>
<div><ul class="simple">
<li>38.65% of total time only single core is running above or equal to threshold value</li>
<li>10.736% of total time two cores are running simultaneously above or equal to threshold value</li>
<li>3.6809% of total time three cores are running simultaneously above or equal to threshold value</li>
<li>28.8314% of total time four cores are running simultaneously above or equal to threshold value</li>
<li>18.098% of time all core are running below threshold value.</li>
</ul>
</div></blockquote>
<p>..note : This instrument doesn&#8217;t work on ARM big.LITTLE IKS implementation</p>
<div class="section" id="id3">
<h3>parameters<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>modules <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd>Lists the modules to be loaded by this extension. A module is a plug-in that
further extends functionality of an extension.</dd>
<dt>threshold <span class="classifier-delimiter">:</span> <span class="classifier">integer</span></dt>
<dd><p class="first">Cores with percentage utilization above this value will be considered as &#8220;utilized&#8221;. This value may need to be adjusted based on the background activity and the intensity of the workload being instrumented (e.g. it may need to be lowered for low-intensity workloads such as video playback).</p>
<p>constraint: <code class="docutils literal"><span class="pre">0</span> <span class="pre">&lt;</span> <span class="pre">value</span> <span class="pre">&lt;=</span> <span class="pre">100</span></code></p>
<p class="last">default: <code class="docutils literal"><span class="pre">50</span></code></p>
</dd>
</dl>
</div>
</div>
<div class="section" id="cpufreq">
<h2>cpufreq<a class="headerlink" href="#cpufreq" title="Permalink to this headline">¶</a></h2>
<p>Collects dynamic frequency (DVFS) settings before and after workload execution.</p>
<div class="section" id="id4">
<h3>parameters<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>modules <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd>Lists the modules to be loaded by this extension. A module is a plug-in that
further extends functionality of an extension.</dd>
<dt>paths <span class="classifier-delimiter">:</span> <span class="classifier">list_of_strs</span></dt>
<dd>A list of paths to be pulled from the device. These could be directories
as well as files.</dd>
<dt>use_tmpfs <span class="classifier-delimiter">:</span> <span class="classifier">boolean</span></dt>
<dd>Specifies whether tmpfs should be used to cache sysfile trees and then pull them down
as a tarball. This is significantly faster then just copying the directory trees from
the device directly, bur requres root and may not work on all devices. Defaults to
<code class="docutils literal"><span class="pre">True</span></code> if the device is rooted and <code class="docutils literal"><span class="pre">False</span></code> if it is not.</dd>
<dt>tmpfs_mount_point <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd>Mount point for tmpfs partition used to store snapshots of paths.</dd>
<dt>tmpfs_size <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first">Size of the tempfs partition.</p>
<p class="last">default: <code class="docutils literal"><span class="pre">'32m'</span></code></p>
</dd>
</dl>
</div>
</div>
<div class="section" id="daq">
<h2>daq<a class="headerlink" href="#daq" title="Permalink to this headline">¶</a></h2>
<p>DAQ instrument obtains the power consumption of the target device&#8217;s core
measured by National Instruments Data Acquisition(DAQ) device.</p>
<p>WA communicates with a DAQ device server running on a Windows machine
(Please refer to <a class="reference internal" href="../daq_device_setup.html#daq-setup"><span>DAQ Server Guide</span></a>) over a network. You must specify the IP
address and port the server is listening on in the config file as follows</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">daq_server_host</span> <span class="o">=</span> <span class="s">&#39;10.1.197.176&#39;</span>
<span class="n">daq_server_port</span> <span class="o">=</span> <span class="mi">45677</span>
</pre></div>
</div>
<p>These values will be output by the server when you run it on Windows.</p>
<p>You must also specify the values of resistors (in Ohms) across which the
voltages are measured (Please refer to <a class="reference internal" href="../daq_device_setup.html#daq-setup"><span>DAQ Server Guide</span></a>). The values should be
specified as a list with an entry for each resistor, e.g.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">daq_resistor_values</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.005</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">]</span>
</pre></div>
</div>
<p>In addition to this mandatory configuration, you can also optionally specify the
following:</p>
<div class="highlight-python"><div class="highlight"><pre>:daq_labels: Labels to be used for ports. Defaults to ``&#39;PORT_&lt;pnum&gt;&#39;``, where
             &#39;pnum&#39; is the number of the port.
:daq_device_id: The ID under which the DAQ is registered with the driver.
                Defaults to ``&#39;Dev1&#39;``.
:daq_v_range: Specifies the voltage range for the SOC voltage channel on the DAQ
              (please refer to :ref:`daq_setup` for details). Defaults to ``2.5``.
:daq_dv_range: Specifies the voltage range for the resistor voltage channel on
               the DAQ (please refer to :ref:`daq_setup` for details).
               Defaults to ``0.2``.
:daq_sampling_rate: DAQ sampling rate. DAQ will take this many samples each
                    second. Please note that this maybe limitted by your DAQ model
                    and then number of ports you&#39;re measuring (again, see
                    :ref:`daq_setup`). Defaults to ``10000``.
:daq_channel_map: Represents mapping from  logical AI channel number to physical
                  connector on the DAQ (varies between DAQ models). The default
                  assumes DAQ 6363 and similar with AI channels on connectors
                  0-7 and 16-23.
</pre></div>
</div>
<div class="section" id="id5">
<h3>parameters<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>modules <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd>Lists the modules to be loaded by this extension. A module is a plug-in that
further extends functionality of an extension.</dd>
<dt>server_host <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first">The host address of the machine that runs the daq Server which the insturment communicates with.</p>
<p class="last">default: <code class="docutils literal"><span class="pre">'localhost'</span></code></p>
</dd>
<dt>server_port <span class="classifier-delimiter">:</span> <span class="classifier">integer</span></dt>
<dd><p class="first">The port number for daq Server in which daq insturment communicates with.</p>
<p class="last">default: <code class="docutils literal"><span class="pre">45677</span></code></p>
</dd>
<dt>device_id <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first">The ID under which the DAQ is registered with the driver.</p>
<p class="last">default: <code class="docutils literal"><span class="pre">'Dev1'</span></code></p>
</dd>
<dt>v_range <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first">Specifies the voltage range for the SOC voltage channel on the DAQ (please refer to <a class="reference internal" href="../daq_device_setup.html#daq-setup"><span>DAQ Server Guide</span></a> for details).</p>
<p class="last">default: <code class="docutils literal"><span class="pre">2.5</span></code></p>
</dd>
<dt>dv_range <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first">Specifies the voltage range for the resistor voltage channel on the DAQ (please refer to <a class="reference internal" href="../daq_device_setup.html#daq-setup"><span>DAQ Server Guide</span></a> for details).</p>
<p class="last">default: <code class="docutils literal"><span class="pre">0.2</span></code></p>
</dd>
<dt>sampling_rate <span class="classifier-delimiter">:</span> <span class="classifier">integer</span></dt>
<dd><p class="first">DAQ sampling rate. DAQ will take this many samples each second. Please note that this maybe limitted by your DAQ model and then number of ports you&#8217;re measuring (again, see <a class="reference internal" href="../daq_device_setup.html#daq-setup"><span>DAQ Server Guide</span></a>)</p>
<p class="last">default: <code class="docutils literal"><span class="pre">10000</span></code></p>
</dd>
<dt>resistor_values <span class="classifier-delimiter">:</span> <span class="classifier">list (mandatory)</span></dt>
<dd>The values of resistors (in Ohms) across which the voltages are measured on each port.</dd>
<dt>channel_map <span class="classifier-delimiter">:</span> <span class="classifier">list_of_ints</span></dt>
<dd><p class="first">Represents mapping from  logical AI channel number to physical connector on the DAQ (varies between DAQ models). The default assumes DAQ 6363 and similar with AI channels on connectors 0-7 and 16-23.</p>
<p class="last">default: <code class="docutils literal"><span class="pre">(0,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3,</span> <span class="pre">4,</span> <span class="pre">5,</span> <span class="pre">6,</span> <span class="pre">7,</span> <span class="pre">16,</span> <span class="pre">17,</span> <span class="pre">18,</span> <span class="pre">19,</span> <span class="pre">20,</span> <span class="pre">21,</span> <span class="pre">22,</span> <span class="pre">23)</span></code></p>
</dd>
<dt>labels <span class="classifier-delimiter">:</span> <span class="classifier">list_of_strs</span></dt>
<dd>List of port labels. If specified, the lenght of the list must match the length of <code class="docutils literal"><span class="pre">resistor_values</span></code>. Defaults to &#8220;PORT_&lt;pnum&gt;&#8221;, where &#8220;pnum&#8221; is the number of the port.</dd>
<dt>negative_samples <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first">Specifies how negative power samples should be handled. The following
methods are possible:</p>
<blockquote>
<div><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">keep:</th><td class="field-body">keep them as they are</td>
</tr>
<tr class="field-even field"><th class="field-name">zero:</th><td class="field-body">turn negative values to zero</td>
</tr>
<tr class="field-odd field"><th class="field-name">drop:</th><td class="field-body">drop samples if they contain negative values. <em>warning:</em> this may result in
port files containing different numbers of samples</td>
</tr>
<tr class="field-even field"><th class="field-name">abs:</th><td class="field-body">take the absoulte value of negave samples</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>allowed values: <code class="docutils literal"><span class="pre">'keep'</span></code>, <code class="docutils literal"><span class="pre">'zero'</span></code>, <code class="docutils literal"><span class="pre">'drop'</span></code>, <code class="docutils literal"><span class="pre">'abs'</span></code></p>
<p class="last">default: <code class="docutils literal"><span class="pre">'keep'</span></code></p>
</dd>
<dt>gpio_sync <span class="classifier-delimiter">:</span> <span class="classifier">integer</span></dt>
<dd><p class="first">If specified, the instrument will simultaneously set the
specified GPIO pin high and put a marker into ftrace. This is
to facillitate syncing kernel trace events to DAQ power
trace.</p>
<p class="last">constraint: <code class="docutils literal"><span class="pre">value</span> <span class="pre">&gt;</span> <span class="pre">0</span></code></p>
</dd>
<dt>merge_channels <span class="classifier-delimiter">:</span> <span class="classifier">dict_or_bool</span></dt>
<dd><p class="first">If set to <code class="docutils literal"><span class="pre">True</span></code>, channels with consecutive letter suffixes will be summed.
e.g. If you have channels A7a, A7b, A7c, A15a, A15b they will be summed to A7, A15</p>
<p>You can also manually specify the name of channels to be merged and the name of the
result like so:</p>
<dl class="docutils">
<dt>merge_channels:</dt>
<dd>A15: [A15dvfs, A15ram]
NonCPU: [GPU, RoS, Mem]</dd>
</dl>
<p class="last">In the above exaples the DAQ channels labeled A15a and A15b will be summed together
with the results being saved as &#8216;channel&#8217; &#8216;&#8217;a&#8217;&#8216;. A7, GPU and RoS will be summed to &#8216;c&#8217;</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="delay">
<h2>delay<a class="headerlink" href="#delay" title="Permalink to this headline">¶</a></h2>
<p>This instrument introduces a delay before executing either an iteration
or all iterations for a spec.</p>
<p>The delay may be specified as either a fixed period or a temperature
threshold that must be reached.</p>
<p>Optionally, if an active cooling solution is employed to speed up temperature drop between
runs, it may be controlled using this instrument.</p>
<div class="section" id="id6">
<h3>parameters<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>modules <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd>Lists the modules to be loaded by this extension. A module is a plug-in that
further extends functionality of an extension.</dd>
<dt>temperature_file <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first">Full path to the sysfile on the device that contains the device&#8217;s
temperature.</p>
<p class="last">default: <code class="docutils literal"><span class="pre">'/sys/devices/virtual/thermal/thermal_zone0/temp'</span></code></p>
</dd>
<dt>temperature_timeout <span class="classifier-delimiter">:</span> <span class="classifier">integer</span></dt>
<dd><p class="first">The timeout after which the instrument will stop waiting even if the specified threshold
temperature is not reached. If this timeout is hit, then a warning will be logged stating
the actual temperature at which the timeout has ended.</p>
<p class="last">default: <code class="docutils literal"><span class="pre">600</span></code></p>
</dd>
<dt>temperature_poll_period <span class="classifier-delimiter">:</span> <span class="classifier">integer</span></dt>
<dd><p class="first">How long to sleep (in seconds) between polling current device temperature.</p>
<p class="last">default: <code class="docutils literal"><span class="pre">5</span></code></p>
</dd>
<dt>temperature_between_specs <span class="classifier-delimiter">:</span> <span class="classifier">integer</span></dt>
<dd><p class="first">Temperature (in device-specific units) the device must cool down to before
the iteration spec will be run.</p>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This cannot be specified at the same time as <code class="docutils literal"><span class="pre">fixed_between_specs</span></code></p>
</div>
</dd>
<dt>temperature_between_iterations <span class="classifier-delimiter">:</span> <span class="classifier">integer</span></dt>
<dd><p class="first">Temperature (in device-specific units) the device must cool down to before
the next spec will be run.</p>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This cannot be specified at the same time as <code class="docutils literal"><span class="pre">fixed_between_iterations</span></code></p>
</div>
</dd>
<dt>temperature_before_start <span class="classifier-delimiter">:</span> <span class="classifier">integer</span></dt>
<dd><p class="first">Temperature (in device-specific units) the device must cool down to just before
the actual workload execution (after setup has been performed).</p>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This cannot be specified at the same time as <code class="docutils literal"><span class="pre">fixed_between_iterations</span></code></p>
</div>
</dd>
<dt>fixed_between_specs <span class="classifier-delimiter">:</span> <span class="classifier">integer</span></dt>
<dd><p class="first">How long to sleep (in seconds) after all iterations for a workload spec have
executed.</p>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This cannot be specified at the same time as <code class="docutils literal"><span class="pre">temperature_between_specs</span></code></p>
</div>
</dd>
<dt>fixed_between_iterations <span class="classifier-delimiter">:</span> <span class="classifier">integer</span></dt>
<dd><p class="first">How long to sleep (in seconds) after each iterations for a workload spec has
executed.</p>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This cannot be specified at the same time as <code class="docutils literal"><span class="pre">temperature_between_iterations</span></code></p>
</div>
</dd>
<dt>fixed_before_start <span class="classifier-delimiter">:</span> <span class="classifier">integer</span></dt>
<dd><p class="first">How long to sleep (in seconds) after setup for an iteration has been perfromed but
before running the workload.</p>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This cannot be specified at the same time as <code class="docutils literal"><span class="pre">temperature_before_start</span></code></p>
</div>
</dd>
<dt>active_cooling <span class="classifier-delimiter">:</span> <span class="classifier">boolean</span></dt>
<dd>This instrument supports an active cooling solution while waiting for the device temperature
to drop to the threshold. The solution involves an mbed controlling a fan. The mbed is signaled
over a serial port. If this solution is present in the setup, this should be set to <code class="docutils literal"><span class="pre">True</span></code>.</dd>
</dl>
</div>
</div>
<div class="section" id="dmesg">
<h2>dmesg<a class="headerlink" href="#dmesg" title="Permalink to this headline">¶</a></h2>
<p>Collected dmesg output before and during the run.</p>
<div class="section" id="id7">
<h3>parameters<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>modules <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd>Lists the modules to be loaded by this extension. A module is a plug-in that
further extends functionality of an extension.</dd>
<dt>loglevel <span class="classifier-delimiter">:</span> <span class="classifier">integer</span></dt>
<dd><p class="first">Set loglevel for console output.</p>
<p class="last">allowed values: <code class="docutils literal"><span class="pre">0</span></code>, <code class="docutils literal"><span class="pre">1</span></code>, <code class="docutils literal"><span class="pre">2</span></code>, <code class="docutils literal"><span class="pre">3</span></code>, <code class="docutils literal"><span class="pre">4</span></code>, <code class="docutils literal"><span class="pre">5</span></code>, <code class="docutils literal"><span class="pre">6</span></code>, <code class="docutils literal"><span class="pre">7</span></code></p>
</dd>
</dl>
</div>
</div>
<div class="section" id="energy-model">
<h2>energy_model<a class="headerlink" href="#energy-model" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id8">
<h3>parameters<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>modules <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd>Lists the modules to be loaded by this extension. A module is a plug-in that
further extends functionality of an extension.</dd>
<dt>device_name <span class="classifier-delimiter">:</span> <span class="classifier">caseless_string</span></dt>
<dd>The name of the device to be used in  generating the model. If not specified,
<code class="docutils literal"><span class="pre">device.name</span></code> will be used.</dd>
<dt>big_core <span class="classifier-delimiter">:</span> <span class="classifier">caseless_string</span></dt>
<dd>The name of the &#8220;big&#8221; core in the big.LITTLE system; must match
one of the values in <code class="docutils literal"><span class="pre">device.core_names</span></code>.</dd>
<dt>performance_metric <span class="classifier-delimiter">:</span> <span class="classifier">caseless_string (mandatory)</span></dt>
<dd>Metric to be used as the performance indicator.</dd>
<dt>power_metric <span class="classifier-delimiter">:</span> <span class="classifier">list_or_caseless_string</span></dt>
<dd>Metric to be used as the power indicator. The value may contain a
<code class="docutils literal"><span class="pre">{core}</span></code> format specifier that will be replaced with names of big
and little cores to drive the name of the metric for that cluster.
Ether this or <code class="docutils literal"><span class="pre">energy_metric</span></code> must be specified but not both.</dd>
<dt>energy_metric <span class="classifier-delimiter">:</span> <span class="classifier">list_or_caseless_string</span></dt>
<dd>Metric to be used as the energy indicator. The value may contain a
<code class="docutils literal"><span class="pre">{core}</span></code> format specifier that will be replaced with names of big
and little cores to drive the name of the metric for that cluster.
this metric will be used to derive power by deviding through by
execution time. Either this or <code class="docutils literal"><span class="pre">power_metric</span></code> must be specified, but
not both.</dd>
<dt>power_scaling_factor <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first">Power model specfies power in milliWatts. This is a scaling factor that
power_metric values will be multiplied by to get milliWatts.</p>
<p class="last">default: <code class="docutils literal"><span class="pre">1.0</span></code></p>
</dd>
<dt>big_frequencies <span class="classifier-delimiter">:</span> <span class="classifier">list_of_ints</span></dt>
<dd>List of frequencies to be used for big cores. These frequencies must
be supported by the cores. If this is not specified, all available
frequencies for the core (as read from cpufreq) will be used.</dd>
<dt>little_frequencies <span class="classifier-delimiter">:</span> <span class="classifier">list_of_ints</span></dt>
<dd>List of frequencies to be used for little cores. These frequencies must
be supported by the cores. If this is not specified, all available
frequencies for the core (as read from cpufreq) will be used.</dd>
<dt>idle_workload <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first">Workload to be used while measuring idle power.</p>
<p class="last">default: <code class="docutils literal"><span class="pre">'idle'</span></code></p>
</dd>
<dt>idle_workload_params <span class="classifier-delimiter">:</span> <span class="classifier">dict</span></dt>
<dd>Parameter to pass to the idle workload.</dd>
<dt>first_cluster_idle_state <span class="classifier-delimiter">:</span> <span class="classifier">integer</span></dt>
<dd><p class="first">The index of the first cluster idle state on the device. Previous states
are assumed to be core idles. The default is <code class="docutils literal"><span class="pre">-1</span></code>, i.e. only the last
idle state is assumed to affect the entire cluster.</p>
<p class="last">default: <code class="docutils literal"><span class="pre">-1</span></code></p>
</dd>
<dt>no_hotplug <span class="classifier-delimiter">:</span> <span class="classifier">boolean</span></dt>
<dd>This options allows running the instrument without hotpluging cores on and off.
Disabling hotplugging will most likely produce a less accurate power model.</dd>
<dt>num_of_freqs_to_thermal_adjust <span class="classifier-delimiter">:</span> <span class="classifier">integer</span></dt>
<dd>The number of frequencies begining from the highest, to be adjusted for
the thermal effect.</dd>
<dt>big_opps <span class="classifier-delimiter">:</span> <span class="classifier">opp_table</span></dt>
<dd>OPP table mapping frequency to voltage (kHz &#8211;&gt; mV) for the big cluster.</dd>
<dt>little_opps <span class="classifier-delimiter">:</span> <span class="classifier">opp_table</span></dt>
<dd>OPP table mapping frequency to voltage (kHz &#8211;&gt; mV) for the little cluster.</dd>
<dt>big_leakage <span class="classifier-delimiter">:</span> <span class="classifier">integer</span></dt>
<dd><p class="first">Leakage factor for the big cluster (this is specific to a particular core implementation).</p>
<p class="last">default: <code class="docutils literal"><span class="pre">120</span></code></p>
</dd>
<dt>little_leakage <span class="classifier-delimiter">:</span> <span class="classifier">integer</span></dt>
<dd><p class="first">Leakage factor for the little cluster (this is specific to a particular core implementation).</p>
<p class="last">default: <code class="docutils literal"><span class="pre">60</span></code></p>
</dd>
</dl>
</div>
</div>
<div class="section" id="energy-probe">
<h2>energy_probe<a class="headerlink" href="#energy-probe" title="Permalink to this headline">¶</a></h2>
<p>Collects power traces using the ARM energy probe.</p>
<blockquote>
<div><p>This instrument requires <code class="docutils literal"><span class="pre">caiman</span></code> utility to be installed in the workload automation
host and be in the PATH. Caiman is part of DS-5 and should be in <code class="docutils literal"><span class="pre">/path/to/DS-5/bin/</span></code> .
Energy probe can simultaneously collect energy from up to 3 power rails.</p>
<p>To connect the energy probe on a rail, connect the white wire to the pin that is closer to the
Voltage source and the black wire to the pin that is closer to the load (the SoC or the device
you are probing). Between the pins there should be a shunt resistor of known resistance in the
range of 5 to 20 mOhm. The resistance of the shunt resistors is a mandatory parameter
<code class="docutils literal"><span class="pre">resistor_values</span></code>.</p>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This instrument can process results a lot faster if python pandas is installed.</p>
</div>
<div class="section" id="id9">
<h3>parameters<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>modules <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd>Lists the modules to be loaded by this extension. A module is a plug-in that
further extends functionality of an extension.</dd>
<dt>resistor_values <span class="classifier-delimiter">:</span> <span class="classifier">list_of_numbers</span></dt>
<dd>The value of shunt resistors. This is a mandatory parameter.</dd>
<dt>labels <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd>Meaningful labels for each of the monitored rails.</dd>
<dt>device_entry <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first">Path to /dev entry for the energy probe (it should be /dev/ttyACMx)</p>
<p class="last">default: <code class="docutils literal"><span class="pre">'/dev/ttyACM0'</span></code></p>
</dd>
</dl>
</div>
</div>
<div class="section" id="execution-time">
<h2>execution_time<a class="headerlink" href="#execution-time" title="Permalink to this headline">¶</a></h2>
<p>Measure how long it took to execute the run() methods of a Workload.</p>
<div class="section" id="id10">
<h3>parameters<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>modules <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd>Lists the modules to be loaded by this extension. A module is a plug-in that
further extends functionality of an extension.</dd>
</dl>
</div>
</div>
<div class="section" id="fps">
<h2>fps<a class="headerlink" href="#fps" title="Permalink to this headline">¶</a></h2>
<p>Measures Frames Per Second (FPS) and associated metrics for a workload&#8217;s main View.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This instrument depends on pandas Python library (which is not part of standard
WA dependencies), so you will need to install that first, before you can use it.</p>
</div>
<p>The view is specified by the workload as <code class="docutils literal"><span class="pre">view</span></code> attribute. This defaults
to <code class="docutils literal"><span class="pre">'SurfaceView'</span></code> for game workloads, and <code class="docutils literal"><span class="pre">None</span></code> for non-game
workloads (as for them FPS mesurement usually doesn&#8217;t make sense).
Individual workloads may override this.</p>
<p>This instrument adds four metrics to the results:</p>
<blockquote>
<div><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">FPS:</th><td class="field-body">Frames Per Second. This is the frame rate of the workload.</td>
</tr>
<tr class="field-even field"><th class="field-name">frames:</th><td class="field-body">The total number of frames rendered during the execution of
the workload.</td>
</tr>
<tr class="field-odd field"><th class="field-name">janks:</th><td class="field-body">The number of &#8220;janks&#8221; that occured during execution of the
workload. Janks are sudden shifts in frame rate. They result
in a &#8220;stuttery&#8221; UI. See <a class="reference external" href="http://jankfree.org/jank-busters-io">http://jankfree.org/jank-busters-io</a></td>
</tr>
<tr class="field-even field"><th class="field-name">not_at_vsync:</th><td class="field-body">The number of frames that did not render in a single
vsync cycle.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="section" id="id11">
<h3>parameters<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>modules <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd>Lists the modules to be loaded by this extension. A module is a plug-in that
further extends functionality of an extension.</dd>
<dt>drop_threshold <span class="classifier-delimiter">:</span> <span class="classifier">numeric</span></dt>
<dd><p class="first">Data points below this FPS will be dropped as they do not constitute &#8220;real&#8221; gameplay. The assumption being that while actually running, the FPS in the game will not drop below X frames per second, except on loading screens, menus, etc, which should not contribute to FPS calculation.</p>
<p class="last">default: <code class="docutils literal"><span class="pre">5</span></code></p>
</dd>
<dt>keep_raw <span class="classifier-delimiter">:</span> <span class="classifier">boolean</span></dt>
<dd>If set to <code class="docutils literal"><span class="pre">True</span></code>, this will keep the raw dumpsys output in the results directory (this is maily used for debugging) Note: frames.csv with collected frames data will always be generated regardless of this setting.</dd>
<dt>generate_csv <span class="classifier-delimiter">:</span> <span class="classifier">boolean</span></dt>
<dd><p class="first">If set to <code class="docutils literal"><span class="pre">True</span></code>, this will produce temporal fps data in the results directory, in a file named fps.csv Note: fps data will appear as discrete step-like values in order to produce a more meainingfull representation,a rolling mean can be applied.</p>
<p class="last">default: <code class="docutils literal"><span class="pre">True</span></code></p>
</dd>
<dt>crash_check <span class="classifier-delimiter">:</span> <span class="classifier">boolean</span></dt>
<dd><p class="first">Specifies wither the instrument should check for crashed content by examining
frame data. If this is set, <code class="docutils literal"><span class="pre">execution_time</span></code> instrument must also be installed.
The check is performed by using the measured FPS and exection time to estimate the expected
frames cound and comparing that against the measured frames count. The the ratio of
measured/expected is too low, then it is assumed that the content has crashed part way
during the run. What is &#8220;too low&#8221; is determined by <code class="docutils literal"><span class="pre">crash_threshold</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is not 100% fool-proof. If the crash occurs sufficiently close to
workload&#8217;s termination,  it may not be detected. If this is expected, the
threshold may be adjusted up to compensate.</p>
</div>
<p class="last">default: <code class="docutils literal"><span class="pre">True</span></code></p>
</dd>
<dt>crash_threshold <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first">Specifies the threshold used to decided whether a measured/expected frames ration indicates
a content crash. E.g. a value of <code class="docutils literal"><span class="pre">0.75</span></code> means the number of actual frames counted is a
quarter lower than expected, it will treated as a content crash.</p>
<p class="last">default: <code class="docutils literal"><span class="pre">0.7</span></code></p>
</dd>
</dl>
</div>
</div>
<div class="section" id="freq-sweep">
<h2>freq_sweep<a class="headerlink" href="#freq-sweep" title="Permalink to this headline">¶</a></h2>
<p>Sweeps workloads through all available frequencies on a device.</p>
<p>When enabled this instrument will take all workloads specified in an agenda
and run them at all available frequencies for all clusters.</p>
<dl class="docutils">
<dt>Recommendations:</dt>
<dd><ul class="first last simple">
<li>Setting the runner to &#8216;by_spec&#8217; increases the chance of successfully
completing an agenda without encountering hotplug issues</li>
<li>If possible disable dynamic hotplug on the target device</li>
</ul>
</dd>
</dl>
<div class="section" id="id12">
<h3>parameters<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>modules <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd>Lists the modules to be loaded by this extension. A module is a plug-in that
further extends functionality of an extension.</dd>
<dt>sweeps <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd><blockquote class="first">
<div><p>By default this instrument will sweep across all available
frequencies for all available clusters. If you wish to only
sweep across certain frequencies on particular clusters you
can do so by specifying this parameter.</p>
<dl class="docutils">
<dt>Sweeps should be a lists of dictionaries that can contain:</dt>
<dd><ul class="first last">
<li><dl class="first docutils">
<dt>Cluster (mandatory): The name of the cluster this sweep will be</dt>
<dd><p class="first last">performed on. E.g A7</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Frequencies: A list of frequencies (in KHz) to use. If this is</dt>
<dd><p class="first last">not provided all frequencies available for this
cluster will be used.
E.g: [800000, 900000, 100000]</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>label: Workload specs will be named &#8216;{spec id}_{label}_{frequency}&#8217;.</dt>
<dd><p class="first last">If a label is not provided it will be named &#8216;sweep{sweep No.}&#8217;</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</div></blockquote>
<p>Example sweep specification:</p>
<blockquote class="last">
<div><dl class="docutils">
<dt>freq_sweep:</dt>
<dd><dl class="first last docutils">
<dt>sweeps:</dt>
<dd><ul class="first last simple">
<li>cluster: A53
label: littles
frequencies: [800000, 900000, 100000]</li>
<li>cluster: A57
label: bigs</li>
</ul>
</dd>
</dl>
</dd>
</dl>
</div></blockquote>
</dd>
</dl>
</div>
</div>
<div class="section" id="hwmon">
<h2>hwmon<a class="headerlink" href="#hwmon" title="Permalink to this headline">¶</a></h2>
<p>Hardware Monitor (hwmon) is a generic Linux kernel subsystem,
providing access to hardware monitoring components like temperature or
voltage/current sensors.</p>
<p>The following web page has more information:</p>
<blockquote>
<div><a class="reference external" href="http://blogs.arm.com/software-enablement/925-linux-hwmon-power-management-and-arm-ds-5-streamline/">http://blogs.arm.com/software-enablement/925-linux-hwmon-power-management-and-arm-ds-5-streamline/</a></div></blockquote>
<p>You can specify which sensors HwmonInstrument looks for by specifying
hwmon_sensors in your config.py, e.g.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">hwmon_sensors</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;energy&#39;</span><span class="p">,</span> <span class="s">&#39;temp&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>If this setting is not specified, it will look for all sensors it knows about.
Current valid values are:</p>
<div class="highlight-python"><div class="highlight"><pre>:energy: Collect energy measurements and report energy consumed
         during run execution (the diff of before and after readings)
         in Joules.
:temp: Collect temperature measurements and report the before and
       after readings in degrees Celsius.
</pre></div>
</div>
<div class="section" id="id13">
<h3>parameters<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>modules <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd>Lists the modules to be loaded by this extension. A module is a plug-in that
further extends functionality of an extension.</dd>
<dt>sensors <span class="classifier-delimiter">:</span> <span class="classifier">list_of_strs</span></dt>
<dd><p class="first">The kinds of sensors hwmon instrument will look for</p>
<p class="last">default: <code class="docutils literal"><span class="pre">['energy',</span> <span class="pre">'temp']</span></code></p>
</dd>
</dl>
</div>
</div>
<div class="section" id="interrupts">
<h2>interrupts<a class="headerlink" href="#interrupts" title="Permalink to this headline">¶</a></h2>
<p>Pulls the <code class="docutils literal"><span class="pre">/proc/interrupts</span></code> file before and after workload execution and diffs them
to show what interrupts  occurred during that time.</p>
<div class="section" id="id14">
<h3>parameters<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>modules <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd>Lists the modules to be loaded by this extension. A module is a plug-in that
further extends functionality of an extension.</dd>
</dl>
</div>
</div>
<div class="section" id="juno-energy">
<h2>juno_energy<a class="headerlink" href="#juno-energy" title="Permalink to this headline">¶</a></h2>
<p>Collects internal energy meter measurements from Juno development board.</p>
<p>This instrument was created because (at the time of creation) Juno&#8217;s energy
meter measurements aren&#8217;t exposed through HWMON or similar standardized mechanism,
necessitating  a dedicated instrument to access them.</p>
<p>This instrument, and the <code class="docutils literal"><span class="pre">readenergy</span></code> executable it relies on are very much tied
to the Juno platform and are not expected to work on other boards.</p>
<div class="section" id="id15">
<h3>parameters<a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>modules <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd>Lists the modules to be loaded by this extension. A module is a plug-in that
further extends functionality of an extension.</dd>
<dt>period <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first">Specifies the time, in Seconds, between polling energy counters.</p>
<p class="last">default: <code class="docutils literal"><span class="pre">0.1</span></code></p>
</dd>
</dl>
</div>
</div>
<div class="section" id="netstats">
<h2>netstats<a class="headerlink" href="#netstats" title="Permalink to this headline">¶</a></h2>
<p>Measures transmit/receive network traffic on an Android divice on per-package
basis.</p>
<div class="section" id="id16">
<h3>parameters<a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>modules <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd>Lists the modules to be loaded by this extension. A module is a plug-in that
further extends functionality of an extension.</dd>
<dt>packages <span class="classifier-delimiter">:</span> <span class="classifier">list_of_strs</span></dt>
<dd>List of Android packages who&#8217;s traffic will be monitored. If
unspecified, all packages in the device will be monitorred.</dd>
<dt>period <span class="classifier-delimiter">:</span> <span class="classifier">integer</span></dt>
<dd><p class="first">Polling period for instrumentation on the device. Traffic statistics
will be updated every <code class="docutils literal"><span class="pre">period</span></code> seconds.</p>
<p class="last">default: <code class="docutils literal"><span class="pre">5</span></code></p>
</dd>
<dt>force_reinstall <span class="classifier-delimiter">:</span> <span class="classifier">boolean</span></dt>
<dd>If <code class="docutils literal"><span class="pre">True</span></code>, instrumentation APK will always be re-installed even if
it already installed on the device.</dd>
<dt>uninstall_on_completion <span class="classifier-delimiter">:</span> <span class="classifier">boolean</span></dt>
<dd>If <code class="docutils literal"><span class="pre">True</span></code>, instrumentation will be uninstalled upon run completion.</dd>
</dl>
</div>
</div>
<div class="section" id="perf">
<h2>perf<a class="headerlink" href="#perf" title="Permalink to this headline">¶</a></h2>
<p>Perf is a Linux profiling with performance counters.</p>
<p>Performance counters are CPU hardware registers that count hardware events
such as instructions executed, cache-misses suffered, or branches
mispredicted. They form a basis for profiling applications to trace dynamic
control flow and identify hotspots.</p>
<p>pref accepts options and events. If no option is given the default &#8216;-a&#8217; is
used. For events, the default events are migrations and cs. They both can
be specified in the config file.</p>
<p>Events must be provided as a list that contains them and they will look like
this</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">perf_events</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;migrations&#39;</span><span class="p">,</span> <span class="s">&#39;cs&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Events can be obtained by typing the following in the command line on the
device</p>
<div class="highlight-python"><div class="highlight"><pre>perf list
</pre></div>
</div>
<p>Whereas options, they can be provided as a single string as following</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">perf_options</span> <span class="o">=</span> <span class="s">&#39;-a -i&#39;</span>
</pre></div>
</div>
<p>Options can be obtained by running the following in the command line</p>
<div class="highlight-python"><div class="highlight"><pre>man perf-record
</pre></div>
</div>
<div class="section" id="id17">
<h3>parameters<a class="headerlink" href="#id17" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>modules <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd>Lists the modules to be loaded by this extension. A module is a plug-in that
further extends functionality of an extension.</dd>
<dt>events <span class="classifier-delimiter">:</span> <span class="classifier">list_of_strs</span></dt>
<dd><p class="first">Specifies the events to be counted.</p>
<p>constraint: <code class="docutils literal"><span class="pre">must</span> <span class="pre">not</span> <span class="pre">be</span> <span class="pre">empty.</span></code></p>
<p class="last">default: <code class="docutils literal"><span class="pre">['migrations',</span> <span class="pre">'cs']</span></code></p>
</dd>
<dt>optionstring <span class="classifier-delimiter">:</span> <span class="classifier">list_or_string</span></dt>
<dd><p class="first">Specifies options to be used for the perf command. This
may be a list of option strings, in which case, multiple instances of perf
will be kicked off &#8211; one for each option string. This may be used to e.g.
collected different events from different big.LITTLE clusters.</p>
<p class="last">default: <code class="docutils literal"><span class="pre">'-a'</span></code></p>
</dd>
<dt>labels <span class="classifier-delimiter">:</span> <span class="classifier">list_of_strs</span></dt>
<dd>Provides labels for pref output. If specified, the number of
labels must match the number of <code class="docutils literal"><span class="pre">optionstring</span></code>s.</dd>
<dt>force_install <span class="classifier-delimiter">:</span> <span class="classifier">boolean</span></dt>
<dd>always install perf binary even if perf is already present on the device.</dd>
</dl>
</div>
</div>
<div class="section" id="screenon">
<h2>screenon<a class="headerlink" href="#screenon" title="Permalink to this headline">¶</a></h2>
<p>Ensure screen is on before each iteration on Android devices.</p>
<p>A very basic instrument that checks that the screen is on on android devices. Optionally,
it call poll the device periodically to ensure that the screen is still on.</p>
<div class="section" id="id18">
<h3>parameters<a class="headerlink" href="#id18" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>modules <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd>Lists the modules to be loaded by this extension. A module is a plug-in that
further extends functionality of an extension.</dd>
<dt>polling_period <span class="classifier-delimiter">:</span> <span class="classifier">integer</span></dt>
<dd>Set this to a non-zero value to enable periodic (every
<code class="docutils literal"><span class="pre">polling_period</span></code> seconds) polling of the screen on
the device to ensure it is on during a run.</dd>
</dl>
</div>
</div>
<div class="section" id="streamline">
<h2>streamline<a class="headerlink" href="#streamline" title="Permalink to this headline">¶</a></h2>
<p>Collect Streamline traces from the device.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This instrument supports streamline that comes with DS-5 5.17 and later
earlier versions of streamline  may not work correctly (or at all).</p>
</div>
<p>This Instrument allows collecting streamline traces (such as PMU counter values) from
the device. It assumes you have DS-5 (which Streamline is part of) installed on your
system, and that streamline command is somewhere in PATH.</p>
<p>Streamline works by connecting to gator service on the device. gator comes in two parts
a driver (gator.ko) and daemon (gatord). The driver needs to be compiled against your
kernel and both driver and daemon need to be compatible with your version of Streamline.
The best way to ensure compatibility is to build them from source which came with your
DS-5. gator source can be found in</p>
<div class="highlight-python"><div class="highlight"><pre>/usr/local/DS-5/arm/gator
</pre></div>
</div>
<p>(the exact path may vary depending of where you have installed DS-5.) Please refer to the
README the accompanies the source for instructions on how to build it.</p>
<p>Once you have built the driver and the daemon, place the binaries into your
~/.workload_automation/streamline/ directory (if you haven&#8217;t tried running WA with
this instrument before, the streamline/ subdirectory might not exist, in which
case you will need to create it.</p>
<p>In order to specify which events should be captured, you need to provide a
configuration.xml for the gator. The easiest way to obtain this file is to export it
from event configuration dialog in DS-5 streamline GUI. The file should be called
&#8220;configuration.xml&#8221; and it be placed in the same directory as the gator binaries.</p>
<div class="section" id="id19">
<h3>parameters<a class="headerlink" href="#id19" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>modules <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd>Lists the modules to be loaded by this extension. A module is a plug-in that
further extends functionality of an extension.</dd>
<dt>port <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first">Specifies the port on which streamline will connect to gator</p>
<p class="last">default: <code class="docutils literal"><span class="pre">'8080'</span></code></p>
</dd>
<dt>configxml <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd>streamline configuration XML file to be used. This must be an absolute path, though it may count the user home symbol (~)</dd>
<dt>report <span class="classifier-delimiter">:</span> <span class="classifier">boolean</span></dt>
<dd>Specifies whether a report should be generated from streamline data.</dd>
<dt>report_options <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first">A string with options that will be added to streamline -report command.</p>
<p class="last">default: <code class="docutils literal"><span class="pre">'-format</span> <span class="pre">csv'</span></code></p>
</dd>
</dl>
</div>
</div>
<div class="section" id="sysfs-extractor">
<h2>sysfs_extractor<a class="headerlink" href="#sysfs-extractor" title="Permalink to this headline">¶</a></h2>
<p>Collects the contest of a set of directories, before and after workload execution
and diffs the result.</p>
<div class="section" id="id20">
<h3>parameters<a class="headerlink" href="#id20" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>modules <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd>Lists the modules to be loaded by this extension. A module is a plug-in that
further extends functionality of an extension.</dd>
<dt>paths <span class="classifier-delimiter">:</span> <span class="classifier">list_of_strs (mandatory)</span></dt>
<dd>A list of paths to be pulled from the device. These could be directories
as well as files.</dd>
<dt>use_tmpfs <span class="classifier-delimiter">:</span> <span class="classifier">boolean</span></dt>
<dd>Specifies whether tmpfs should be used to cache sysfile trees and then pull them down
as a tarball. This is significantly faster then just copying the directory trees from
the device directly, bur requres root and may not work on all devices. Defaults to
<code class="docutils literal"><span class="pre">True</span></code> if the device is rooted and <code class="docutils literal"><span class="pre">False</span></code> if it is not.</dd>
<dt>tmpfs_mount_point <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd>Mount point for tmpfs partition used to store snapshots of paths.</dd>
<dt>tmpfs_size <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first">Size of the tempfs partition.</p>
<p class="last">default: <code class="docutils literal"><span class="pre">'32m'</span></code></p>
</dd>
</dl>
</div>
</div>
<div class="section" id="trace-cmd">
<h2>trace-cmd<a class="headerlink" href="#trace-cmd" title="Permalink to this headline">¶</a></h2>
<p>trace-cmd is an instrument which interacts with Ftrace Linux kernel internal
tracer</p>
<p>From trace-cmd man page:</p>
<p>trace-cmd command interacts with the Ftrace tracer that is built inside the
Linux kernel. It interfaces with the Ftrace specific files found in the
debugfs file system under the tracing directory.</p>
<p>trace-cmd reads a list of events it will trace, which can be specified in
the config file as follows</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">trace_events</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;irq*&#39;</span><span class="p">,</span> <span class="s">&#39;power*&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>If no event is specified in the config file, trace-cmd traces the following events:</p>
<blockquote>
<div><ul class="simple">
<li>sched*</li>
<li>irq*</li>
<li>power*</li>
<li>cpufreq_interactive*</li>
</ul>
</div></blockquote>
<p>The list of available events can be obtained by rooting and running the following
command line on the device</p>
<div class="highlight-python"><div class="highlight"><pre>trace-cmd list
</pre></div>
</div>
<p>You may also specify <code class="docutils literal"><span class="pre">trace_buffer_size</span></code> setting which must be an integer that will
be used to set the ftrace buffer size. It will be interpreted as KB:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">trace_cmd_buffer_size</span> <span class="o">=</span> <span class="mi">8000</span>
</pre></div>
</div>
<p>The maximum buffer size varies from device to device, but there is a maximum and trying
to set buffer size beyound that will fail. If you plan on collecting a lot of trace over
long periods of time, the buffer size will not be enough and you will only get trace for
the last portion of your run. To deal with this you can set the <code class="docutils literal"><span class="pre">trace_mode</span></code> setting to
<code class="docutils literal"><span class="pre">'record'</span></code> (the default is <code class="docutils literal"><span class="pre">'start'</span></code>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">trace_cmd_mode</span> <span class="o">=</span> <span class="s">&#39;record&#39;</span>
</pre></div>
</div>
<p>This will cause trace-cmd to trace into file(s) on disk, rather than the buffer, and so the
limit for the max size of the trace is set by the storage available on device. Bear in mind
that <code class="docutils literal"><span class="pre">'record'</span></code> mode <em>is</em> more instrusive than the default, so if you do not plan on
generating a lot of trace, it is best to use the default <code class="docutils literal"><span class="pre">'start'</span></code> mode.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Mode names correspend to the underlying trace-cmd exectuable&#8217;s command used to
implement them. You can find out more about what is happening in each case from
trace-cmd documentation: <a class="reference external" href="https://lwn.net/Articles/341902/">https://lwn.net/Articles/341902/</a>.</p>
</div>
<p>This instrument comes with an Android trace-cmd binary that will be copied and used on the
device, however post-processing will be done on-host and you must have trace-cmd installed and
in your path. On Ubuntu systems, this may be done with:</p>
<div class="highlight-python"><div class="highlight"><pre>sudo apt-get install trace-cmd
</pre></div>
</div>
<div class="section" id="id21">
<h3>parameters<a class="headerlink" href="#id21" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>modules <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd>Lists the modules to be loaded by this extension. A module is a plug-in that
further extends functionality of an extension.</dd>
<dt>events <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd><p class="first">Specifies the list of events to be traced. Each event in the list will be passed to
trace-cmd with -e parameter and must be in the format accepted by trace-cmd.</p>
<p class="last">default: <code class="docutils literal"><span class="pre">['sched*',</span> <span class="pre">'irq*',</span> <span class="pre">'power*',</span> <span class="pre">'cpufreq_interactive*']</span></code></p>
</dd>
<dt>mode <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first">Trace can be collected using either &#8216;start&#8217; or &#8216;record&#8217; trace-cmd
commands. In &#8216;start&#8217; mode, trace will be collected into the ftrace buffer;
in &#8216;record&#8217; mode, trace will be written into a file on the device&#8217;s file
system. &#8216;start&#8217; mode is (in theory) less intrusive than &#8216;record&#8217; mode, however
it is limited by the size of the ftrace buffer (which is configurable &#8211;
see <code class="docutils literal"><span class="pre">buffer_size</span></code> &#8211; but only up to a point) and that may overflow
for long-running workloads, which will result in dropped events.</p>
<p>allowed values: <code class="docutils literal"><span class="pre">'start'</span></code>, <code class="docutils literal"><span class="pre">'record'</span></code></p>
<p class="last">default: <code class="docutils literal"><span class="pre">'start'</span></code></p>
</dd>
<dt>buffer_size <span class="classifier-delimiter">:</span> <span class="classifier">integer</span></dt>
<dd>Attempt to set ftrace buffer size to the specified value (in KB). Default buffer size
may need to be increased for long-running workloads, or if a large number
of events have been enabled. Note: there is a maximum size that the buffer can
be set, and that varies from device to device. Attempting to set buffer size higher
than this will fail. In that case, this instrument will set the size to the highest
possible value by going down from the specified size in <code class="docutils literal"><span class="pre">buffer_size_step</span></code> intervals.</dd>
<dt>buffer_size_step <span class="classifier-delimiter">:</span> <span class="classifier">integer</span></dt>
<dd><p class="first">Defines the decremental step used if the specified <code class="docutils literal"><span class="pre">buffer_size</span></code> could not be set.
This will be subtracted form the buffer size until set succeeds or size is reduced to
1MB.</p>
<p class="last">default: <code class="docutils literal"><span class="pre">1000</span></code></p>
</dd>
<dt>buffer_size_file <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first">Path to the debugs file that may be used to set ftrace buffer size. This should need
to be modified for the vast majority devices.</p>
<p class="last">default: <code class="docutils literal"><span class="pre">'/sys/kernel/debug/tracing/buffer_size_kb'</span></code></p>
</dd>
<dt>report <span class="classifier-delimiter">:</span> <span class="classifier">boolean</span></dt>
<dd><p class="first">Specifies whether host-side reporting should be performed once the binary trace has been
pulled form the device.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This requires the latest version of trace-cmd to be installed on the host (the
one in your distribution&#8217;s repos may be too old).</p>
</div>
<p class="last">default: <code class="docutils literal"><span class="pre">True</span></code></p>
</dd>
<dt>no_install <span class="classifier-delimiter">:</span> <span class="classifier">boolean</span></dt>
<dd>Do not install the bundled trace-cmd  and use the one on the device instead. If there is
not already a trace-cmd on the device, an error is raised.</dd>
</dl>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Instruments</a><ul>
<li><a class="reference internal" href="#apk-version">apk_version</a><ul>
<li><a class="reference internal" href="#parameters">parameters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cci-pmu-logger">cci_pmu_logger</a><ul>
<li><a class="reference internal" href="#id2">parameters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#coreutil">coreutil</a><ul>
<li><a class="reference internal" href="#id3">parameters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cpufreq">cpufreq</a><ul>
<li><a class="reference internal" href="#id4">parameters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#daq">daq</a><ul>
<li><a class="reference internal" href="#id5">parameters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#delay">delay</a><ul>
<li><a class="reference internal" href="#id6">parameters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dmesg">dmesg</a><ul>
<li><a class="reference internal" href="#id7">parameters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#energy-model">energy_model</a><ul>
<li><a class="reference internal" href="#id8">parameters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#energy-probe">energy_probe</a><ul>
<li><a class="reference internal" href="#id9">parameters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#execution-time">execution_time</a><ul>
<li><a class="reference internal" href="#id10">parameters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#fps">fps</a><ul>
<li><a class="reference internal" href="#id11">parameters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#freq-sweep">freq_sweep</a><ul>
<li><a class="reference internal" href="#id12">parameters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#hwmon">hwmon</a><ul>
<li><a class="reference internal" href="#id13">parameters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#interrupts">interrupts</a><ul>
<li><a class="reference internal" href="#id14">parameters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#juno-energy">juno_energy</a><ul>
<li><a class="reference internal" href="#id15">parameters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#netstats">netstats</a><ul>
<li><a class="reference internal" href="#id16">parameters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#perf">perf</a><ul>
<li><a class="reference internal" href="#id17">parameters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#screenon">screenon</a><ul>
<li><a class="reference internal" href="#id18">parameters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#streamline">streamline</a><ul>
<li><a class="reference internal" href="#id19">parameters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#sysfs-extractor">sysfs_extractor</a><ul>
<li><a class="reference internal" href="#id20">parameters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#trace-cmd">trace-cmd</a><ul>
<li><a class="reference internal" href="#id21">parameters</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="workloads.html"
                        title="previous chapter">Workloads</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="result_processors.html"
                        title="next chapter">Result_processors</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/extensions/instruments.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="result_processors.html" title="Result_processors"
             >next</a> |</li>
        <li class="right" >
          <a href="workloads.html" title="Workloads"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Workload Automation 2.4.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2013, ARM Ltd.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>