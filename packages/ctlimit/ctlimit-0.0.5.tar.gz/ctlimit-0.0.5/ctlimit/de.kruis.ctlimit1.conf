<!DOCTYPE busconfig PUBLIC
 "-//freedesktop//DTD D-BUS Bus Configuration 1.0//EN"
 "http://www.freedesktop.org/standards/dbus/1.0/busconfig.dtd">

<!--
  This file is part of ctlimit.

  ctlmit is free software; you can redistribute it and/or modify it
  under the terms of the GNU Lesser General Public License as published by
  the Free Software Foundation; either version 2.1 of the License, or
  (at your option) any later version.
-->

<busconfig>

  <!-- Only root or ctlimit can own the service -->
  <policy user="root">
    <allow own="de.kruis.ctlimit1"/>
  	<allow send_destination="de.kruis.ctlimit1" send_interface="de.kruis.ctlimit1.User" send_member="SetCurrentLimit"/>
  	<allow send_destination="de.kruis.ctlimit1" send_interface="de.kruis.ctlimit1.User" send_member="IncreaseCurrentLimit"/>
  	<allow send_destination="de.kruis.ctlimit1" send_interface="de.kruis.ctlimit1.Daemon" send_member="AttachPydevd"/>
  </policy>
  <policy user="ctlimit">
    <allow own="de.kruis.ctlimit1"/>
  </policy>

  <policy group="parents">
  	<allow send_destination="de.kruis.ctlimit1" send_interface="de.kruis.ctlimit1.User" send_member="SetCurrentLimit"/>
  	<allow send_destination="de.kruis.ctlimit1" send_interface="de.kruis.ctlimit1.User" send_member="IncreaseCurrentLimit"/>
  </policy>

  <policy context="default">
  	<deny send_destination="de.kruis.ctlimit1"/>
	<allow send_destination="de.kruis.ctlimit1" send_type="signal"/>
	<allow send_destination="de.kruis.ctlimit1" send_type="method_return"/>
	<allow send_destination="de.kruis.ctlimit1" send_type="error"/>

  	<allow send_destination="de.kruis.ctlimit1" send_interface="org.freedesktop.DBus.Introspectable"/>
  	<allow send_destination="de.kruis.ctlimit1" send_interface="org.freedesktop.DBus.Peer"/>
    <allow send_destination="de.kruis.ctlimit1" send_interface="org.freedesktop.DBus.Properties" send_member="Get"/>
    <allow send_destination="de.kruis.ctlimit1" send_interface="org.freedesktop.DBus.Properties" send_member="GetAll"/>

  	<allow send_destination="de.kruis.ctlimit1" send_interface="de.kruis.ctlimit1.Daemon" send_member="Update"/>

  	<allow receive_sender="de.kruis.ctlimit1"/>
  </policy>
</busconfig>
