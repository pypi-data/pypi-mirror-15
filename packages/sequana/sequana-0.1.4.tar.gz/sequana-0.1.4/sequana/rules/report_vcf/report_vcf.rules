__report_vcf__output = cfg.PROJECT + "/report/report_vcf.html"

rule report_vcf:
    input:
        vcf = __report_vcf__input
    output:
        html = __report_vcf__output,
        csv = cfg.PROJECT + "/report/%s.csv" % cfg.PROJECT
    params:
        outdir = cfg.PROJECT + "/report/"
    run:
        from sequana import vcf_filter
        from sequana import report_vcf

        vcf_record = vcf_filter.VCF(input["vcf"])

        r = report_vcf.VCFReport(directory=params.outdir, csv_file=output.csv)
        r.jinja["main_link"] = "index.html"
        r.set_data(vcf_record)
        r.create_report()
